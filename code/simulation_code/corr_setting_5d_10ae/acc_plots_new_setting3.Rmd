---
title: "Plots for accuracy measures for setting 3"
author: "Reetika Sarkar"
output: html_document
---

```{r load_libraries}
## SETTING 1: p = 0.1, 0.3, 0.5
#plots for accuracy measures

library(ggplot2)
library(gridExtra)
library(ggpubr)
library(greekLetters)
```

```{r read_results_data}
#read file from drive
# for p = 0.1
results_loc_beta1_p_0_1 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/naive_setting_5d_10ae/p_0_1/beta_1"
results_loc_beta10_p_0_1 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/naive_setting_5d_10ae/p_0_1/beta_10"
results_loc_beta50_p_0_1 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/naive_setting_5d_10ae/p_0_1/beta_50"
results_loc_beta100_p_0_1 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/naive_setting_5d_10ae/p_0_1/beta_100"

results_loc_beta1_dep_0_3_p_0_1 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_1/cor_0_3/beta_1/model_1"
results_loc_beta10_dep_0_3_p_0_1 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_1/cor_0_3/beta_10/model_1"
results_loc_beta50_dep_0_3_p_0_1 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_1/cor_0_3/beta_50/model_1"
results_loc_beta100_dep_0_3_p_0_1 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_1/cor_0_3/beta_100/model_1"

results_loc_beta1_dep_neg0_3_p_0_1 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_1/cor_0_3/beta_1/model_2"
results_loc_beta10_dep_neg0_3_p_0_1 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_1/cor_0_3/beta_10/model_2"
results_loc_beta50_dep_neg0_3_p_0_1 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_1/cor_0_3/beta_50/model_2"
results_loc_beta100_dep_neg0_3_p_0_1 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_1/cor_0_3/beta_100/model_2"

results_loc_beta1_dep_0_5_p_0_1 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_1/cor_0_5/beta_1/model_1"
results_loc_beta10_dep_0_5_p_0_1 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_1/cor_0_5/beta_10/model_1"
results_loc_beta50_dep_0_5_p_0_1 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_1/cor_0_5/beta_50/model_1"
results_loc_beta100_dep_0_5_p_0_1 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_1/cor_0_5/beta_100/model_1"

results_loc_beta1_dep_neg0_5_p_0_1 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_1/cor_0_5/beta_1/model_2"
results_loc_beta10_dep_neg0_5_p_0_1 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_1/cor_0_5/beta_10/model_2"
results_loc_beta50_dep_neg0_5_p_0_1 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_1/cor_0_5/beta_50/model_2"
results_loc_beta100_dep_neg0_5_p_0_1 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_1/cor_0_5/beta_100/model_2"

results_loc_beta1_dep_0_7_p_0_1 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_1/cor_0_7/beta_1/model_1"
results_loc_beta10_dep_0_7_p_0_1 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_1/cor_0_7/beta_10/model_1"
results_loc_beta50_dep_0_7_p_0_1 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_1/cor_0_7/beta_50/model_1"
results_loc_beta100_dep_0_7_p_0_1 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_1/cor_0_7/beta_100/model_1"

results_loc_beta1_dep_neg0_7_p_0_1 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_1/cor_0_7/beta_1/model_2"
results_loc_beta10_dep_neg0_7_p_0_1 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_1/cor_0_7/beta_10/model_2"
results_loc_beta50_dep_neg0_7_p_0_1 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_1/cor_0_7/beta_50/model_2"
results_loc_beta100_dep_neg0_7_p_0_1 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_1/cor_0_7/beta_100/model_2"

# for p = 0.3
results_loc_beta1_p_0_3 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/naive_setting_5d_10ae/p_0_3/beta_1"
results_loc_beta10_p_0_3 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/naive_setting_5d_10ae/p_0_3/beta_10"
results_loc_beta50_p_0_3 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/naive_setting_5d_10ae/p_0_3/beta_50"
results_loc_beta100_p_0_3 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/naive_setting_5d_10ae/p_0_3/beta_100"

results_loc_beta1_dep_0_3_p_0_3 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_3/cor_0_3/beta_1/model_1"
results_loc_beta10_dep_0_3_p_0_3 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_3/cor_0_3/beta_10/model_1"
results_loc_beta50_dep_0_3_p_0_3 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_3/cor_0_3/beta_50/model_1"
results_loc_beta100_dep_0_3_p_0_3 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_3/cor_0_3/beta_100/model_1"

results_loc_beta1_dep_neg0_3_p_0_3 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_3/cor_0_3/beta_1/model_2"
results_loc_beta10_dep_neg0_3_p_0_3 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_3/cor_0_3/beta_10/model_2"
results_loc_beta50_dep_neg0_3_p_0_3 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_3/cor_0_3/beta_50/model_2"
results_loc_beta100_dep_neg0_3_p_0_3 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_3/cor_0_3/beta_100/model_2"

results_loc_beta1_dep_0_5_p_0_3 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_3/cor_0_5/beta_1/model_1"
results_loc_beta10_dep_0_5_p_0_3 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_3/cor_0_5/beta_10/model_1"
results_loc_beta50_dep_0_5_p_0_3 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_3/cor_0_5/beta_50/model_1"
results_loc_beta100_dep_0_5_p_0_3 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_3/cor_0_5/beta_100/model_1"

results_loc_beta1_dep_neg0_5_p_0_3 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_3/cor_0_5/beta_1/model_2"
results_loc_beta10_dep_neg0_5_p_0_3 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_3/cor_0_5/beta_10/model_2"
results_loc_beta50_dep_neg0_5_p_0_3 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_3/cor_0_5/beta_50/model_2"
results_loc_beta100_dep_neg0_5_p_0_3 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_3/cor_0_5/beta_100/model_2"

results_loc_beta1_dep_0_7_p_0_3 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_3/cor_0_7/beta_1/model_1"
results_loc_beta10_dep_0_7_p_0_3 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_3/cor_0_7/beta_10/model_1"
results_loc_beta50_dep_0_7_p_0_3 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_3/cor_0_7/beta_50/model_1"
results_loc_beta100_dep_0_7_p_0_3 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_3/cor_0_7/beta_100/model_1"

results_loc_beta1_dep_neg0_7_p_0_3 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_3/cor_0_7/beta_1/model_2"
results_loc_beta10_dep_neg0_7_p_0_3 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_3/cor_0_7/beta_10/model_2"
results_loc_beta50_dep_neg0_7_p_0_3 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_3/cor_0_7/beta_50/model_2"
results_loc_beta100_dep_neg0_7_p_0_3 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_3/cor_0_7/beta_100/model_2"

# for p = 0.5
results_loc_beta1_p_0_5 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/naive_setting_5d_10ae/p_0_5/beta_1"
results_loc_beta10_p_0_5 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/naive_setting_5d_10ae/p_0_5/beta_10"
results_loc_beta50_p_0_5 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/naive_setting_5d_10ae/p_0_5/beta_50"
results_loc_beta100_p_0_5 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/naive_setting_5d_10ae/p_0_5/beta_100"

results_loc_beta1_dep_0_3_p_0_5 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_5/cor_0_3/beta_1/model_1"
results_loc_beta10_dep_0_3_p_0_5 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_5/cor_0_3/beta_10/model_1"
results_loc_beta50_dep_0_3_p_0_5 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_5/cor_0_3/beta_50/model_1"
results_loc_beta100_dep_0_3_p_0_5 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_5/cor_0_3/beta_100/model_1"

results_loc_beta1_dep_neg0_3_p_0_5 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_5/cor_0_3/beta_1/model_2"
results_loc_beta10_dep_neg0_3_p_0_5 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_5/cor_0_3/beta_10/model_2"
results_loc_beta50_dep_neg0_3_p_0_5 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_5/cor_0_3/beta_50/model_2"
results_loc_beta100_dep_neg0_3_p_0_5 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_5/cor_0_3/beta_100/model_2"

results_loc_beta1_dep_0_5_p_0_5 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_5/cor_0_5/beta_1/model_1"
results_loc_beta10_dep_0_5_p_0_5 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_5/cor_0_5/beta_10/model_1"
results_loc_beta50_dep_0_5_p_0_5 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_5/cor_0_5/beta_50/model_1"
results_loc_beta100_dep_0_5_p_0_5 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_5/cor_0_5/beta_100/model_1"

results_loc_beta1_dep_neg0_5_p_0_5 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_5/cor_0_5/beta_1/model_2"
results_loc_beta10_dep_neg0_5_p_0_5 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_5/cor_0_5/beta_10/model_2"
results_loc_beta50_dep_neg0_5_p_0_5 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_5/cor_0_5/beta_50/model_2"
results_loc_beta100_dep_neg0_5_p_0_5 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_5/cor_0_5/beta_100/model_2"

results_loc_beta1_dep_0_7_p_0_5 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_5/cor_0_7/beta_1/model_1"
results_loc_beta10_dep_0_7_p_0_5 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_5/cor_0_7/beta_10/model_1"
results_loc_beta50_dep_0_7_p_0_5 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_5/cor_0_7/beta_50/model_1"
results_loc_beta100_dep_0_7_p_0_5 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_5/cor_0_7/beta_100/model_1"

results_loc_beta1_dep_neg0_7_p_0_5 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_5/cor_0_7/beta_1/model_2"
results_loc_beta10_dep_neg0_7_p_0_5 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_5/cor_0_7/beta_10/model_2"
results_loc_beta50_dep_neg0_7_p_0_5 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_5/cor_0_7/beta_50/model_2"
results_loc_beta100_dep_neg0_7_p_0_5 <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/results/correlated_setting_5d_10ae/p_0_5/cor_0_7/beta_100/model_2"
```

```{r read_conf_values}
#read conf values for each beta 
# for p = 0.1
# independent setting
conf_results_beta1_p_0_1 <- read.table(paste0(results_loc_beta1_p_0_1,"/conf.csv"), header = T)
conf_results_beta10_p_0_1 <- read.table(paste0(results_loc_beta10_p_0_1,"/conf.csv"), header = T)
conf_results_beta50_p_0_1 <- read.table(paste0(results_loc_beta50_p_0_1,"/conf.csv"), header = T)
conf_results_beta100_p_0_1 <- read.table(paste0(results_loc_beta100_p_0_1,"/conf.csv"), header = T)

# dependent, cor = 0.3
conf_results_beta1_dep_0_3_p_0_1 <- read.table(paste0(results_loc_beta1_dep_0_3_p_0_1,"/conf.csv"), header = T)
conf_results_beta10_dep_0_3_p_0_1 <- read.table(paste0(results_loc_beta10_dep_0_3_p_0_1,"/conf.csv"), header = T)
conf_results_beta50_dep_0_3_p_0_1 <- read.table(paste0(results_loc_beta50_dep_0_3_p_0_1,"/conf.csv"), header = T)
conf_results_beta100_dep_0_3_p_0_1 <- read.table(paste0(results_loc_beta100_dep_0_3_p_0_1,"/conf.csv"), header = T)

# dependent, cor = -0.3
conf_results_beta1_dep_neg0_3_p_0_1 <- read.table(paste0(results_loc_beta1_dep_neg0_3_p_0_1,"/conf.csv"), header = T)
conf_results_beta10_dep_neg0_3_p_0_1 <- read.table(paste0(results_loc_beta10_dep_neg0_3_p_0_1,"/conf.csv"), header = T)
conf_results_beta50_dep_neg0_3_p_0_1 <- read.table(paste0(results_loc_beta50_dep_neg0_3_p_0_1,"/conf.csv"), header = T)
conf_results_beta100_dep_neg0_3_p_0_1 <- read.table(paste0(results_loc_beta100_dep_neg0_3_p_0_1,"/conf.csv"), header = T)

# dependent, cor = 0.5
conf_results_beta1_dep_0_5_p_0_1 <- read.table(paste0(results_loc_beta1_dep_0_5_p_0_1,"/conf.csv"), header = T)
conf_results_beta10_dep_0_5_p_0_1 <- read.table(paste0(results_loc_beta10_dep_0_5_p_0_1,"/conf.csv"), header = T)
conf_results_beta50_dep_0_5_p_0_1 <- read.table(paste0(results_loc_beta50_dep_0_5_p_0_1,"/conf.csv"), header = T)
conf_results_beta100_dep_0_5_p_0_1 <- read.table(paste0(results_loc_beta100_dep_0_5_p_0_1,"/conf.csv"), header = T)

# dependent, cor = -0.5
conf_results_beta1_dep_neg0_5_p_0_1 <- read.table(paste0(results_loc_beta1_dep_neg0_5_p_0_1,"/conf.csv"), header = T)
conf_results_beta10_dep_neg0_5_p_0_1 <- read.table(paste0(results_loc_beta10_dep_neg0_5_p_0_1,"/conf.csv"), header = T)
conf_results_beta50_dep_neg0_5_p_0_1 <- read.table(paste0(results_loc_beta50_dep_neg0_5_p_0_1,"/conf.csv"), header = T)
conf_results_beta100_dep_neg0_5_p_0_1 <- read.table(paste0(results_loc_beta100_dep_neg0_5_p_0_1,"/conf.csv"), header = T)

# dependent, cor = 0.7
conf_results_beta1_dep_0_7_p_0_1 <- read.table(paste0(results_loc_beta1_dep_0_7_p_0_1,"/conf.csv"), header = T)
conf_results_beta10_dep_0_7_p_0_1 <- read.table(paste0(results_loc_beta10_dep_0_7_p_0_1,"/conf.csv"), header = T)
conf_results_beta50_dep_0_7_p_0_1 <- read.table(paste0(results_loc_beta50_dep_0_7_p_0_1,"/conf.csv"), header = T)
conf_results_beta100_dep_0_7_p_0_1 <- read.table(paste0(results_loc_beta100_dep_0_7_p_0_1,"/conf.csv"), header = T)

# dependent, cor = -0.7
conf_results_beta1_dep_neg0_7_p_0_1 <- read.table(paste0(results_loc_beta1_dep_neg0_7_p_0_1,"/conf.csv"), header = T)
conf_results_beta10_dep_neg0_7_p_0_1 <- read.table(paste0(results_loc_beta10_dep_neg0_7_p_0_1,"/conf.csv"), header = T)
conf_results_beta50_dep_neg0_7_p_0_1 <- read.table(paste0(results_loc_beta50_dep_neg0_7_p_0_1,"/conf.csv"), header = T)
conf_results_beta100_dep_neg0_7_p_0_1 <- read.table(paste0(results_loc_beta100_dep_neg0_7_p_0_1,"/conf.csv"), header = T)

#### for p = 0.3
# independent setting
conf_results_beta1_p_0_3 <- read.table(paste0(results_loc_beta1_p_0_3,"/conf.csv"), header = T)
conf_results_beta10_p_0_3 <- read.table(paste0(results_loc_beta10_p_0_3,"/conf.csv"), header = T)
conf_results_beta50_p_0_3 <- read.table(paste0(results_loc_beta50_p_0_3,"/conf.csv"), header = T)
conf_results_beta100_p_0_3 <- read.table(paste0(results_loc_beta100_p_0_3,"/conf.csv"), header = T)

# dependent, cor = 0.3
conf_results_beta1_dep_0_3_p_0_3 <- read.table(paste0(results_loc_beta1_dep_0_3_p_0_3,"/conf.csv"), header = T)
conf_results_beta10_dep_0_3_p_0_3 <- read.table(paste0(results_loc_beta10_dep_0_3_p_0_3,"/conf.csv"), header = T)
conf_results_beta50_dep_0_3_p_0_3 <- read.table(paste0(results_loc_beta50_dep_0_3_p_0_3,"/conf.csv"), header = T)
conf_results_beta100_dep_0_3_p_0_3 <- read.table(paste0(results_loc_beta100_dep_0_3_p_0_3,"/conf.csv"), header = T)

# dependent, cor = -0.3
conf_results_beta1_dep_neg0_3_p_0_3 <- read.table(paste0(results_loc_beta1_dep_neg0_3_p_0_3,"/conf.csv"), header = T)
conf_results_beta10_dep_neg0_3_p_0_3 <- read.table(paste0(results_loc_beta10_dep_neg0_3_p_0_3,"/conf.csv"), header = T)
conf_results_beta50_dep_neg0_3_p_0_3 <- read.table(paste0(results_loc_beta50_dep_neg0_3_p_0_3,"/conf.csv"), header = T)
conf_results_beta100_dep_neg0_3_p_0_3 <- read.table(paste0(results_loc_beta100_dep_neg0_3_p_0_3,"/conf.csv"), header = T)

# dependent, cor = 0.5
conf_results_beta1_dep_0_5_p_0_3 <- read.table(paste0(results_loc_beta1_dep_0_5_p_0_3,"/conf.csv"), header = T)
conf_results_beta10_dep_0_5_p_0_3 <- read.table(paste0(results_loc_beta10_dep_0_5_p_0_3,"/conf.csv"), header = T)
conf_results_beta50_dep_0_5_p_0_3 <- read.table(paste0(results_loc_beta50_dep_0_5_p_0_3,"/conf.csv"), header = T)
conf_results_beta100_dep_0_5_p_0_3 <- read.table(paste0(results_loc_beta100_dep_0_5_p_0_3,"/conf.csv"), header = T)

# dependent, cor = -0.5
conf_results_beta1_dep_neg0_5_p_0_3 <- read.table(paste0(results_loc_beta1_dep_neg0_5_p_0_3,"/conf.csv"), header = T)
conf_results_beta10_dep_neg0_5_p_0_3 <- read.table(paste0(results_loc_beta10_dep_neg0_5_p_0_3,"/conf.csv"), header = T)
conf_results_beta50_dep_neg0_5_p_0_3 <- read.table(paste0(results_loc_beta50_dep_neg0_5_p_0_3,"/conf.csv"), header = T)
conf_results_beta100_dep_neg0_5_p_0_3 <- read.table(paste0(results_loc_beta100_dep_neg0_5_p_0_3,"/conf.csv"), header = T)

# dependent, cor = 0.7
conf_results_beta1_dep_0_7_p_0_3 <- read.table(paste0(results_loc_beta1_dep_0_7_p_0_3,"/conf.csv"), header = T)
conf_results_beta10_dep_0_7_p_0_3 <- read.table(paste0(results_loc_beta10_dep_0_7_p_0_3,"/conf.csv"), header = T)
conf_results_beta50_dep_0_7_p_0_3 <- read.table(paste0(results_loc_beta50_dep_0_7_p_0_3,"/conf.csv"), header = T)
conf_results_beta100_dep_0_7_p_0_3 <- read.table(paste0(results_loc_beta100_dep_0_7_p_0_3,"/conf.csv"), header = T)

# dependent, cor = -0.7
conf_results_beta1_dep_neg0_7_p_0_3 <- read.table(paste0(results_loc_beta1_dep_neg0_7_p_0_3,"/conf.csv"), header = T)
conf_results_beta10_dep_neg0_7_p_0_3 <- read.table(paste0(results_loc_beta10_dep_neg0_7_p_0_3,"/conf.csv"), header = T)
conf_results_beta50_dep_neg0_7_p_0_3 <- read.table(paste0(results_loc_beta50_dep_neg0_7_p_0_3,"/conf.csv"), header = T)
conf_results_beta100_dep_neg0_7_p_0_3 <- read.table(paste0(results_loc_beta100_dep_neg0_7_p_0_3,"/conf.csv"), header = T)

#### for p = 0.5
# independent setting
conf_results_beta1_p_0_5 <- read.table(paste0(results_loc_beta1_p_0_5,"/conf.csv"), header = T)
conf_results_beta10_p_0_5 <- read.table(paste0(results_loc_beta10_p_0_5,"/conf.csv"), header = T)
conf_results_beta50_p_0_5 <- read.table(paste0(results_loc_beta50_p_0_5,"/conf.csv"), header = T)
conf_results_beta100_p_0_5 <- read.table(paste0(results_loc_beta100_p_0_5,"/conf.csv"), header = T)

# dependent, cor = 0.3
conf_results_beta1_dep_0_3_p_0_5 <- read.table(paste0(results_loc_beta1_dep_0_3_p_0_5,"/conf.csv"), header = T)
conf_results_beta10_dep_0_3_p_0_5 <- read.table(paste0(results_loc_beta10_dep_0_3_p_0_5,"/conf.csv"), header = T)
conf_results_beta50_dep_0_3_p_0_5 <- read.table(paste0(results_loc_beta50_dep_0_3_p_0_5,"/conf.csv"), header = T)
conf_results_beta100_dep_0_3_p_0_5 <- read.table(paste0(results_loc_beta100_dep_0_3_p_0_5,"/conf.csv"), header = T)

# dependent, cor = -0.3
conf_results_beta1_dep_neg0_3_p_0_5 <- read.table(paste0(results_loc_beta1_dep_neg0_3_p_0_5,"/conf.csv"), header = T)
conf_results_beta10_dep_neg0_3_p_0_5 <- read.table(paste0(results_loc_beta10_dep_neg0_3_p_0_5,"/conf.csv"), header = T)
conf_results_beta50_dep_neg0_3_p_0_5 <- read.table(paste0(results_loc_beta50_dep_neg0_3_p_0_5,"/conf.csv"), header = T)
conf_results_beta100_dep_neg0_3_p_0_5 <- read.table(paste0(results_loc_beta100_dep_neg0_3_p_0_5,"/conf.csv"), header = T)

# dependent, cor = 0.5
conf_results_beta1_dep_0_5_p_0_5 <- read.table(paste0(results_loc_beta1_dep_0_5_p_0_5,"/conf.csv"), header = T)
conf_results_beta10_dep_0_5_p_0_5 <- read.table(paste0(results_loc_beta10_dep_0_5_p_0_5,"/conf.csv"), header = T)
conf_results_beta50_dep_0_5_p_0_5 <- read.table(paste0(results_loc_beta50_dep_0_5_p_0_5,"/conf.csv"), header = T)
conf_results_beta100_dep_0_5_p_0_5 <- read.table(paste0(results_loc_beta100_dep_0_5_p_0_5,"/conf.csv"), header = T)

# dependent, cor = -0.5
conf_results_beta1_dep_neg0_5_p_0_5 <- read.table(paste0(results_loc_beta1_dep_neg0_5_p_0_5,"/conf.csv"), header = T)
conf_results_beta10_dep_neg0_5_p_0_5 <- read.table(paste0(results_loc_beta10_dep_neg0_5_p_0_5,"/conf.csv"), header = T)
conf_results_beta50_dep_neg0_5_p_0_5 <- read.table(paste0(results_loc_beta50_dep_neg0_5_p_0_5,"/conf.csv"), header = T)
conf_results_beta100_dep_neg0_5_p_0_5 <- read.table(paste0(results_loc_beta100_dep_neg0_5_p_0_5,"/conf.csv"), header = T)

# dependent, cor = 0.7
conf_results_beta1_dep_0_7_p_0_5 <- read.table(paste0(results_loc_beta1_dep_0_7_p_0_5,"/conf.csv"), header = T)
conf_results_beta10_dep_0_7_p_0_5 <- read.table(paste0(results_loc_beta10_dep_0_7_p_0_5,"/conf.csv"), header = T)
conf_results_beta50_dep_0_7_p_0_5 <- read.table(paste0(results_loc_beta50_dep_0_7_p_0_5,"/conf.csv"), header = T)
conf_results_beta100_dep_0_7_p_0_5 <- read.table(paste0(results_loc_beta100_dep_0_7_p_0_5,"/conf.csv"), header = T)

# dependent, cor = -0.7
conf_results_beta1_dep_neg0_7_p_0_5 <- read.table(paste0(results_loc_beta1_dep_neg0_7_p_0_5,"/conf.csv"), header = T)
conf_results_beta10_dep_neg0_7_p_0_5 <- read.table(paste0(results_loc_beta10_dep_neg0_7_p_0_5,"/conf.csv"), header = T)
conf_results_beta50_dep_neg0_7_p_0_5 <- read.table(paste0(results_loc_beta50_dep_neg0_7_p_0_5,"/conf.csv"), header = T)
conf_results_beta100_dep_neg0_7_p_0_5 <- read.table(paste0(results_loc_beta100_dep_neg0_7_p_0_5,"/conf.csv"), header = T)
```

```{r read_prr_values}
#read prr values for each beta
# for p = 0.1
prr_results_beta1_p_0_1 <- read.table(paste0(results_loc_beta1_p_0_1,"/prr.csv"), header = T)
prr_results_beta10_p_0_1 <- read.table(paste0(results_loc_beta10_p_0_1,"/prr.csv"), header = T)
prr_results_beta50_p_0_1 <- read.table(paste0(results_loc_beta50_p_0_1,"/prr.csv"), header = T)
prr_results_beta100_p_0_1 <- read.table(paste0(results_loc_beta100_p_0_1,"/prr.csv"), header = T)

# dependent, cor = 0.3
prr_results_beta1_dep_0_3_p_0_1 <- read.table(paste0(results_loc_beta1_dep_0_3_p_0_1,"/prr.csv"), header = T)
prr_results_beta10_dep_0_3_p_0_1 <- read.table(paste0(results_loc_beta10_dep_0_3_p_0_1,"/prr.csv"), header = T)
prr_results_beta50_dep_0_3_p_0_1 <- read.table(paste0(results_loc_beta50_dep_0_3_p_0_1,"/prr.csv"), header = T)
prr_results_beta100_dep_0_3_p_0_1 <- read.table(paste0(results_loc_beta100_dep_0_3_p_0_1,"/prr.csv"), header = T)

# dependent, cor = -0.3
prr_results_beta1_dep_neg0_3_p_0_1 <- read.table(paste0(results_loc_beta1_dep_neg0_3_p_0_1,"/prr.csv"), header = T)
prr_results_beta10_dep_neg0_3_p_0_1 <- read.table(paste0(results_loc_beta10_dep_neg0_3_p_0_1,"/prr.csv"), header = T)
prr_results_beta50_dep_neg0_3_p_0_1 <- read.table(paste0(results_loc_beta50_dep_neg0_3_p_0_1,"/prr.csv"), header = T)
prr_results_beta100_dep_neg0_3_p_0_1 <- read.table(paste0(results_loc_beta100_dep_neg0_3_p_0_1,"/prr.csv"), header = T)

# dependent, cor = 0.5
prr_results_beta1_dep_0_5_p_0_1 <- read.table(paste0(results_loc_beta1_dep_0_5_p_0_1,"/prr.csv"), header = T)
prr_results_beta10_dep_0_5_p_0_1 <- read.table(paste0(results_loc_beta10_dep_0_5_p_0_1,"/prr.csv"), header = T)
prr_results_beta50_dep_0_5_p_0_1 <- read.table(paste0(results_loc_beta50_dep_0_5_p_0_1,"/prr.csv"), header = T)
prr_results_beta100_dep_0_5_p_0_1 <- read.table(paste0(results_loc_beta100_dep_0_5_p_0_1,"/prr.csv"), header = T)

# dependent, cor = -0.5
prr_results_beta1_dep_neg0_5_p_0_1 <- read.table(paste0(results_loc_beta1_dep_neg0_5_p_0_1,"/prr.csv"), header = T)
prr_results_beta10_dep_neg0_5_p_0_1 <- read.table(paste0(results_loc_beta10_dep_neg0_5_p_0_1,"/prr.csv"), header = T)
prr_results_beta50_dep_neg0_5_p_0_1 <- read.table(paste0(results_loc_beta50_dep_neg0_5_p_0_1,"/prr.csv"), header = T)
prr_results_beta100_dep_neg0_5_p_0_1 <- read.table(paste0(results_loc_beta100_dep_neg0_5_p_0_1,"/prr.csv"), header = T)

# dependent, cor = 0.7
prr_results_beta1_dep_0_7_p_0_1 <- read.table(paste0(results_loc_beta1_dep_0_7_p_0_1,"/prr.csv"), header = T)
prr_results_beta10_dep_0_7_p_0_1 <- read.table(paste0(results_loc_beta10_dep_0_7_p_0_1,"/prr.csv"), header = T)
prr_results_beta50_dep_0_7_p_0_1 <- read.table(paste0(results_loc_beta50_dep_0_7_p_0_1,"/prr.csv"), header = T)
prr_results_beta100_dep_0_7_p_0_1 <- read.table(paste0(results_loc_beta100_dep_0_7_p_0_1,"/prr.csv"), header = T)

# dependent, cor = -0.7
prr_results_beta1_dep_neg0_7_p_0_1 <- read.table(paste0(results_loc_beta1_dep_neg0_7_p_0_1,"/prr.csv"), header = T)
prr_results_beta10_dep_neg0_7_p_0_1 <- read.table(paste0(results_loc_beta10_dep_neg0_7_p_0_1,"/prr.csv"), header = T)
prr_results_beta50_dep_neg0_7_p_0_1 <- read.table(paste0(results_loc_beta50_dep_neg0_7_p_0_1,"/prr.csv"), header = T)
prr_results_beta100_dep_neg0_7_p_0_1 <- read.table(paste0(results_loc_beta100_dep_neg0_7_p_0_1,"/prr.csv"), header = T)

# for p = 0.3
prr_results_beta1_p_0_3 <- read.table(paste0(results_loc_beta1_p_0_3,"/prr.csv"), header = T)
prr_results_beta10_p_0_3 <- read.table(paste0(results_loc_beta10_p_0_3,"/prr.csv"), header = T)
prr_results_beta50_p_0_3 <- read.table(paste0(results_loc_beta50_p_0_3,"/prr.csv"), header = T)
prr_results_beta100_p_0_3 <- read.table(paste0(results_loc_beta100_p_0_3,"/prr.csv"), header = T)

# dependent, cor = 0.3
prr_results_beta1_dep_0_3_p_0_3 <- read.table(paste0(results_loc_beta1_dep_0_3_p_0_3,"/prr.csv"), header = T)
prr_results_beta10_dep_0_3_p_0_3 <- read.table(paste0(results_loc_beta10_dep_0_3_p_0_3,"/prr.csv"), header = T)
prr_results_beta50_dep_0_3_p_0_3 <- read.table(paste0(results_loc_beta50_dep_0_3_p_0_3,"/prr.csv"), header = T)
prr_results_beta100_dep_0_3_p_0_3 <- read.table(paste0(results_loc_beta100_dep_0_3_p_0_3,"/prr.csv"), header = T)

# dependent, cor = -0.3
prr_results_beta1_dep_neg0_3_p_0_3 <- read.table(paste0(results_loc_beta1_dep_neg0_3_p_0_3,"/prr.csv"), header = T)
prr_results_beta10_dep_neg0_3_p_0_3 <- read.table(paste0(results_loc_beta10_dep_neg0_3_p_0_3,"/prr.csv"), header = T)
prr_results_beta50_dep_neg0_3_p_0_3 <- read.table(paste0(results_loc_beta50_dep_neg0_3_p_0_3,"/prr.csv"), header = T)
prr_results_beta100_dep_neg0_3_p_0_3 <- read.table(paste0(results_loc_beta100_dep_neg0_3_p_0_3,"/prr.csv"), header = T)

# dependent, cor = 0.5
prr_results_beta1_dep_0_5_p_0_3 <- read.table(paste0(results_loc_beta1_dep_0_5_p_0_3,"/prr.csv"), header = T)
prr_results_beta10_dep_0_5_p_0_3 <- read.table(paste0(results_loc_beta10_dep_0_5_p_0_3,"/prr.csv"), header = T)
prr_results_beta50_dep_0_5_p_0_3 <- read.table(paste0(results_loc_beta50_dep_0_5_p_0_3,"/prr.csv"), header = T)
prr_results_beta100_dep_0_5_p_0_3 <- read.table(paste0(results_loc_beta100_dep_0_5_p_0_3,"/prr.csv"), header = T)

# dependent, cor = -0.5
prr_results_beta1_dep_neg0_5_p_0_3 <- read.table(paste0(results_loc_beta1_dep_neg0_5_p_0_3,"/prr.csv"), header = T)
prr_results_beta10_dep_neg0_5_p_0_3 <- read.table(paste0(results_loc_beta10_dep_neg0_5_p_0_3,"/prr.csv"), header = T)
prr_results_beta50_dep_neg0_5_p_0_3 <- read.table(paste0(results_loc_beta50_dep_neg0_5_p_0_3,"/prr.csv"), header = T)
prr_results_beta100_dep_neg0_5_p_0_3 <- read.table(paste0(results_loc_beta100_dep_neg0_5_p_0_3,"/prr.csv"), header = T)

# dependent, cor = 0.7
prr_results_beta1_dep_0_7_p_0_3 <- read.table(paste0(results_loc_beta1_dep_0_7_p_0_3,"/prr.csv"), header = T)
prr_results_beta10_dep_0_7_p_0_3 <- read.table(paste0(results_loc_beta10_dep_0_7_p_0_3,"/prr.csv"), header = T)
prr_results_beta50_dep_0_7_p_0_3 <- read.table(paste0(results_loc_beta50_dep_0_7_p_0_3,"/prr.csv"), header = T)
prr_results_beta100_dep_0_7_p_0_3 <- read.table(paste0(results_loc_beta100_dep_0_7_p_0_3,"/prr.csv"), header = T)

# dependent, cor = -0.7
prr_results_beta1_dep_neg0_7_p_0_3 <- read.table(paste0(results_loc_beta1_dep_neg0_7_p_0_3,"/prr.csv"), header = T)
prr_results_beta10_dep_neg0_7_p_0_3 <- read.table(paste0(results_loc_beta10_dep_neg0_7_p_0_3,"/prr.csv"), header = T)
prr_results_beta50_dep_neg0_7_p_0_3 <- read.table(paste0(results_loc_beta50_dep_neg0_7_p_0_3,"/prr.csv"), header = T)
prr_results_beta100_dep_neg0_7_p_0_3 <- read.table(paste0(results_loc_beta100_dep_neg0_7_p_0_3,"/prr.csv"), header = T)

# for p = 0.5
prr_results_beta1_p_0_5 <- read.table(paste0(results_loc_beta1_p_0_5,"/prr.csv"), header = T)
prr_results_beta10_p_0_5 <- read.table(paste0(results_loc_beta10_p_0_5,"/prr.csv"), header = T)
prr_results_beta50_p_0_5 <- read.table(paste0(results_loc_beta50_p_0_5,"/prr.csv"), header = T)
prr_results_beta100_p_0_5 <- read.table(paste0(results_loc_beta100_p_0_5,"/prr.csv"), header = T)

# dependent, cor = 0.3
prr_results_beta1_dep_0_3_p_0_5 <- read.table(paste0(results_loc_beta1_dep_0_3_p_0_5,"/prr.csv"), header = T)
prr_results_beta10_dep_0_3_p_0_5 <- read.table(paste0(results_loc_beta10_dep_0_3_p_0_5,"/prr.csv"), header = T)
prr_results_beta50_dep_0_3_p_0_5 <- read.table(paste0(results_loc_beta50_dep_0_3_p_0_5,"/prr.csv"), header = T)
prr_results_beta100_dep_0_3_p_0_5 <- read.table(paste0(results_loc_beta100_dep_0_3_p_0_5,"/prr.csv"), header = T)

# dependent, cor = -0.3
prr_results_beta1_dep_neg0_3_p_0_5 <- read.table(paste0(results_loc_beta1_dep_neg0_3_p_0_5,"/prr.csv"), header = T)
prr_results_beta10_dep_neg0_3_p_0_5 <- read.table(paste0(results_loc_beta10_dep_neg0_3_p_0_5,"/prr.csv"), header = T)
prr_results_beta50_dep_neg0_3_p_0_5 <- read.table(paste0(results_loc_beta50_dep_neg0_3_p_0_5,"/prr.csv"), header = T)
prr_results_beta100_dep_neg0_3_p_0_5 <- read.table(paste0(results_loc_beta100_dep_neg0_3_p_0_5,"/prr.csv"), header = T)

# dependent, cor = 0.5
prr_results_beta1_dep_0_5_p_0_5 <- read.table(paste0(results_loc_beta1_dep_0_5_p_0_5,"/prr.csv"), header = T)
prr_results_beta10_dep_0_5_p_0_5 <- read.table(paste0(results_loc_beta10_dep_0_5_p_0_5,"/prr.csv"), header = T)
prr_results_beta50_dep_0_5_p_0_5 <- read.table(paste0(results_loc_beta50_dep_0_5_p_0_5,"/prr.csv"), header = T)
prr_results_beta100_dep_0_5_p_0_5 <- read.table(paste0(results_loc_beta100_dep_0_5_p_0_5,"/prr.csv"), header = T)

# dependent, cor = -0.5
prr_results_beta1_dep_neg0_5_p_0_5 <- read.table(paste0(results_loc_beta1_dep_neg0_5_p_0_5,"/prr.csv"), header = T)
prr_results_beta10_dep_neg0_5_p_0_5 <- read.table(paste0(results_loc_beta10_dep_neg0_5_p_0_5,"/prr.csv"), header = T)
prr_results_beta50_dep_neg0_5_p_0_5 <- read.table(paste0(results_loc_beta50_dep_neg0_5_p_0_5,"/prr.csv"), header = T)
prr_results_beta100_dep_neg0_5_p_0_5 <- read.table(paste0(results_loc_beta100_dep_neg0_5_p_0_5,"/prr.csv"), header = T)

# dependent, cor = 0.7
prr_results_beta1_dep_0_7_p_0_5 <- read.table(paste0(results_loc_beta1_dep_0_7_p_0_5,"/prr.csv"), header = T)
prr_results_beta10_dep_0_7_p_0_5 <- read.table(paste0(results_loc_beta10_dep_0_7_p_0_5,"/prr.csv"), header = T)
prr_results_beta50_dep_0_7_p_0_5 <- read.table(paste0(results_loc_beta50_dep_0_7_p_0_5,"/prr.csv"), header = T)
prr_results_beta100_dep_0_7_p_0_5 <- read.table(paste0(results_loc_beta100_dep_0_7_p_0_5,"/prr.csv"), header = T)

# dependent, cor = -0.7
prr_results_beta1_dep_neg0_7_p_0_5 <- read.table(paste0(results_loc_beta1_dep_neg0_7_p_0_5,"/prr.csv"), header = T)
prr_results_beta10_dep_neg0_7_p_0_5 <- read.table(paste0(results_loc_beta10_dep_neg0_7_p_0_5,"/prr.csv"), header = T)
prr_results_beta50_dep_neg0_7_p_0_5 <- read.table(paste0(results_loc_beta50_dep_neg0_7_p_0_5,"/prr.csv"), header = T)
prr_results_beta100_dep_neg0_7_p_0_5 <- read.table(paste0(results_loc_beta100_dep_neg0_7_p_0_5,"/prr.csv"), header = T)
```

```{r read_rr_values}
#read rr values for each beta
# for p = 0.1
rr_results_beta1_p_0_1 <- read.table(paste0(results_loc_beta1_p_0_1,"/rr.csv"), header = T)
rr_results_beta10_p_0_1 <- read.table(paste0(results_loc_beta10_p_0_1,"/rr.csv"), header = T)
rr_results_beta50_p_0_1 <- read.table(paste0(results_loc_beta50_p_0_1,"/rr.csv"), header = T)
rr_results_beta100_p_0_1 <- read.table(paste0(results_loc_beta100_p_0_1,"/rr.csv"), header = T)

# dependent, cor = 0.3
rr_results_beta1_dep_0_3_p_0_1 <- read.table(paste0(results_loc_beta1_dep_0_3_p_0_1,"/rr.csv"), header = T)
rr_results_beta10_dep_0_3_p_0_1 <- read.table(paste0(results_loc_beta10_dep_0_3_p_0_1,"/rr.csv"), header = T)
rr_results_beta50_dep_0_3_p_0_1 <- read.table(paste0(results_loc_beta50_dep_0_3_p_0_1,"/rr.csv"), header = T)
rr_results_beta100_dep_0_3_p_0_1 <- read.table(paste0(results_loc_beta100_dep_0_3_p_0_1,"/rr.csv"), header = T)

# dependent, cor = -0.3
rr_results_beta1_dep_neg0_3_p_0_1 <- read.table(paste0(results_loc_beta1_dep_neg0_3_p_0_1,"/rr.csv"), header = T)
rr_results_beta10_dep_neg0_3_p_0_1 <- read.table(paste0(results_loc_beta10_dep_neg0_3_p_0_1,"/rr.csv"), header = T)
rr_results_beta50_dep_neg0_3_p_0_1 <- read.table(paste0(results_loc_beta50_dep_neg0_3_p_0_1,"/rr.csv"), header = T)
rr_results_beta100_dep_neg0_3_p_0_1 <- read.table(paste0(results_loc_beta100_dep_neg0_3_p_0_1,"/rr.csv"), header = T)

# dependent, cor = 0.5
rr_results_beta1_dep_0_5_p_0_1 <- read.table(paste0(results_loc_beta1_dep_0_5_p_0_1,"/rr.csv"), header = T)
rr_results_beta10_dep_0_5_p_0_1 <- read.table(paste0(results_loc_beta10_dep_0_5_p_0_1,"/rr.csv"), header = T)
rr_results_beta50_dep_0_5_p_0_1 <- read.table(paste0(results_loc_beta50_dep_0_5_p_0_1,"/rr.csv"), header = T)
rr_results_beta100_dep_0_5_p_0_1 <- read.table(paste0(results_loc_beta100_dep_0_5_p_0_1,"/rr.csv"), header = T)

# dependent, cor = -0.5
rr_results_beta1_dep_neg0_5_p_0_1 <- read.table(paste0(results_loc_beta1_dep_neg0_5_p_0_1,"/rr.csv"), header = T)
rr_results_beta10_dep_neg0_5_p_0_1 <- read.table(paste0(results_loc_beta10_dep_neg0_5_p_0_1,"/rr.csv"), header = T)
rr_results_beta50_dep_neg0_5_p_0_1 <- read.table(paste0(results_loc_beta50_dep_neg0_5_p_0_1,"/rr.csv"), header = T)
rr_results_beta100_dep_neg0_5_p_0_1 <- read.table(paste0(results_loc_beta100_dep_neg0_5_p_0_1,"/rr.csv"), header = T)

# dependent, cor = 0.7
rr_results_beta1_dep_0_7_p_0_1 <- read.table(paste0(results_loc_beta1_dep_0_7_p_0_1,"/rr.csv"), header = T)
rr_results_beta10_dep_0_7_p_0_1 <- read.table(paste0(results_loc_beta10_dep_0_7_p_0_1,"/rr.csv"), header = T)
rr_results_beta50_dep_0_7_p_0_1 <- read.table(paste0(results_loc_beta50_dep_0_7_p_0_1,"/rr.csv"), header = T)
rr_results_beta100_dep_0_7_p_0_1 <- read.table(paste0(results_loc_beta100_dep_0_7_p_0_1,"/rr.csv"), header = T)

# dependent, cor = -0.7
rr_results_beta1_dep_neg0_7_p_0_1 <- read.table(paste0(results_loc_beta1_dep_neg0_7_p_0_1,"/rr.csv"), header = T)
rr_results_beta10_dep_neg0_7_p_0_1 <- read.table(paste0(results_loc_beta10_dep_neg0_7_p_0_1,"/rr.csv"), header = T)
rr_results_beta50_dep_neg0_7_p_0_1 <- read.table(paste0(results_loc_beta50_dep_neg0_7_p_0_1,"/rr.csv"), header = T)
rr_results_beta100_dep_neg0_7_p_0_1 <- read.table(paste0(results_loc_beta100_dep_neg0_7_p_0_1,"/rr.csv"), header = T)

# for p = 0.3
rr_results_beta1_p_0_3 <- read.table(paste0(results_loc_beta1_p_0_3,"/rr.csv"), header = T)
rr_results_beta10_p_0_3 <- read.table(paste0(results_loc_beta10_p_0_3,"/rr.csv"), header = T)
rr_results_beta50_p_0_3 <- read.table(paste0(results_loc_beta50_p_0_3,"/rr.csv"), header = T)
rr_results_beta100_p_0_3 <- read.table(paste0(results_loc_beta100_p_0_3,"/rr.csv"), header = T)

# dependent, cor = 0.3
rr_results_beta1_dep_0_3_p_0_3 <- read.table(paste0(results_loc_beta1_dep_0_3_p_0_3,"/rr.csv"), header = T)
rr_results_beta10_dep_0_3_p_0_3 <- read.table(paste0(results_loc_beta10_dep_0_3_p_0_3,"/rr.csv"), header = T)
rr_results_beta50_dep_0_3_p_0_3 <- read.table(paste0(results_loc_beta50_dep_0_3_p_0_3,"/rr.csv"), header = T)
rr_results_beta100_dep_0_3_p_0_3 <- read.table(paste0(results_loc_beta100_dep_0_3_p_0_3,"/rr.csv"), header = T)

# dependent, cor = -0.3
rr_results_beta1_dep_neg0_3_p_0_3 <- read.table(paste0(results_loc_beta1_dep_neg0_3_p_0_3,"/rr.csv"), header = T)
rr_results_beta10_dep_neg0_3_p_0_3 <- read.table(paste0(results_loc_beta10_dep_neg0_3_p_0_3,"/rr.csv"), header = T)
rr_results_beta50_dep_neg0_3_p_0_3 <- read.table(paste0(results_loc_beta50_dep_neg0_3_p_0_3,"/rr.csv"), header = T)
rr_results_beta100_dep_neg0_3_p_0_3 <- read.table(paste0(results_loc_beta100_dep_neg0_3_p_0_3,"/rr.csv"), header = T)

# dependent, cor = 0.5
rr_results_beta1_dep_0_5_p_0_3 <- read.table(paste0(results_loc_beta1_dep_0_5_p_0_3,"/rr.csv"), header = T)
rr_results_beta10_dep_0_5_p_0_3 <- read.table(paste0(results_loc_beta10_dep_0_5_p_0_3,"/rr.csv"), header = T)
rr_results_beta50_dep_0_5_p_0_3 <- read.table(paste0(results_loc_beta50_dep_0_5_p_0_3,"/rr.csv"), header = T)
rr_results_beta100_dep_0_5_p_0_3 <- read.table(paste0(results_loc_beta100_dep_0_5_p_0_3,"/rr.csv"), header = T)

# dependent, cor = -0.5
rr_results_beta1_dep_neg0_5_p_0_3 <- read.table(paste0(results_loc_beta1_dep_neg0_5_p_0_3,"/rr.csv"), header = T)
rr_results_beta10_dep_neg0_5_p_0_3 <- read.table(paste0(results_loc_beta10_dep_neg0_5_p_0_3,"/rr.csv"), header = T)
rr_results_beta50_dep_neg0_5_p_0_3 <- read.table(paste0(results_loc_beta50_dep_neg0_5_p_0_3,"/rr.csv"), header = T)
rr_results_beta100_dep_neg0_5_p_0_3 <- read.table(paste0(results_loc_beta100_dep_neg0_5_p_0_3,"/rr.csv"), header = T)

# dependent, cor = 0.7
rr_results_beta1_dep_0_7_p_0_3 <- read.table(paste0(results_loc_beta1_dep_0_7_p_0_3,"/rr.csv"), header = T)
rr_results_beta10_dep_0_7_p_0_3 <- read.table(paste0(results_loc_beta10_dep_0_7_p_0_3,"/rr.csv"), header = T)
rr_results_beta50_dep_0_7_p_0_3 <- read.table(paste0(results_loc_beta50_dep_0_7_p_0_3,"/rr.csv"), header = T)
rr_results_beta100_dep_0_7_p_0_3 <- read.table(paste0(results_loc_beta100_dep_0_7_p_0_3,"/rr.csv"), header = T)

# dependent, cor = -0.7
rr_results_beta1_dep_neg0_7_p_0_3 <- read.table(paste0(results_loc_beta1_dep_neg0_7_p_0_3,"/rr.csv"), header = T)
rr_results_beta10_dep_neg0_7_p_0_3 <- read.table(paste0(results_loc_beta10_dep_neg0_7_p_0_3,"/rr.csv"), header = T)
rr_results_beta50_dep_neg0_7_p_0_3 <- read.table(paste0(results_loc_beta50_dep_neg0_7_p_0_3,"/rr.csv"), header = T)
rr_results_beta100_dep_neg0_7_p_0_3 <- read.table(paste0(results_loc_beta100_dep_neg0_7_p_0_3,"/rr.csv"), header = T)

# for p = 0.5
rr_results_beta1_p_0_5 <- read.table(paste0(results_loc_beta1_p_0_5,"/rr.csv"), header = T)
rr_results_beta10_p_0_5 <- read.table(paste0(results_loc_beta10_p_0_5,"/rr.csv"), header = T)
rr_results_beta50_p_0_5 <- read.table(paste0(results_loc_beta50_p_0_5,"/rr.csv"), header = T)
rr_results_beta100_p_0_5 <- read.table(paste0(results_loc_beta100_p_0_5,"/rr.csv"), header = T)

# dependent, cor = 0.3
rr_results_beta1_dep_0_3_p_0_5 <- read.table(paste0(results_loc_beta1_dep_0_3_p_0_5,"/rr.csv"), header = T)
rr_results_beta10_dep_0_3_p_0_5 <- read.table(paste0(results_loc_beta10_dep_0_3_p_0_5,"/rr.csv"), header = T)
rr_results_beta50_dep_0_3_p_0_5 <- read.table(paste0(results_loc_beta50_dep_0_3_p_0_5,"/rr.csv"), header = T)
rr_results_beta100_dep_0_3_p_0_5 <- read.table(paste0(results_loc_beta100_dep_0_3_p_0_5,"/rr.csv"), header = T)

# dependent, cor = -0.3
rr_results_beta1_dep_neg0_3_p_0_5 <- read.table(paste0(results_loc_beta1_dep_neg0_3_p_0_5,"/rr.csv"), header = T)
rr_results_beta10_dep_neg0_3_p_0_5 <- read.table(paste0(results_loc_beta10_dep_neg0_3_p_0_5,"/rr.csv"), header = T)
rr_results_beta50_dep_neg0_3_p_0_5 <- read.table(paste0(results_loc_beta50_dep_neg0_3_p_0_5,"/rr.csv"), header = T)
rr_results_beta100_dep_neg0_3_p_0_5 <- read.table(paste0(results_loc_beta100_dep_neg0_3_p_0_5,"/rr.csv"), header = T)

# dependent, cor = 0.5
rr_results_beta1_dep_0_5_p_0_5 <- read.table(paste0(results_loc_beta1_dep_0_5_p_0_5,"/rr.csv"), header = T)
rr_results_beta10_dep_0_5_p_0_5 <- read.table(paste0(results_loc_beta10_dep_0_5_p_0_5,"/rr.csv"), header = T)
rr_results_beta50_dep_0_5_p_0_5 <- read.table(paste0(results_loc_beta50_dep_0_5_p_0_5,"/rr.csv"), header = T)
rr_results_beta100_dep_0_5_p_0_5 <- read.table(paste0(results_loc_beta100_dep_0_5_p_0_5,"/rr.csv"), header = T)

# dependent, cor = -0.5
rr_results_beta1_dep_neg0_5_p_0_5 <- read.table(paste0(results_loc_beta1_dep_neg0_5_p_0_5,"/rr.csv"), header = T)
rr_results_beta10_dep_neg0_5_p_0_5 <- read.table(paste0(results_loc_beta10_dep_neg0_5_p_0_5,"/rr.csv"), header = T)
rr_results_beta50_dep_neg0_5_p_0_5 <- read.table(paste0(results_loc_beta50_dep_neg0_5_p_0_5,"/rr.csv"), header = T)
rr_results_beta100_dep_neg0_5_p_0_5 <- read.table(paste0(results_loc_beta100_dep_neg0_5_p_0_5,"/rr.csv"), header = T)

# dependent, cor = 0.7
rr_results_beta1_dep_0_7_p_0_5 <- read.table(paste0(results_loc_beta1_dep_0_7_p_0_5,"/rr.csv"), header = T)
rr_results_beta10_dep_0_7_p_0_5 <- read.table(paste0(results_loc_beta10_dep_0_7_p_0_5,"/rr.csv"), header = T)
rr_results_beta50_dep_0_7_p_0_5 <- read.table(paste0(results_loc_beta50_dep_0_7_p_0_5,"/rr.csv"), header = T)
rr_results_beta100_dep_0_7_p_0_5 <- read.table(paste0(results_loc_beta100_dep_0_7_p_0_5,"/rr.csv"), header = T)

# dependent, cor = -0.7
rr_results_beta1_dep_neg0_7_p_0_5 <- read.table(paste0(results_loc_beta1_dep_neg0_7_p_0_5,"/rr.csv"), header = T)
rr_results_beta10_dep_neg0_7_p_0_5 <- read.table(paste0(results_loc_beta10_dep_neg0_7_p_0_5,"/rr.csv"), header = T)
rr_results_beta50_dep_neg0_7_p_0_5 <- read.table(paste0(results_loc_beta50_dep_neg0_7_p_0_5,"/rr.csv"), header = T)
rr_results_beta100_dep_neg0_7_p_0_5 <- read.table(paste0(results_loc_beta100_dep_neg0_7_p_0_5,"/rr.csv"), header = T)
```

```{r read_ror_values}
#read ror values for each beta
# for p = 0.1
ror_results_beta1_p_0_1 <- read.table(paste0(results_loc_beta1_p_0_1,"/ror.csv"), header = T)
ror_results_beta10_p_0_1 <- read.table(paste0(results_loc_beta10_p_0_1,"/ror.csv"), header = T)
ror_results_beta50_p_0_1 <- read.table(paste0(results_loc_beta50_p_0_1,"/ror.csv"), header = T)
ror_results_beta100_p_0_1 <- read.table(paste0(results_loc_beta100_p_0_1,"/ror.csv"), header = T)

# dependent, cor = 0.3
ror_results_beta1_dep_0_3_p_0_1 <- read.table(paste0(results_loc_beta1_dep_0_3_p_0_1,"/ror.csv"), header = T)
ror_results_beta10_dep_0_3_p_0_1 <- read.table(paste0(results_loc_beta10_dep_0_3_p_0_1,"/ror.csv"), header = T)
ror_results_beta50_dep_0_3_p_0_1 <- read.table(paste0(results_loc_beta50_dep_0_3_p_0_1,"/ror.csv"), header = T)
ror_results_beta100_dep_0_3_p_0_1 <- read.table(paste0(results_loc_beta100_dep_0_3_p_0_1,"/ror.csv"), header = T)

# dependent, cor = -0.3
ror_results_beta1_dep_neg0_3_p_0_1 <- read.table(paste0(results_loc_beta1_dep_neg0_3_p_0_1,"/ror.csv"), header = T)
ror_results_beta10_dep_neg0_3_p_0_1 <- read.table(paste0(results_loc_beta10_dep_neg0_3_p_0_1,"/ror.csv"), header = T)
ror_results_beta50_dep_neg0_3_p_0_1 <- read.table(paste0(results_loc_beta50_dep_neg0_3_p_0_1,"/ror.csv"), header = T)
ror_results_beta100_dep_neg0_3_p_0_1 <- read.table(paste0(results_loc_beta100_dep_neg0_3_p_0_1,"/ror.csv"), header = T)

# dependent, cor = 0.5
ror_results_beta1_dep_0_5_p_0_1 <- read.table(paste0(results_loc_beta1_dep_0_5_p_0_1,"/ror.csv"), header = T)
ror_results_beta10_dep_0_5_p_0_1 <- read.table(paste0(results_loc_beta10_dep_0_5_p_0_1,"/ror.csv"), header = T)
ror_results_beta50_dep_0_5_p_0_1 <- read.table(paste0(results_loc_beta50_dep_0_5_p_0_1,"/ror.csv"), header = T)
ror_results_beta100_dep_0_5_p_0_1 <- read.table(paste0(results_loc_beta100_dep_0_5_p_0_1,"/ror.csv"), header = T)

# dependent, cor = -0.5
ror_results_beta1_dep_neg0_5_p_0_1 <- read.table(paste0(results_loc_beta1_dep_neg0_5_p_0_1,"/ror.csv"), header = T)
ror_results_beta10_dep_neg0_5_p_0_1 <- read.table(paste0(results_loc_beta10_dep_neg0_5_p_0_1,"/ror.csv"), header = T)
ror_results_beta50_dep_neg0_5_p_0_1 <- read.table(paste0(results_loc_beta50_dep_neg0_5_p_0_1,"/ror.csv"), header = T)
ror_results_beta100_dep_neg0_5_p_0_1 <- read.table(paste0(results_loc_beta100_dep_neg0_5_p_0_1,"/ror.csv"), header = T)

# dependent, cor = 0.7
ror_results_beta1_dep_0_7_p_0_1 <- read.table(paste0(results_loc_beta1_dep_0_7_p_0_1,"/ror.csv"), header = T)
ror_results_beta10_dep_0_7_p_0_1 <- read.table(paste0(results_loc_beta10_dep_0_7_p_0_1,"/ror.csv"), header = T)
ror_results_beta50_dep_0_7_p_0_1 <- read.table(paste0(results_loc_beta50_dep_0_7_p_0_1,"/ror.csv"), header = T)
ror_results_beta100_dep_0_7_p_0_1 <- read.table(paste0(results_loc_beta100_dep_0_7_p_0_1,"/ror.csv"), header = T)

# dependent, cor = -0.7
ror_results_beta1_dep_neg0_7_p_0_1 <- read.table(paste0(results_loc_beta1_dep_neg0_7_p_0_1,"/ror.csv"), header = T)
ror_results_beta10_dep_neg0_7_p_0_1 <- read.table(paste0(results_loc_beta10_dep_neg0_7_p_0_1,"/ror.csv"), header = T)
ror_results_beta50_dep_neg0_7_p_0_1 <- read.table(paste0(results_loc_beta50_dep_neg0_7_p_0_1,"/ror.csv"), header = T)
ror_results_beta100_dep_neg0_7_p_0_1 <- read.table(paste0(results_loc_beta100_dep_neg0_7_p_0_1,"/ror.csv"), header = T)

# for p = 0.3
ror_results_beta1_p_0_3 <- read.table(paste0(results_loc_beta1_p_0_3,"/ror.csv"), header = T)
ror_results_beta10_p_0_3 <- read.table(paste0(results_loc_beta10_p_0_3,"/ror.csv"), header = T)
ror_results_beta50_p_0_3 <- read.table(paste0(results_loc_beta50_p_0_3,"/ror.csv"), header = T)
ror_results_beta100_p_0_3 <- read.table(paste0(results_loc_beta100_p_0_3,"/ror.csv"), header = T)

# dependent, cor = 0.3
ror_results_beta1_dep_0_3_p_0_3 <- read.table(paste0(results_loc_beta1_dep_0_3_p_0_3,"/ror.csv"), header = T)
ror_results_beta10_dep_0_3_p_0_3 <- read.table(paste0(results_loc_beta10_dep_0_3_p_0_3,"/ror.csv"), header = T)
ror_results_beta50_dep_0_3_p_0_3 <- read.table(paste0(results_loc_beta50_dep_0_3_p_0_3,"/ror.csv"), header = T)
ror_results_beta100_dep_0_3_p_0_3 <- read.table(paste0(results_loc_beta100_dep_0_3_p_0_3,"/ror.csv"), header = T)

# dependent, cor = -0.3
ror_results_beta1_dep_neg0_3_p_0_3 <- read.table(paste0(results_loc_beta1_dep_neg0_3_p_0_3,"/ror.csv"), header = T)
ror_results_beta10_dep_neg0_3_p_0_3 <- read.table(paste0(results_loc_beta10_dep_neg0_3_p_0_3,"/ror.csv"), header = T)
ror_results_beta50_dep_neg0_3_p_0_3 <- read.table(paste0(results_loc_beta50_dep_neg0_3_p_0_3,"/ror.csv"), header = T)
ror_results_beta100_dep_neg0_3_p_0_3 <- read.table(paste0(results_loc_beta100_dep_neg0_3_p_0_3,"/ror.csv"), header = T)

# dependent, cor = 0.5
ror_results_beta1_dep_0_5_p_0_3 <- read.table(paste0(results_loc_beta1_dep_0_5_p_0_3,"/ror.csv"), header = T)
ror_results_beta10_dep_0_5_p_0_3 <- read.table(paste0(results_loc_beta10_dep_0_5_p_0_3,"/ror.csv"), header = T)
ror_results_beta50_dep_0_5_p_0_3 <- read.table(paste0(results_loc_beta50_dep_0_5_p_0_3,"/ror.csv"), header = T)
ror_results_beta100_dep_0_5_p_0_3 <- read.table(paste0(results_loc_beta100_dep_0_5_p_0_3,"/ror.csv"), header = T)

# dependent, cor = -0.5
ror_results_beta1_dep_neg0_5_p_0_3 <- read.table(paste0(results_loc_beta1_dep_neg0_5_p_0_3,"/ror.csv"), header = T)
ror_results_beta10_dep_neg0_5_p_0_3 <- read.table(paste0(results_loc_beta10_dep_neg0_5_p_0_3,"/ror.csv"), header = T)
ror_results_beta50_dep_neg0_5_p_0_3 <- read.table(paste0(results_loc_beta50_dep_neg0_5_p_0_3,"/ror.csv"), header = T)
ror_results_beta100_dep_neg0_5_p_0_3 <- read.table(paste0(results_loc_beta100_dep_neg0_5_p_0_3,"/ror.csv"), header = T)

# dependent, cor = 0.7
ror_results_beta1_dep_0_7_p_0_3 <- read.table(paste0(results_loc_beta1_dep_0_7_p_0_3,"/ror.csv"), header = T)
ror_results_beta10_dep_0_7_p_0_3 <- read.table(paste0(results_loc_beta10_dep_0_7_p_0_3,"/ror.csv"), header = T)
ror_results_beta50_dep_0_7_p_0_3 <- read.table(paste0(results_loc_beta50_dep_0_7_p_0_3,"/ror.csv"), header = T)
ror_results_beta100_dep_0_7_p_0_3 <- read.table(paste0(results_loc_beta100_dep_0_7_p_0_3,"/ror.csv"), header = T)

# dependent, cor = -0.7
ror_results_beta1_dep_neg0_7_p_0_3 <- read.table(paste0(results_loc_beta1_dep_neg0_7_p_0_3,"/ror.csv"), header = T)
ror_results_beta10_dep_neg0_7_p_0_3 <- read.table(paste0(results_loc_beta10_dep_neg0_7_p_0_3,"/ror.csv"), header = T)
ror_results_beta50_dep_neg0_7_p_0_3 <- read.table(paste0(results_loc_beta50_dep_neg0_7_p_0_3,"/ror.csv"), header = T)
ror_results_beta100_dep_neg0_7_p_0_3 <- read.table(paste0(results_loc_beta100_dep_neg0_7_p_0_3,"/ror.csv"), header = T)

# for p = 0.5
ror_results_beta1_p_0_5 <- read.table(paste0(results_loc_beta1_p_0_5,"/ror.csv"), header = T)
ror_results_beta10_p_0_5 <- read.table(paste0(results_loc_beta10_p_0_5,"/ror.csv"), header = T)
ror_results_beta50_p_0_5 <- read.table(paste0(results_loc_beta50_p_0_5,"/ror.csv"), header = T)
ror_results_beta100_p_0_5 <- read.table(paste0(results_loc_beta100_p_0_5,"/ror.csv"), header = T)

# dependent, cor = 0.3
ror_results_beta1_dep_0_3_p_0_5 <- read.table(paste0(results_loc_beta1_dep_0_3_p_0_5,"/ror.csv"), header = T)
ror_results_beta10_dep_0_3_p_0_5 <- read.table(paste0(results_loc_beta10_dep_0_3_p_0_5,"/ror.csv"), header = T)
ror_results_beta50_dep_0_3_p_0_5 <- read.table(paste0(results_loc_beta50_dep_0_3_p_0_5,"/ror.csv"), header = T)
ror_results_beta100_dep_0_3_p_0_5 <- read.table(paste0(results_loc_beta100_dep_0_3_p_0_5,"/ror.csv"), header = T)

# dependent, cor = -0.3
ror_results_beta1_dep_neg0_3_p_0_5 <- read.table(paste0(results_loc_beta1_dep_neg0_3_p_0_5,"/ror.csv"), header = T)
ror_results_beta10_dep_neg0_3_p_0_5 <- read.table(paste0(results_loc_beta10_dep_neg0_3_p_0_5,"/ror.csv"), header = T)
ror_results_beta50_dep_neg0_3_p_0_5 <- read.table(paste0(results_loc_beta50_dep_neg0_3_p_0_5,"/ror.csv"), header = T)
ror_results_beta100_dep_neg0_3_p_0_5 <- read.table(paste0(results_loc_beta100_dep_neg0_3_p_0_5,"/ror.csv"), header = T)

# dependent, cor = 0.5
ror_results_beta1_dep_0_5_p_0_5 <- read.table(paste0(results_loc_beta1_dep_0_5_p_0_5,"/ror.csv"), header = T)
ror_results_beta10_dep_0_5_p_0_5 <- read.table(paste0(results_loc_beta10_dep_0_5_p_0_5,"/ror.csv"), header = T)
ror_results_beta50_dep_0_5_p_0_5 <- read.table(paste0(results_loc_beta50_dep_0_5_p_0_5,"/ror.csv"), header = T)
ror_results_beta100_dep_0_5_p_0_5 <- read.table(paste0(results_loc_beta100_dep_0_5_p_0_5,"/ror.csv"), header = T)

# dependent, cor = -0.5
ror_results_beta1_dep_neg0_5_p_0_5 <- read.table(paste0(results_loc_beta1_dep_neg0_5_p_0_5,"/ror.csv"), header = T)
ror_results_beta10_dep_neg0_5_p_0_5 <- read.table(paste0(results_loc_beta10_dep_neg0_5_p_0_5,"/ror.csv"), header = T)
ror_results_beta50_dep_neg0_5_p_0_5 <- read.table(paste0(results_loc_beta50_dep_neg0_5_p_0_5,"/ror.csv"), header = T)
ror_results_beta100_dep_neg0_5_p_0_5 <- read.table(paste0(results_loc_beta100_dep_neg0_5_p_0_5,"/ror.csv"), header = T)

# dependent, cor = 0.7
ror_results_beta1_dep_0_7_p_0_5 <- read.table(paste0(results_loc_beta1_dep_0_7_p_0_5,"/ror.csv"), header = T)
ror_results_beta10_dep_0_7_p_0_5 <- read.table(paste0(results_loc_beta10_dep_0_7_p_0_5,"/ror.csv"), header = T)
ror_results_beta50_dep_0_7_p_0_5 <- read.table(paste0(results_loc_beta50_dep_0_7_p_0_5,"/ror.csv"), header = T)
ror_results_beta100_dep_0_7_p_0_5 <- read.table(paste0(results_loc_beta100_dep_0_7_p_0_5,"/ror.csv"), header = T)

# dependent, cor = -0.7
ror_results_beta1_dep_neg0_7_p_0_5 <- read.table(paste0(results_loc_beta1_dep_neg0_7_p_0_5,"/ror.csv"), header = T)
ror_results_beta10_dep_neg0_7_p_0_5 <- read.table(paste0(results_loc_beta10_dep_neg0_7_p_0_5,"/ror.csv"), header = T)
ror_results_beta50_dep_neg0_7_p_0_5 <- read.table(paste0(results_loc_beta50_dep_neg0_7_p_0_5,"/ror.csv"), header = T)
ror_results_beta100_dep_neg0_7_p_0_5 <- read.table(paste0(results_loc_beta100_dep_neg0_7_p_0_5,"/ror.csv"), header = T)
```

## fixed beta and fixed p

```{r b_1_p_0_1}
conf_thresh <- as.factor(rep(c(0.4,0.5,0.6,0.7), 7))
prr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 7))
rr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 7))
ror_thresh <- as.factor(rep(c(1,1.2,1.5,2), 7))
corr <- as.factor(c(rep(0,4), rep(0.3,8), rep(0.5,8), rep(0.7,8)))
#corr <- as.factor(c(rep(0,4), rep(0.3,4), rep(-0.3,4), rep(0.5,4), rep(-0.5,4), rep(0.7,4), rep(-0.7,4)))
sgn <- as.factor(c(rep(0,4), rep("+",4), rep("-",4), rep("+",4), rep("-",4), rep("+",4), rep("-",4)))

#sensitivity plots
#confidence thresholds
mean_sens_conf <- as.numeric(c(conf_results_beta1_p_0_1[1,], conf_results_beta1_dep_0_3_p_0_1[1,], conf_results_beta1_dep_neg0_3_p_0_1[1,], conf_results_beta1_dep_0_5_p_0_1[1,], conf_results_beta1_dep_neg0_5_p_0_1[1,], conf_results_beta1_dep_0_7_p_0_1[1,], conf_results_beta1_dep_neg0_7_p_0_1[1,]))

#prr thresholds
mean_sens_prr <- as.numeric(c(prr_results_beta1_p_0_1[1,], prr_results_beta1_dep_0_3_p_0_1[1,], prr_results_beta1_dep_neg0_3_p_0_1[1,], prr_results_beta1_dep_0_5_p_0_1[1,], prr_results_beta1_dep_neg0_5_p_0_1[1,], prr_results_beta1_dep_0_7_p_0_1[1,], prr_results_beta1_dep_neg0_7_p_0_1[1,]))

#rr thresholds
mean_sens_rr <- as.numeric(c(rr_results_beta1_p_0_1[1,], rr_results_beta1_dep_0_3_p_0_1[1,], rr_results_beta1_dep_neg0_3_p_0_1[1,], rr_results_beta1_dep_0_5_p_0_1[1,], rr_results_beta1_dep_neg0_5_p_0_1[1,], rr_results_beta1_dep_0_7_p_0_1[1,], rr_results_beta1_dep_neg0_7_p_0_1[1,]))

#ror thresholds
mean_sens_ror <- as.numeric(c(ror_results_beta1_p_0_1[1,], ror_results_beta1_dep_0_3_p_0_1[1,], ror_results_beta1_dep_neg0_3_p_0_1[1,], ror_results_beta1_dep_0_5_p_0_1[1,], ror_results_beta1_dep_neg0_5_p_0_1[1,], ror_results_beta1_dep_0_7_p_0_1[1,], ror_results_beta1_dep_neg0_7_p_0_1[1,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=corr)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Sensitivity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_sens_prr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=prr_thresh, y=mean_sens_prr, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Sensitivity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_sens_rr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=rr_thresh, y=mean_sens_rr, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Sensitivity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_sens_ror, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=ror_thresh, y=mean_sens_ror, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Sensitivity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=corr)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  scale_color_manual(breaks = c(0.3,0.5,0.7), values = c("#1f78b4","#b2df8a","#fb9a99","darkslategrey"), name=paste0("absolute correlation |", greeks("rho"), "|")) +
  labs(y="Mean Sensitivity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  scale_linetype_manual(values=c("dotted","dashed","solid"), name="direction") +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_sens_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Sensitivity plots for Setting 3 (\U03B2 = 1, p = 0.1)")

sens_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p/beta1_p0_1/sens.png"
combined_sens_plot
ggsave(filename = sens_plot_file, plot = combined_sens_plot)

## specificity plots
#confidence thresholds
mean_spec_conf <- as.numeric(c(conf_results_beta1_p_0_1[2,], conf_results_beta1_dep_0_3_p_0_1[2,], conf_results_beta1_dep_neg0_3_p_0_1[2,], conf_results_beta1_dep_0_5_p_0_1[2,], conf_results_beta1_dep_neg0_5_p_0_1[2,], conf_results_beta1_dep_0_7_p_0_1[2,], conf_results_beta1_dep_neg0_7_p_0_1[2,]))

#prr thresholds
mean_spec_prr <- as.numeric(c(prr_results_beta1_p_0_1[2,], prr_results_beta1_dep_0_3_p_0_1[2,], prr_results_beta1_dep_neg0_3_p_0_1[2,], prr_results_beta1_dep_0_5_p_0_1[2,], prr_results_beta1_dep_neg0_5_p_0_1[2,], prr_results_beta1_dep_0_7_p_0_1[2,], prr_results_beta1_dep_neg0_7_p_0_1[2,]))

#rr thresholds
mean_spec_rr <- as.numeric(c(rr_results_beta1_p_0_1[2,], rr_results_beta1_dep_0_3_p_0_1[2,], rr_results_beta1_dep_neg0_3_p_0_1[2,], rr_results_beta1_dep_0_5_p_0_1[2,], rr_results_beta1_dep_neg0_5_p_0_1[2,], rr_results_beta1_dep_0_7_p_0_1[2,], rr_results_beta1_dep_neg0_7_p_0_1[2,]))

#ror thresholds
mean_spec_ror <- as.numeric(c(ror_results_beta1_p_0_1[2,], ror_results_beta1_dep_0_3_p_0_1[2,], ror_results_beta1_dep_neg0_3_p_0_1[2,], ror_results_beta1_dep_0_5_p_0_1[2,], ror_results_beta1_dep_neg0_5_p_0_1[2,], ror_results_beta1_dep_0_7_p_0_1[2,], ror_results_beta1_dep_neg0_7_p_0_1[2,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=corr)) + 
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Specificity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_spec_prr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=prr_thresh, y=mean_spec_prr, color=corr)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Specificity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_spec_rr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=rr_thresh, y=mean_spec_rr, color=corr)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Specificity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_spec_ror, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=ror_thresh, y=mean_spec_ror, color=corr)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Specificity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=corr)) + 
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  scale_color_manual(breaks = c(0.3,0.5,0.7), values = c("#1f78b4","#b2df8a","#fb9a99","darkslategrey"), name=paste("absolute correlation |", greeks("rho"), "|")) +
  scale_linetype_manual(values=c("dotted","dashed","solid"), name="direction") +
  labs(y="Mean Specificity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

combined_spec_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Specificity plots for Setting 3 (\U03B2 = 1, p = 0.1)")
spec_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p/beta1_p0_1/spec.png"
combined_spec_plot
ggsave(filename = spec_plot_file, plot = combined_spec_plot)

## overall accuracy plots
#confidence thresholds
mean_acc_conf <- as.numeric(c(conf_results_beta1_p_0_1[5,], conf_results_beta1_dep_0_3_p_0_1[5,], conf_results_beta1_dep_neg0_3_p_0_1[5,], conf_results_beta1_dep_0_5_p_0_1[5,], conf_results_beta1_dep_neg0_5_p_0_1[5,], conf_results_beta1_dep_0_7_p_0_1[5,], conf_results_beta1_dep_neg0_7_p_0_1[5,]))

#prr thresholds
mean_acc_prr <- as.numeric(c(prr_results_beta1_p_0_1[5,], prr_results_beta1_dep_0_3_p_0_1[5,], prr_results_beta1_dep_neg0_3_p_0_1[5,], prr_results_beta1_dep_0_5_p_0_1[5,], prr_results_beta1_dep_neg0_5_p_0_1[5,], prr_results_beta1_dep_0_7_p_0_1[5,], prr_results_beta1_dep_neg0_7_p_0_1[5,]))

#rr thresholds
mean_acc_rr <- as.numeric(c(rr_results_beta1_p_0_1[5,], rr_results_beta1_dep_0_3_p_0_1[5,], rr_results_beta1_dep_neg0_3_p_0_1[5,], rr_results_beta1_dep_0_5_p_0_1[5,], rr_results_beta1_dep_neg0_5_p_0_1[5,], rr_results_beta1_dep_0_7_p_0_1[5,], rr_results_beta1_dep_neg0_7_p_0_1[5,]))

#ror thresholds
mean_acc_ror <- as.numeric(c(ror_results_beta1_p_0_1[5,], ror_results_beta1_dep_0_3_p_0_1[5,], ror_results_beta1_dep_neg0_3_p_0_1[5,], ror_results_beta1_dep_0_5_p_0_1[5,], ror_results_beta1_dep_neg0_5_p_0_1[5,], ror_results_beta1_dep_0_7_p_0_1[5,], ror_results_beta1_dep_neg0_7_p_0_1[5,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=corr)) + 
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_acc_prr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=prr_thresh, y=mean_acc_prr, color=corr)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Overall Accuracy", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_acc_rr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=rr_thresh, y=mean_acc_rr, color=corr)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Overall Accuracy", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_acc_ror, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=ror_thresh, y=mean_acc_ror, color=corr)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Overall Accuracy", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=corr)) + 
  ylim(0.5,1) +
  scale_color_manual(breaks = c(0.3,0.5,0.7), values = c("#1f78b4","#b2df8a","#fb9a99","darkslategrey"), name=paste("correlation", greeks("rho"))) +
  scale_linetype_manual(values=c("dotted","dashed","solid"), name="direction") +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") + 
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_acc_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Overall Accuracy plots for Setting 3 (\U03B2 = 1, p = 0.1)")

acc_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p/beta1_p0_1/acc.png"
combined_acc_plot
ggsave(filename = acc_plot_file, plot = combined_acc_plot)
```

```{r b_1_p_0_3}
conf_thresh <- as.factor(rep(c(0.4,0.5,0.6,0.7), 7))
prr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 7))
rr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 7))
ror_thresh <- as.factor(rep(c(1,1.2,1.5,2), 7))
corr <- as.factor(c(rep(0,4), rep(0.3,8), rep(0.5,8), rep(0.7,8)))
#corr <- as.factor(c(rep(0,4), rep(0.3,4), rep(-0.3,4), rep(0.5,4), rep(-0.5,4), rep(0.7,4), rep(-0.7,4)))
sgn <- as.factor(c(rep(0,4), rep("+",4), rep("-",4), rep("+",4), rep("-",4), rep("+",4), rep("-",4)))

#sensitivity plots
#confidence thresholds
mean_sens_conf <- as.numeric(c(conf_results_beta1_p_0_3[1,], conf_results_beta1_dep_0_3_p_0_3[1,], conf_results_beta1_dep_neg0_3_p_0_3[1,], conf_results_beta1_dep_0_5_p_0_3[1,], conf_results_beta1_dep_neg0_5_p_0_3[1,], conf_results_beta1_dep_0_7_p_0_3[1,], conf_results_beta1_dep_neg0_7_p_0_3[1,]))

#prr thresholds
mean_sens_prr <- as.numeric(c(prr_results_beta1_p_0_3[1,], prr_results_beta1_dep_0_3_p_0_3[1,], prr_results_beta1_dep_neg0_3_p_0_3[1,], prr_results_beta1_dep_0_5_p_0_3[1,], prr_results_beta1_dep_neg0_5_p_0_3[1,], prr_results_beta1_dep_0_7_p_0_3[1,], prr_results_beta1_dep_neg0_7_p_0_3[1,]))

#rr thresholds
mean_sens_rr <- as.numeric(c(rr_results_beta1_p_0_3[1,], rr_results_beta1_dep_0_3_p_0_3[1,], rr_results_beta1_dep_neg0_3_p_0_3[1,], rr_results_beta1_dep_0_5_p_0_3[1,], rr_results_beta1_dep_neg0_5_p_0_3[1,], rr_results_beta1_dep_0_7_p_0_3[1,], rr_results_beta1_dep_neg0_7_p_0_3[1,]))

#ror thresholds
mean_sens_ror <- as.numeric(c(ror_results_beta1_p_0_3[1,], ror_results_beta1_dep_0_3_p_0_3[1,], ror_results_beta1_dep_neg0_3_p_0_3[1,], ror_results_beta1_dep_0_5_p_0_3[1,], ror_results_beta1_dep_neg0_5_p_0_3[1,], ror_results_beta1_dep_0_7_p_0_3[1,], ror_results_beta1_dep_neg0_7_p_0_3[1,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=corr)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Sensitivity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_sens_prr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=prr_thresh, y=mean_sens_prr, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Sensitivity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_sens_rr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=rr_thresh, y=mean_sens_rr, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Sensitivity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_sens_ror, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=ror_thresh, y=mean_sens_ror, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Sensitivity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=corr)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  scale_color_manual(breaks = c(0.3,0.5,0.7), values = c("#1f78b4","#b2df8a","#fb9a99","darkslategrey"), name=paste0("absolute correlation |", greeks("rho"), "|")) +
  labs(y="Mean Sensitivity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  scale_linetype_manual(values=c("dotted","dashed","solid"), name="direction") +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_sens_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Sensitivity plots for Setting 3 (\U03B2 = 1, p = 0.3)")

sens_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p/beta1_p0_3/sens.png"
combined_sens_plot
ggsave(filename = sens_plot_file, plot = combined_sens_plot)

## specificity plots
#confidence thresholds
mean_spec_conf <- as.numeric(c(conf_results_beta1_p_0_3[2,], conf_results_beta1_dep_0_3_p_0_3[2,], conf_results_beta1_dep_neg0_3_p_0_3[2,], conf_results_beta1_dep_0_5_p_0_3[2,], conf_results_beta1_dep_neg0_5_p_0_3[2,], conf_results_beta1_dep_0_7_p_0_3[2,], conf_results_beta1_dep_neg0_7_p_0_3[2,]))

#prr thresholds
mean_spec_prr <- as.numeric(c(prr_results_beta1_p_0_3[2,], prr_results_beta1_dep_0_3_p_0_3[2,], prr_results_beta1_dep_neg0_3_p_0_3[2,], prr_results_beta1_dep_0_5_p_0_3[2,], prr_results_beta1_dep_neg0_5_p_0_3[2,], prr_results_beta1_dep_0_7_p_0_3[2,], prr_results_beta1_dep_neg0_7_p_0_3[2,]))

#rr thresholds
mean_spec_rr <- as.numeric(c(rr_results_beta1_p_0_3[2,], rr_results_beta1_dep_0_3_p_0_3[2,], rr_results_beta1_dep_neg0_3_p_0_3[2,], rr_results_beta1_dep_0_5_p_0_3[2,], rr_results_beta1_dep_neg0_5_p_0_3[2,], rr_results_beta1_dep_0_7_p_0_3[2,], rr_results_beta1_dep_neg0_7_p_0_3[2,]))

#ror thresholds
mean_spec_ror <- as.numeric(c(ror_results_beta1_p_0_3[2,], ror_results_beta1_dep_0_3_p_0_3[2,], ror_results_beta1_dep_neg0_3_p_0_3[2,], ror_results_beta1_dep_0_5_p_0_3[2,], ror_results_beta1_dep_neg0_5_p_0_3[2,], ror_results_beta1_dep_0_7_p_0_3[2,], ror_results_beta1_dep_neg0_7_p_0_3[2,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=corr)) + 
  ylim(0.4,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Specificity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_spec_prr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=prr_thresh, y=mean_spec_prr, color=corr)) +
  ylim(0.4,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Specificity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_spec_rr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=rr_thresh, y=mean_spec_rr, color=corr)) +
  ylim(0.4,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Specificity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_spec_ror, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=ror_thresh, y=mean_spec_ror, color=corr)) +
  ylim(0.4,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Specificity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=corr)) + 
  ylim(0.4,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  scale_color_manual(breaks = c(0.3,0.5,0.7), values = c("#1f78b4","#b2df8a","#fb9a99","darkslategrey"), name=paste0("absolute correlation |", greeks("rho"), "|")) +
  scale_linetype_manual(values=c("dotted","dashed","solid"), name="direction") +
  labs(y="Mean Specificity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

combined_spec_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Specificity plots for Setting 3 (\U03B2 = 1, p = 0.3)")
spec_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p/beta1_p0_3/spec.png"
combined_spec_plot
ggsave(filename = spec_plot_file, plot = combined_spec_plot)

## overall accuracy plots
#confidence thresholds
mean_acc_conf <- as.numeric(c(conf_results_beta1_p_0_3[5,], conf_results_beta1_dep_0_3_p_0_3[5,], conf_results_beta1_dep_neg0_3_p_0_3[5,], conf_results_beta1_dep_0_5_p_0_3[5,], conf_results_beta1_dep_neg0_5_p_0_3[5,], conf_results_beta1_dep_0_7_p_0_3[5,], conf_results_beta1_dep_neg0_7_p_0_3[5,]))

#prr thresholds
mean_acc_prr <- as.numeric(c(prr_results_beta1_p_0_3[5,], prr_results_beta1_dep_0_3_p_0_3[5,], prr_results_beta1_dep_neg0_3_p_0_3[5,], prr_results_beta1_dep_0_5_p_0_3[5,], prr_results_beta1_dep_neg0_5_p_0_3[5,], prr_results_beta1_dep_0_7_p_0_3[5,], prr_results_beta1_dep_neg0_7_p_0_3[5,]))

#rr thresholds
mean_acc_rr <- as.numeric(c(rr_results_beta1_p_0_3[5,], rr_results_beta1_dep_0_3_p_0_3[5,], rr_results_beta1_dep_neg0_3_p_0_3[5,], rr_results_beta1_dep_0_5_p_0_3[5,], rr_results_beta1_dep_neg0_5_p_0_3[5,], rr_results_beta1_dep_0_7_p_0_3[5,], rr_results_beta1_dep_neg0_7_p_0_3[5,]))

#ror thresholds
mean_acc_ror <- as.numeric(c(ror_results_beta1_p_0_3[5,], ror_results_beta1_dep_0_3_p_0_3[5,], ror_results_beta1_dep_neg0_3_p_0_3[5,], ror_results_beta1_dep_0_5_p_0_3[5,], ror_results_beta1_dep_neg0_5_p_0_3[5,], ror_results_beta1_dep_0_7_p_0_3[5,], ror_results_beta1_dep_neg0_7_p_0_3[5,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=corr)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_acc_prr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=prr_thresh, y=mean_acc_prr, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Overall Accuracy", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_acc_rr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=rr_thresh, y=mean_acc_rr, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Overall Accuracy", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_acc_ror, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=ror_thresh, y=mean_acc_ror, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Overall Accuracy", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=corr)) + 
  ylim(0,1) +
  scale_color_manual(breaks = c(0.3,0.5,0.7), values = c("#1f78b4","#b2df8a","#fb9a99","darkslategrey"), name=paste0("absolute correlation |", greeks("rho"), "|")) +
  scale_linetype_manual(values=c("dotted","dashed","solid"), name="direction") +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") + 
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_acc_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Overall Accuracy plots for Setting 3 (\U03B2 = 1, p = 0.3)")

acc_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p/beta1_p0_3/acc.png"
combined_acc_plot
ggsave(filename = acc_plot_file, plot = combined_acc_plot)
```

```{r b_1_p_0_5}
conf_thresh <- as.factor(rep(c(0.4,0.5,0.6,0.7), 7))
prr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 7))
rr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 7))
ror_thresh <- as.factor(rep(c(1,1.2,1.5,2), 7))
corr <- as.factor(c(rep(0,4), rep(0.3,8), rep(0.5,8), rep(0.7,8)))
#corr <- as.factor(c(rep(0,4), rep(0.3,4), rep(-0.3,4), rep(0.5,4), rep(-0.5,4), rep(0.7,4), rep(-0.7,4)))
sgn <- as.factor(c(rep(0,4), rep("+",4), rep("-",4), rep("+",4), rep("-",4), rep("+",4), rep("-",4)))

#sensitivity plots
#confidence thresholds
mean_sens_conf <- as.numeric(c(conf_results_beta1_p_0_5[1,], conf_results_beta1_dep_0_3_p_0_5[1,], conf_results_beta1_dep_neg0_3_p_0_5[1,], conf_results_beta1_dep_0_5_p_0_5[1,], conf_results_beta1_dep_neg0_5_p_0_5[1,], conf_results_beta1_dep_0_7_p_0_5[1,], conf_results_beta1_dep_neg0_7_p_0_5[1,]))

#prr thresholds
mean_sens_prr <- as.numeric(c(prr_results_beta1_p_0_5[1,], prr_results_beta1_dep_0_3_p_0_5[1,], prr_results_beta1_dep_neg0_3_p_0_5[1,], prr_results_beta1_dep_0_5_p_0_5[1,], prr_results_beta1_dep_neg0_5_p_0_5[1,], prr_results_beta1_dep_0_7_p_0_5[1,], prr_results_beta1_dep_neg0_7_p_0_5[1,]))

#rr thresholds
mean_sens_rr <- as.numeric(c(rr_results_beta1_p_0_5[1,], rr_results_beta1_dep_0_3_p_0_5[1,], rr_results_beta1_dep_neg0_3_p_0_5[1,], rr_results_beta1_dep_0_5_p_0_5[1,], rr_results_beta1_dep_neg0_5_p_0_5[1,], rr_results_beta1_dep_0_7_p_0_5[1,], rr_results_beta1_dep_neg0_7_p_0_5[1,]))

#ror thresholds
mean_sens_ror <- as.numeric(c(ror_results_beta1_p_0_5[1,], ror_results_beta1_dep_0_3_p_0_5[1,], ror_results_beta1_dep_neg0_3_p_0_5[1,], ror_results_beta1_dep_0_5_p_0_5[1,], ror_results_beta1_dep_neg0_5_p_0_5[1,], ror_results_beta1_dep_0_7_p_0_5[1,], ror_results_beta1_dep_neg0_7_p_0_5[1,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=corr)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Sensitivity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_sens_prr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=prr_thresh, y=mean_sens_prr, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Sensitivity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_sens_rr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=rr_thresh, y=mean_sens_rr, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Sensitivity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_sens_ror, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=ror_thresh, y=mean_sens_ror, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Sensitivity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=corr)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  scale_color_manual(breaks = c(0.3,0.5,0.7), values = c("#1f78b4","#b2df8a","#fb9a99","darkslategrey"), name=paste0("absolute correlation |", greeks("rho"), "|")) +
  labs(y="Mean Sensitivity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  scale_linetype_manual(values=c("dotted","dashed","solid"), name="direction") +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_sens_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Sensitivity plots for Setting 3 (\U03B2 = 1, p = 0.5)")

sens_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p/beta1_p0_5/sens.png"
combined_sens_plot
ggsave(filename = sens_plot_file, plot = combined_sens_plot)

## specificity plots
#confidence thresholds
mean_spec_conf <- as.numeric(c(conf_results_beta1_p_0_5[2,], conf_results_beta1_dep_0_3_p_0_5[2,], conf_results_beta1_dep_neg0_3_p_0_5[2,], conf_results_beta1_dep_0_5_p_0_5[2,], conf_results_beta1_dep_neg0_5_p_0_5[2,], conf_results_beta1_dep_0_7_p_0_5[2,], conf_results_beta1_dep_neg0_7_p_0_5[2,]))

#prr thresholds
mean_spec_prr <- as.numeric(c(prr_results_beta1_p_0_5[2,], prr_results_beta1_dep_0_3_p_0_5[2,], prr_results_beta1_dep_neg0_3_p_0_5[2,], prr_results_beta1_dep_0_5_p_0_5[2,], prr_results_beta1_dep_neg0_5_p_0_5[2,], prr_results_beta1_dep_0_7_p_0_5[2,], prr_results_beta1_dep_neg0_7_p_0_5[2,]))

#rr thresholds
mean_spec_rr <- as.numeric(c(rr_results_beta1_p_0_5[2,], rr_results_beta1_dep_0_3_p_0_5[2,], rr_results_beta1_dep_neg0_3_p_0_5[2,], rr_results_beta1_dep_0_5_p_0_5[2,], rr_results_beta1_dep_neg0_5_p_0_5[2,], rr_results_beta1_dep_0_7_p_0_5[2,], rr_results_beta1_dep_neg0_7_p_0_5[2,]))

#ror thresholds
mean_spec_ror <- as.numeric(c(ror_results_beta1_p_0_5[2,], ror_results_beta1_dep_0_3_p_0_5[2,], ror_results_beta1_dep_neg0_3_p_0_5[2,], ror_results_beta1_dep_0_5_p_0_5[2,], ror_results_beta1_dep_neg0_5_p_0_5[2,], ror_results_beta1_dep_0_7_p_0_5[2,], ror_results_beta1_dep_neg0_7_p_0_5[2,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=corr)) + 
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Specificity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_spec_prr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=prr_thresh, y=mean_spec_prr, color=corr)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Specificity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_spec_rr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=rr_thresh, y=mean_spec_rr, color=corr)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Specificity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_spec_ror, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=ror_thresh, y=mean_spec_ror, color=corr)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Specificity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=corr)) + 
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  scale_color_manual(breaks = c(0.3,0.5,0.7), values = c("#1f78b4","#b2df8a","#fb9a99","darkslategrey"), name=paste0("absolute correlation |", greeks("rho"), "|")) +
  scale_linetype_manual(values=c("dotted","dashed","solid"), name="direction") +
  labs(y="Mean Specificity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

combined_spec_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Specificity plots for Setting 3 (\U03B2 = 1, p = 0.5)")
spec_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p/beta1_p0_5/spec.png"
combined_spec_plot
ggsave(filename = spec_plot_file, plot = combined_spec_plot)

## overall accuracy plots
#confidence thresholds
mean_acc_conf <- as.numeric(c(conf_results_beta1_p_0_5[5,], conf_results_beta1_dep_0_3_p_0_5[5,], conf_results_beta1_dep_neg0_3_p_0_5[5,], conf_results_beta1_dep_0_5_p_0_5[5,], conf_results_beta1_dep_neg0_5_p_0_5[5,], conf_results_beta1_dep_0_7_p_0_5[5,], conf_results_beta1_dep_neg0_7_p_0_5[5,]))

#prr thresholds
mean_acc_prr <- as.numeric(c(prr_results_beta1_p_0_5[5,], prr_results_beta1_dep_0_3_p_0_5[5,], prr_results_beta1_dep_neg0_3_p_0_5[5,], prr_results_beta1_dep_0_5_p_0_5[5,], prr_results_beta1_dep_neg0_5_p_0_5[5,], prr_results_beta1_dep_0_7_p_0_5[5,], prr_results_beta1_dep_neg0_7_p_0_5[5,]))

#rr thresholds
mean_acc_rr <- as.numeric(c(rr_results_beta1_p_0_5[5,], rr_results_beta1_dep_0_3_p_0_5[5,], rr_results_beta1_dep_neg0_3_p_0_5[5,], rr_results_beta1_dep_0_5_p_0_5[5,], rr_results_beta1_dep_neg0_5_p_0_5[5,], rr_results_beta1_dep_0_7_p_0_5[5,], rr_results_beta1_dep_neg0_7_p_0_5[5,]))

#ror thresholds
mean_acc_ror <- as.numeric(c(ror_results_beta1_p_0_5[5,], ror_results_beta1_dep_0_3_p_0_5[5,], ror_results_beta1_dep_neg0_3_p_0_5[5,], ror_results_beta1_dep_0_5_p_0_5[5,], ror_results_beta1_dep_neg0_5_p_0_5[5,], ror_results_beta1_dep_0_7_p_0_5[5,], ror_results_beta1_dep_neg0_7_p_0_5[5,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=corr)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_acc_prr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=prr_thresh, y=mean_acc_prr, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Overall Accuracy", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_acc_rr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=rr_thresh, y=mean_acc_rr, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Overall Accuracy", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_acc_ror, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=ror_thresh, y=mean_acc_ror, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Overall Accuracy", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=corr)) + 
  ylim(0,1) +
  scale_color_manual(breaks = c(0.3,0.5,0.7), values = c("#1f78b4","#b2df8a","#fb9a99","darkslategrey"), name=paste0("absolute correlation |", greeks("rho"), "|")) +
  scale_linetype_manual(values=c("dotted","dashed","solid"), name="direction") +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") + 
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_acc_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Overall Accuracy plots for Setting 3 (\U03B2 = 1, p = 0.5)")

acc_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p/beta1_p0_5/acc.png"
combined_acc_plot
ggsave(filename = acc_plot_file, plot = combined_acc_plot)
```

```{r b_10_p_0_1}
conf_thresh <- as.factor(rep(c(0.4,0.5,0.6,0.7), 7))
prr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 7))
rr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 7))
ror_thresh <- as.factor(rep(c(1,1.2,1.5,2), 7))
corr <- as.factor(c(rep(0,4), rep(0.3,8), rep(0.5,8), rep(0.7,8)))
#corr <- as.factor(c(rep(0,4), rep(0.3,4), rep(-0.3,4), rep(0.5,4), rep(-0.5,4), rep(0.7,4), rep(-0.7,4)))
sgn <- as.factor(c(rep(0,4), rep("+",4), rep("-",4), rep("+",4), rep("-",4), rep("+",4), rep("-",4)))

#sensitivity plots
#confidence thresholds
mean_sens_conf <- as.numeric(c(conf_results_beta10_p_0_1[1,], conf_results_beta10_dep_0_3_p_0_1[1,], conf_results_beta10_dep_neg0_3_p_0_1[1,], conf_results_beta10_dep_0_5_p_0_1[1,], conf_results_beta10_dep_neg0_5_p_0_1[1,], conf_results_beta10_dep_0_7_p_0_1[1,], conf_results_beta10_dep_neg0_7_p_0_1[1,]))

#prr thresholds
mean_sens_prr <- as.numeric(c(prr_results_beta10_p_0_1[1,], prr_results_beta10_dep_0_3_p_0_1[1,], prr_results_beta10_dep_neg0_3_p_0_1[1,], prr_results_beta10_dep_0_5_p_0_1[1,], prr_results_beta10_dep_neg0_5_p_0_1[1,], prr_results_beta10_dep_0_7_p_0_1[1,], prr_results_beta10_dep_neg0_7_p_0_1[1,]))

#rr thresholds
mean_sens_rr <- as.numeric(c(rr_results_beta10_p_0_1[1,], rr_results_beta10_dep_0_3_p_0_1[1,], rr_results_beta10_dep_neg0_3_p_0_1[1,], rr_results_beta10_dep_0_5_p_0_1[1,], rr_results_beta10_dep_neg0_5_p_0_1[1,], rr_results_beta10_dep_0_7_p_0_1[1,], rr_results_beta10_dep_neg0_7_p_0_1[1,]))

#ror thresholds
mean_sens_ror <- as.numeric(c(ror_results_beta10_p_0_1[1,], ror_results_beta10_dep_0_3_p_0_1[1,], ror_results_beta10_dep_neg0_3_p_0_1[1,], ror_results_beta10_dep_0_5_p_0_1[1,], ror_results_beta10_dep_neg0_5_p_0_1[1,], ror_results_beta10_dep_0_7_p_0_1[1,], ror_results_beta10_dep_neg0_7_p_0_1[1,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=corr)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Sensitivity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_sens_prr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=prr_thresh, y=mean_sens_prr, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Sensitivity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_sens_rr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=rr_thresh, y=mean_sens_rr, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Sensitivity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_sens_ror, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=ror_thresh, y=mean_sens_ror, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Sensitivity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=corr)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  scale_color_manual(breaks = c(0.3,0.5,0.7), values = c("#1f78b4","#b2df8a","#fb9a99","darkslategrey"), name=paste0("absolute correlation |", greeks("rho"), "|")) +
  labs(y="Mean Sensitivity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  scale_linetype_manual(values=c("dotted","dashed","solid"), name="direction") +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_sens_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Sensitivity plots for Setting 3 (\U03B2 = 10, p = 0.1)")

sens_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p/beta10_p0_1/sens.png"
combined_sens_plot
ggsave(filename = sens_plot_file, plot = combined_sens_plot)

## specificity plots
#confidence thresholds
mean_spec_conf <- as.numeric(c(conf_results_beta10_p_0_1[2,], conf_results_beta10_dep_0_3_p_0_1[2,], conf_results_beta10_dep_neg0_3_p_0_1[2,], conf_results_beta10_dep_0_5_p_0_1[2,], conf_results_beta10_dep_neg0_5_p_0_1[2,], conf_results_beta10_dep_0_7_p_0_1[2,], conf_results_beta10_dep_neg0_7_p_0_1[2,]))

#prr thresholds
mean_spec_prr <- as.numeric(c(prr_results_beta10_p_0_1[2,], prr_results_beta10_dep_0_3_p_0_1[2,], prr_results_beta10_dep_neg0_3_p_0_1[2,], prr_results_beta10_dep_0_5_p_0_1[2,], prr_results_beta10_dep_neg0_5_p_0_1[2,], prr_results_beta10_dep_0_7_p_0_1[2,], prr_results_beta10_dep_neg0_7_p_0_1[2,]))

#rr thresholds
mean_spec_rr <- as.numeric(c(rr_results_beta10_p_0_1[2,], rr_results_beta10_dep_0_3_p_0_1[2,], rr_results_beta10_dep_neg0_3_p_0_1[2,], rr_results_beta10_dep_0_5_p_0_1[2,], rr_results_beta10_dep_neg0_5_p_0_1[2,], rr_results_beta10_dep_0_7_p_0_1[2,], rr_results_beta10_dep_neg0_7_p_0_1[2,]))

#ror thresholds
mean_spec_ror <- as.numeric(c(ror_results_beta10_p_0_1[2,], ror_results_beta10_dep_0_3_p_0_1[2,], ror_results_beta10_dep_neg0_3_p_0_1[2,], ror_results_beta10_dep_0_5_p_0_1[2,], ror_results_beta10_dep_neg0_5_p_0_1[2,], ror_results_beta10_dep_0_7_p_0_1[2,], ror_results_beta10_dep_neg0_7_p_0_1[2,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=corr)) + 
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Specificity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_spec_prr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=prr_thresh, y=mean_spec_prr, color=corr)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Specificity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_spec_rr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=rr_thresh, y=mean_spec_rr, color=corr)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Specificity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_spec_ror, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=ror_thresh, y=mean_spec_ror, color=corr)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Specificity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=corr)) + 
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  scale_color_manual(breaks = c(0.3,0.5,0.7), values = c("#1f78b4","#b2df8a","#fb9a99","darkslategrey"), name=paste0("absolute correlation |", greeks("rho"), "|")) +
  scale_linetype_manual(values=c("dotted","dashed","solid"), name="direction") +
  labs(y="Mean Specificity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

combined_spec_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Specificity plots for Setting 3 (\U03B2 = 10, p = 0.1)")
spec_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p/beta10_p0_1/spec.png"
combined_spec_plot
ggsave(filename = spec_plot_file, plot = combined_spec_plot)

## overall accuracy plots
#confidence thresholds
mean_acc_conf <- as.numeric(c(conf_results_beta10_p_0_1[5,], conf_results_beta10_dep_0_3_p_0_1[5,], conf_results_beta10_dep_neg0_3_p_0_1[5,], conf_results_beta10_dep_0_5_p_0_1[5,], conf_results_beta10_dep_neg0_5_p_0_1[5,], conf_results_beta10_dep_0_7_p_0_1[5,], conf_results_beta10_dep_neg0_7_p_0_1[5,]))

#prr thresholds
mean_acc_prr <- as.numeric(c(prr_results_beta10_p_0_1[5,], prr_results_beta10_dep_0_3_p_0_1[5,], prr_results_beta10_dep_neg0_3_p_0_1[5,], prr_results_beta10_dep_0_5_p_0_1[5,], prr_results_beta10_dep_neg0_5_p_0_1[5,], prr_results_beta10_dep_0_7_p_0_1[5,], prr_results_beta10_dep_neg0_7_p_0_1[5,]))

#rr thresholds
mean_acc_rr <- as.numeric(c(rr_results_beta10_p_0_1[5,], rr_results_beta10_dep_0_3_p_0_1[5,], rr_results_beta10_dep_neg0_3_p_0_1[5,], rr_results_beta10_dep_0_5_p_0_1[5,], rr_results_beta10_dep_neg0_5_p_0_1[5,], rr_results_beta10_dep_0_7_p_0_1[5,], rr_results_beta10_dep_neg0_7_p_0_1[5,]))

#ror thresholds
mean_acc_ror <- as.numeric(c(ror_results_beta10_p_0_1[5,], ror_results_beta10_dep_0_3_p_0_1[5,], ror_results_beta10_dep_neg0_3_p_0_1[5,], ror_results_beta10_dep_0_5_p_0_1[5,], ror_results_beta10_dep_neg0_5_p_0_1[5,], ror_results_beta10_dep_0_7_p_0_1[5,], ror_results_beta10_dep_neg0_7_p_0_1[5,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=corr)) + 
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_acc_prr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=prr_thresh, y=mean_acc_prr, color=corr)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Overall Accuracy", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_acc_rr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=rr_thresh, y=mean_acc_rr, color=corr)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Overall Accuracy", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_acc_ror, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=ror_thresh, y=mean_acc_ror, color=corr)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Overall Accuracy", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=corr)) + 
  ylim(0.5,1) +
  scale_color_manual(breaks = c(0.3,0.5,0.7), values = c("#1f78b4","#b2df8a","#fb9a99","darkslategrey"), name=paste0("absolute correlation |", greeks("rho"), "|")) +
  scale_linetype_manual(values=c("dotted","dashed","solid"), name="direction") +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") + 
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_acc_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Overall Accuracy plots for Setting 3 (\U03B2 = 10, p = 0.1)")

acc_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p/beta10_p0_1/acc.png"
combined_acc_plot
ggsave(filename = acc_plot_file, plot = combined_acc_plot)
```

```{r b_10_p_0_3}
conf_thresh <- as.factor(rep(c(0.4,0.5,0.6,0.7), 7))
prr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 7))
rr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 7))
ror_thresh <- as.factor(rep(c(1,1.2,1.5,2), 7))
corr <- as.factor(c(rep(0,4), rep(0.3,8), rep(0.5,8), rep(0.7,8)))
#corr <- as.factor(c(rep(0,4), rep(0.3,4), rep(-0.3,4), rep(0.5,4), rep(-0.5,4), rep(0.7,4), rep(-0.7,4)))
sgn <- as.factor(c(rep(0,4), rep("+",4), rep("-",4), rep("+",4), rep("-",4), rep("+",4), rep("-",4)))

#sensitivity plots
#confidence thresholds
mean_sens_conf <- as.numeric(c(conf_results_beta10_p_0_3[1,], conf_results_beta10_dep_0_3_p_0_3[1,], conf_results_beta10_dep_neg0_3_p_0_3[1,], conf_results_beta10_dep_0_5_p_0_3[1,], conf_results_beta10_dep_neg0_5_p_0_3[1,], conf_results_beta10_dep_0_7_p_0_3[1,], conf_results_beta10_dep_neg0_7_p_0_3[1,]))

#prr thresholds
mean_sens_prr <- as.numeric(c(prr_results_beta10_p_0_3[1,], prr_results_beta10_dep_0_3_p_0_3[1,], prr_results_beta10_dep_neg0_3_p_0_3[1,], prr_results_beta10_dep_0_5_p_0_3[1,], prr_results_beta10_dep_neg0_5_p_0_3[1,], prr_results_beta10_dep_0_7_p_0_3[1,], prr_results_beta10_dep_neg0_7_p_0_3[1,]))

#rr thresholds
mean_sens_rr <- as.numeric(c(rr_results_beta10_p_0_3[1,], rr_results_beta10_dep_0_3_p_0_3[1,], rr_results_beta10_dep_neg0_3_p_0_3[1,], rr_results_beta10_dep_0_5_p_0_3[1,], rr_results_beta10_dep_neg0_5_p_0_3[1,], rr_results_beta10_dep_0_7_p_0_3[1,], rr_results_beta10_dep_neg0_7_p_0_3[1,]))

#ror thresholds
mean_sens_ror <- as.numeric(c(ror_results_beta10_p_0_3[1,], ror_results_beta10_dep_0_3_p_0_3[1,], ror_results_beta10_dep_neg0_3_p_0_3[1,], ror_results_beta10_dep_0_5_p_0_3[1,], ror_results_beta10_dep_neg0_5_p_0_3[1,], ror_results_beta10_dep_0_7_p_0_3[1,], ror_results_beta10_dep_neg0_7_p_0_3[1,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=corr)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Sensitivity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_sens_prr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=prr_thresh, y=mean_sens_prr, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Sensitivity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_sens_rr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=rr_thresh, y=mean_sens_rr, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Sensitivity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_sens_ror, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=ror_thresh, y=mean_sens_ror, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Sensitivity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=corr)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  scale_color_manual(breaks = c(0.3,0.5,0.7), values = c("#1f78b4","#b2df8a","#fb9a99","darkslategrey"), name=paste0("absolute correlation |", greeks("rho"), "|")) +
  labs(y="Mean Sensitivity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  scale_linetype_manual(values=c("dotted","dashed","solid"), name="direction") +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_sens_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Sensitivity plots for Setting 3 (\U03B2 = 10, p = 0.3)")

sens_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p/beta10_p0_3/sens.png"
combined_sens_plot
ggsave(filename = sens_plot_file, plot = combined_sens_plot)

## specificity plots
#confidence thresholds
mean_spec_conf <- as.numeric(c(conf_results_beta10_p_0_3[2,], conf_results_beta10_dep_0_3_p_0_3[2,], conf_results_beta10_dep_neg0_3_p_0_3[2,], conf_results_beta10_dep_0_5_p_0_3[2,], conf_results_beta10_dep_neg0_5_p_0_3[2,], conf_results_beta10_dep_0_7_p_0_3[2,], conf_results_beta10_dep_neg0_7_p_0_3[2,]))

#prr thresholds
mean_spec_prr <- as.numeric(c(prr_results_beta10_p_0_3[2,], prr_results_beta10_dep_0_3_p_0_3[2,], prr_results_beta10_dep_neg0_3_p_0_3[2,], prr_results_beta10_dep_0_5_p_0_3[2,], prr_results_beta10_dep_neg0_5_p_0_3[2,], prr_results_beta10_dep_0_7_p_0_3[2,], prr_results_beta10_dep_neg0_7_p_0_3[2,]))

#rr thresholds
mean_spec_rr <- as.numeric(c(rr_results_beta10_p_0_3[2,], rr_results_beta10_dep_0_3_p_0_3[2,], rr_results_beta10_dep_neg0_3_p_0_3[2,], rr_results_beta10_dep_0_5_p_0_3[2,], rr_results_beta10_dep_neg0_5_p_0_3[2,], rr_results_beta10_dep_0_7_p_0_3[2,], rr_results_beta10_dep_neg0_7_p_0_3[2,]))

#ror thresholds
mean_spec_ror <- as.numeric(c(ror_results_beta10_p_0_3[2,], ror_results_beta10_dep_0_3_p_0_3[2,], ror_results_beta10_dep_neg0_3_p_0_3[2,], ror_results_beta10_dep_0_5_p_0_3[2,], ror_results_beta10_dep_neg0_5_p_0_3[2,], ror_results_beta10_dep_0_7_p_0_3[2,], ror_results_beta10_dep_neg0_7_p_0_3[2,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=corr)) + 
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Specificity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_spec_prr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=prr_thresh, y=mean_spec_prr, color=corr)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Specificity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_spec_rr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=rr_thresh, y=mean_spec_rr, color=corr)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Specificity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_spec_ror, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=ror_thresh, y=mean_spec_ror, color=corr)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Specificity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=corr)) + 
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  scale_color_manual(breaks = c(0.3,0.5,0.7), values = c("#1f78b4","#b2df8a","#fb9a99","darkslategrey"), name=paste0("absolute correlation |", greeks("rho"), "|")) +
  scale_linetype_manual(values=c("dotted","dashed","solid"), name="direction") +
  labs(y="Mean Specificity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

combined_spec_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Specificity plots for Setting 3 (\U03B2 = 10, p = 0.3)")
spec_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p/beta10_p0_3/spec.png"
combined_spec_plot
ggsave(filename = spec_plot_file, plot = combined_spec_plot)

## overall accuracy plots
#confidence thresholds
mean_acc_conf <- as.numeric(c(conf_results_beta10_p_0_3[5,], conf_results_beta10_dep_0_3_p_0_3[5,], conf_results_beta10_dep_neg0_3_p_0_3[5,], conf_results_beta10_dep_0_5_p_0_3[5,], conf_results_beta10_dep_neg0_5_p_0_3[5,], conf_results_beta10_dep_0_7_p_0_3[5,], conf_results_beta10_dep_neg0_7_p_0_3[5,]))

#prr thresholds
mean_acc_prr <- as.numeric(c(prr_results_beta10_p_0_3[5,], prr_results_beta10_dep_0_3_p_0_3[5,], prr_results_beta10_dep_neg0_3_p_0_3[5,], prr_results_beta10_dep_0_5_p_0_3[5,], prr_results_beta10_dep_neg0_5_p_0_3[5,], prr_results_beta10_dep_0_7_p_0_3[5,], prr_results_beta10_dep_neg0_7_p_0_3[5,]))

#rr thresholds
mean_acc_rr <- as.numeric(c(rr_results_beta10_p_0_3[5,], rr_results_beta10_dep_0_3_p_0_3[5,], rr_results_beta10_dep_neg0_3_p_0_3[5,], rr_results_beta10_dep_0_5_p_0_3[5,], rr_results_beta10_dep_neg0_5_p_0_3[5,], rr_results_beta10_dep_0_7_p_0_3[5,], rr_results_beta10_dep_neg0_7_p_0_3[5,]))

#ror thresholds
mean_acc_ror <- as.numeric(c(ror_results_beta10_p_0_3[5,], ror_results_beta10_dep_0_3_p_0_3[5,], ror_results_beta10_dep_neg0_3_p_0_3[5,], ror_results_beta10_dep_0_5_p_0_3[5,], ror_results_beta10_dep_neg0_5_p_0_3[5,], ror_results_beta10_dep_0_7_p_0_3[5,], ror_results_beta10_dep_neg0_7_p_0_3[5,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=corr)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_acc_prr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=prr_thresh, y=mean_acc_prr, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Overall Accuracy", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_acc_rr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=rr_thresh, y=mean_acc_rr, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Overall Accuracy", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_acc_ror, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=ror_thresh, y=mean_acc_ror, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Overall Accuracy", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=corr)) + 
  ylim(0,1) +
  scale_color_manual(breaks = c(0.3,0.5,0.7), values = c("#1f78b4","#b2df8a","#fb9a99","darkslategrey"), name=paste0("absolute correlation |", greeks("rho"), "|")) +
  scale_linetype_manual(values=c("dotted","dashed","solid"), name="direction") +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") + 
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_acc_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Overall Accuracy plots for Setting 3 (\U03B2 = 10, p = 0.3)")

acc_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p/beta10_p0_3/acc.png"
combined_acc_plot
ggsave(filename = acc_plot_file, plot = combined_acc_plot)
```

```{r b_10_p_0_5}
conf_thresh <- as.factor(rep(c(0.4,0.5,0.6,0.7), 7))
prr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 7))
rr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 7))
ror_thresh <- as.factor(rep(c(1,1.2,1.5,2), 7))
corr <- as.factor(c(rep(0,4), rep(0.3,8), rep(0.5,8), rep(0.7,8)))
#corr <- as.factor(c(rep(0,4), rep(0.3,4), rep(-0.3,4), rep(0.5,4), rep(-0.5,4), rep(0.7,4), rep(-0.7,4)))
sgn <- as.factor(c(rep(0,4), rep("+",4), rep("-",4), rep("+",4), rep("-",4), rep("+",4), rep("-",4)))

#sensitivity plots
#confidence thresholds
mean_sens_conf <- as.numeric(c(conf_results_beta10_p_0_5[1,], conf_results_beta10_dep_0_3_p_0_5[1,], conf_results_beta10_dep_neg0_3_p_0_5[1,], conf_results_beta10_dep_0_5_p_0_5[1,], conf_results_beta10_dep_neg0_5_p_0_5[1,], conf_results_beta10_dep_0_7_p_0_5[1,], conf_results_beta10_dep_neg0_7_p_0_5[1,]))

#prr thresholds
mean_sens_prr <- as.numeric(c(prr_results_beta10_p_0_5[1,], prr_results_beta10_dep_0_3_p_0_5[1,], prr_results_beta10_dep_neg0_3_p_0_5[1,], prr_results_beta10_dep_0_5_p_0_5[1,], prr_results_beta10_dep_neg0_5_p_0_5[1,], prr_results_beta10_dep_0_7_p_0_5[1,], prr_results_beta10_dep_neg0_7_p_0_5[1,]))

#rr thresholds
mean_sens_rr <- as.numeric(c(rr_results_beta10_p_0_5[1,], rr_results_beta10_dep_0_3_p_0_5[1,], rr_results_beta10_dep_neg0_3_p_0_5[1,], rr_results_beta10_dep_0_5_p_0_5[1,], rr_results_beta10_dep_neg0_5_p_0_5[1,], rr_results_beta10_dep_0_7_p_0_5[1,], rr_results_beta10_dep_neg0_7_p_0_5[1,]))

#ror thresholds
mean_sens_ror <- as.numeric(c(ror_results_beta10_p_0_5[1,], ror_results_beta10_dep_0_3_p_0_5[1,], ror_results_beta10_dep_neg0_3_p_0_5[1,], ror_results_beta10_dep_0_5_p_0_5[1,], ror_results_beta10_dep_neg0_5_p_0_5[1,], ror_results_beta10_dep_0_7_p_0_5[1,], ror_results_beta10_dep_neg0_7_p_0_5[1,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=corr)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Sensitivity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_sens_prr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=prr_thresh, y=mean_sens_prr, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Sensitivity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_sens_rr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=rr_thresh, y=mean_sens_rr, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Sensitivity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_sens_ror, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=ror_thresh, y=mean_sens_ror, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Sensitivity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=corr)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  scale_color_manual(breaks = c(0.3,0.5,0.7), values = c("#1f78b4","#b2df8a","#fb9a99","darkslategrey"), name=paste0("absolute correlation |", greeks("rho"), "|")) +
  labs(y="Mean Sensitivity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  scale_linetype_manual(breaks = c("-","+"), values=c("dotted","dashed","solid"), name="direction") +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_sens_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Sensitivity plots for Setting 3 (\U03B2 = 10, p = 0.5)")

sens_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p/beta10_p0_5/sens.png"
combined_sens_plot
ggsave(filename = sens_plot_file, plot = combined_sens_plot)

## specificity plots
#confidence thresholds
mean_spec_conf <- as.numeric(c(conf_results_beta10_p_0_5[2,], conf_results_beta10_dep_0_3_p_0_5[2,], conf_results_beta10_dep_neg0_3_p_0_5[2,], conf_results_beta10_dep_0_5_p_0_5[2,], conf_results_beta10_dep_neg0_5_p_0_5[2,], conf_results_beta10_dep_0_7_p_0_5[2,], conf_results_beta10_dep_neg0_7_p_0_5[2,]))

#prr thresholds
mean_spec_prr <- as.numeric(c(prr_results_beta10_p_0_5[2,], prr_results_beta10_dep_0_3_p_0_5[2,], prr_results_beta10_dep_neg0_3_p_0_5[2,], prr_results_beta10_dep_0_5_p_0_5[2,], prr_results_beta10_dep_neg0_5_p_0_5[2,], prr_results_beta10_dep_0_7_p_0_5[2,], prr_results_beta10_dep_neg0_7_p_0_5[2,]))

#rr thresholds
mean_spec_rr <- as.numeric(c(rr_results_beta10_p_0_5[2,], rr_results_beta10_dep_0_3_p_0_5[2,], rr_results_beta10_dep_neg0_3_p_0_5[2,], rr_results_beta10_dep_0_5_p_0_5[2,], rr_results_beta10_dep_neg0_5_p_0_5[2,], rr_results_beta10_dep_0_7_p_0_5[2,], rr_results_beta10_dep_neg0_7_p_0_5[2,]))

#ror thresholds
mean_spec_ror <- as.numeric(c(ror_results_beta10_p_0_5[2,], ror_results_beta10_dep_0_3_p_0_5[2,], ror_results_beta10_dep_neg0_3_p_0_5[2,], ror_results_beta10_dep_0_5_p_0_5[2,], ror_results_beta10_dep_neg0_5_p_0_5[2,], ror_results_beta10_dep_0_7_p_0_5[2,], ror_results_beta10_dep_neg0_7_p_0_5[2,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=corr)) + 
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Specificity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_spec_prr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=prr_thresh, y=mean_spec_prr, color=corr)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Specificity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_spec_rr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=rr_thresh, y=mean_spec_rr, color=corr)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Specificity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_spec_ror, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=ror_thresh, y=mean_spec_ror, color=corr)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Specificity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=corr)) + 
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  scale_color_manual(breaks = c(0.3,0.5,0.7), values = c("#1f78b4","#b2df8a","#fb9a99","darkslategrey"), name=paste0("absolute correlation |", greeks("rho"), "|")) +
  scale_linetype_manual(breaks = c("-","+"), values=c("dotted","dashed","solid"), name="direction") +
  labs(y="Mean Specificity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

combined_spec_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Specificity plots for Setting 3 (\U03B2 = 10, p = 0.5)")
spec_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p/beta10_p0_5/spec.png"
combined_spec_plot
ggsave(filename = spec_plot_file, plot = combined_spec_plot)

## overall accuracy plots
#confidence thresholds
mean_acc_conf <- as.numeric(c(conf_results_beta10_p_0_5[5,], conf_results_beta10_dep_0_3_p_0_5[5,], conf_results_beta10_dep_neg0_3_p_0_5[5,], conf_results_beta10_dep_0_5_p_0_5[5,], conf_results_beta10_dep_neg0_5_p_0_5[5,], conf_results_beta10_dep_0_7_p_0_5[5,], conf_results_beta10_dep_neg0_7_p_0_5[5,]))

#prr thresholds
mean_acc_prr <- as.numeric(c(prr_results_beta10_p_0_5[5,], prr_results_beta10_dep_0_3_p_0_5[5,], prr_results_beta10_dep_neg0_3_p_0_5[5,], prr_results_beta10_dep_0_5_p_0_5[5,], prr_results_beta10_dep_neg0_5_p_0_5[5,], prr_results_beta10_dep_0_7_p_0_5[5,], prr_results_beta10_dep_neg0_7_p_0_5[5,]))

#rr thresholds
mean_acc_rr <- as.numeric(c(rr_results_beta10_p_0_5[5,], rr_results_beta10_dep_0_3_p_0_5[5,], rr_results_beta10_dep_neg0_3_p_0_5[5,], rr_results_beta10_dep_0_5_p_0_5[5,], rr_results_beta10_dep_neg0_5_p_0_5[5,], rr_results_beta10_dep_0_7_p_0_5[5,], rr_results_beta10_dep_neg0_7_p_0_5[5,]))

#ror thresholds
mean_acc_ror <- as.numeric(c(ror_results_beta10_p_0_5[5,], ror_results_beta10_dep_0_3_p_0_5[5,], ror_results_beta10_dep_neg0_3_p_0_5[5,], ror_results_beta10_dep_0_5_p_0_5[5,], ror_results_beta10_dep_neg0_5_p_0_5[5,], ror_results_beta10_dep_0_7_p_0_5[5,], ror_results_beta10_dep_neg0_7_p_0_5[5,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=corr)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_acc_prr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=prr_thresh, y=mean_acc_prr, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Overall Accuracy", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_acc_rr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=rr_thresh, y=mean_acc_rr, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Overall Accuracy", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_acc_ror, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=ror_thresh, y=mean_acc_ror, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Overall Accuracy", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=corr)) + 
  ylim(0,1) +
  scale_color_manual(breaks = c(0.3,0.5,0.7), values = c("#1f78b4","#b2df8a","#fb9a99","darkslategrey"), name=paste0("absolute correlation |", greeks("rho"), "|")) +
  scale_linetype_manual(breaks = c("-","+"), values=c("dotted","dashed","solid"), name="direction") +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") + 
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_acc_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Overall Accuracy plots for Setting 3 (\U03B2 = 10, p = 0.5)")

acc_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p/beta10_p0_5/acc.png"
combined_acc_plot
ggsave(filename = acc_plot_file, plot = combined_acc_plot)
```

```{r b_50_p_0_1}
conf_thresh <- as.factor(rep(c(0.4,0.5,0.6,0.7), 7))
prr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 7))
rr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 7))
ror_thresh <- as.factor(rep(c(1,1.2,1.5,2), 7))
corr <- as.factor(c(rep(0,4), rep(0.3,8), rep(0.5,8), rep(0.7,8)))
#corr <- as.factor(c(rep(0,4), rep(0.3,4), rep(-0.3,4), rep(0.5,4), rep(-0.5,4), rep(0.7,4), rep(-0.7,4)))
sgn <- as.factor(c(rep(0,4), rep("+",4), rep("-",4), rep("+",4), rep("-",4), rep("+",4), rep("-",4)))

#sensitivity plots
#confidence thresholds
mean_sens_conf <- as.numeric(c(conf_results_beta50_p_0_1[1,], conf_results_beta50_dep_0_3_p_0_1[1,], conf_results_beta50_dep_neg0_3_p_0_1[1,], conf_results_beta50_dep_0_5_p_0_1[1,], conf_results_beta50_dep_neg0_5_p_0_1[1,], conf_results_beta50_dep_0_7_p_0_1[1,], conf_results_beta50_dep_neg0_7_p_0_1[1,]))

#prr thresholds
mean_sens_prr <- as.numeric(c(prr_results_beta50_p_0_1[1,], prr_results_beta50_dep_0_3_p_0_1[1,], prr_results_beta50_dep_neg0_3_p_0_1[1,], prr_results_beta50_dep_0_5_p_0_1[1,], prr_results_beta50_dep_neg0_5_p_0_1[1,], prr_results_beta50_dep_0_7_p_0_1[1,], prr_results_beta50_dep_neg0_7_p_0_1[1,]))

#rr thresholds
mean_sens_rr <- as.numeric(c(rr_results_beta50_p_0_1[1,], rr_results_beta50_dep_0_3_p_0_1[1,], rr_results_beta50_dep_neg0_3_p_0_1[1,], rr_results_beta50_dep_0_5_p_0_1[1,], rr_results_beta50_dep_neg0_5_p_0_1[1,], rr_results_beta50_dep_0_7_p_0_1[1,], rr_results_beta50_dep_neg0_7_p_0_1[1,]))

#ror thresholds
mean_sens_ror <- as.numeric(c(ror_results_beta50_p_0_1[1,], ror_results_beta50_dep_0_3_p_0_1[1,], ror_results_beta50_dep_neg0_3_p_0_1[1,], ror_results_beta50_dep_0_5_p_0_1[1,], ror_results_beta50_dep_neg0_5_p_0_1[1,], ror_results_beta50_dep_0_7_p_0_1[1,], ror_results_beta50_dep_neg0_7_p_0_1[1,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=corr)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Sensitivity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_sens_prr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=prr_thresh, y=mean_sens_prr, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Sensitivity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_sens_rr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=rr_thresh, y=mean_sens_rr, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Sensitivity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_sens_ror, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=ror_thresh, y=mean_sens_ror, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Sensitivity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=corr)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  scale_color_manual(breaks = c(0.3,0.5,0.7), values = c("#1f78b4","#b2df8a","#fb9a99","darkslategrey"), name=paste0("absolute correlation |", greeks("rho"), "|")) +
  labs(y="Mean Sensitivity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  scale_linetype_manual(breaks = c("-","+"), values=c("dotted","dashed","solid"), name="direction") +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_sens_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Sensitivity plots for Setting 3 (\U03B2 = 50, p = 0.1)")

sens_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p/beta50_p0_1/sens.png"
combined_sens_plot
ggsave(filename = sens_plot_file, plot = combined_sens_plot)

## specificity plots
#confidence thresholds
mean_spec_conf <- as.numeric(c(conf_results_beta50_p_0_1[2,], conf_results_beta50_dep_0_3_p_0_1[2,], conf_results_beta50_dep_neg0_3_p_0_1[2,], conf_results_beta50_dep_0_5_p_0_1[2,], conf_results_beta50_dep_neg0_5_p_0_1[2,], conf_results_beta50_dep_0_7_p_0_1[2,], conf_results_beta50_dep_neg0_7_p_0_1[2,]))

#prr thresholds
mean_spec_prr <- as.numeric(c(prr_results_beta50_p_0_1[2,], prr_results_beta50_dep_0_3_p_0_1[2,], prr_results_beta50_dep_neg0_3_p_0_1[2,], prr_results_beta50_dep_0_5_p_0_1[2,], prr_results_beta50_dep_neg0_5_p_0_1[2,], prr_results_beta50_dep_0_7_p_0_1[2,], prr_results_beta50_dep_neg0_7_p_0_1[2,]))

#rr thresholds
mean_spec_rr <- as.numeric(c(rr_results_beta50_p_0_1[2,], rr_results_beta50_dep_0_3_p_0_1[2,], rr_results_beta50_dep_neg0_3_p_0_1[2,], rr_results_beta50_dep_0_5_p_0_1[2,], rr_results_beta50_dep_neg0_5_p_0_1[2,], rr_results_beta50_dep_0_7_p_0_1[2,], rr_results_beta50_dep_neg0_7_p_0_1[2,]))

#ror thresholds
mean_spec_ror <- as.numeric(c(ror_results_beta50_p_0_1[2,], ror_results_beta50_dep_0_3_p_0_1[2,], ror_results_beta50_dep_neg0_3_p_0_1[2,], ror_results_beta50_dep_0_5_p_0_1[2,], ror_results_beta50_dep_neg0_5_p_0_1[2,], ror_results_beta50_dep_0_7_p_0_1[2,], ror_results_beta50_dep_neg0_7_p_0_1[2,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=corr)) + 
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Specificity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_spec_prr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=prr_thresh, y=mean_spec_prr, color=corr)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Specificity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_spec_rr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=rr_thresh, y=mean_spec_rr, color=corr)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Specificity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_spec_ror, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=ror_thresh, y=mean_spec_ror, color=corr)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Specificity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=corr)) + 
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  scale_color_manual(breaks = c(0.3,0.5,0.7), values = c("#1f78b4","#b2df8a","#fb9a99","darkslategrey"), name=paste0("absolute correlation |", greeks("rho"), "|")) +
  scale_linetype_manual(breaks = c("-","+"), values=c("dotted","dashed","solid"), name="direction") +
  labs(y="Mean Specificity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

combined_spec_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Specificity plots for Setting 3 (\U03B2 = 50, p = 0.1)")
spec_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p/beta50_p0_1/spec.png"
combined_spec_plot
ggsave(filename = spec_plot_file, plot = combined_spec_plot)

## overall accuracy plots
#confidence thresholds
mean_acc_conf <- as.numeric(c(conf_results_beta50_p_0_1[5,], conf_results_beta50_dep_0_3_p_0_1[5,], conf_results_beta50_dep_neg0_3_p_0_1[5,], conf_results_beta50_dep_0_5_p_0_1[5,], conf_results_beta50_dep_neg0_5_p_0_1[5,], conf_results_beta50_dep_0_7_p_0_1[5,], conf_results_beta50_dep_neg0_7_p_0_1[5,]))

#prr thresholds
mean_acc_prr <- as.numeric(c(prr_results_beta50_p_0_1[5,], prr_results_beta50_dep_0_3_p_0_1[5,], prr_results_beta50_dep_neg0_3_p_0_1[5,], prr_results_beta50_dep_0_5_p_0_1[5,], prr_results_beta50_dep_neg0_5_p_0_1[5,], prr_results_beta50_dep_0_7_p_0_1[5,], prr_results_beta50_dep_neg0_7_p_0_1[5,]))

#rr thresholds
mean_acc_rr <- as.numeric(c(rr_results_beta50_p_0_1[5,], rr_results_beta50_dep_0_3_p_0_1[5,], rr_results_beta50_dep_neg0_3_p_0_1[5,], rr_results_beta50_dep_0_5_p_0_1[5,], rr_results_beta50_dep_neg0_5_p_0_1[5,], rr_results_beta50_dep_0_7_p_0_1[5,], rr_results_beta50_dep_neg0_7_p_0_1[5,]))

#ror thresholds
mean_acc_ror <- as.numeric(c(ror_results_beta50_p_0_1[5,], ror_results_beta50_dep_0_3_p_0_1[5,], ror_results_beta50_dep_neg0_3_p_0_1[5,], ror_results_beta50_dep_0_5_p_0_1[5,], ror_results_beta50_dep_neg0_5_p_0_1[5,], ror_results_beta50_dep_0_7_p_0_1[5,], ror_results_beta50_dep_neg0_7_p_0_1[5,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=corr)) + 
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_acc_prr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=prr_thresh, y=mean_acc_prr, color=corr)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Overall Accuracy", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_acc_rr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=rr_thresh, y=mean_acc_rr, color=corr)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Overall Accuracy", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_acc_ror, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=ror_thresh, y=mean_acc_ror, color=corr)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Overall Accuracy", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=corr)) + 
  ylim(0.5,1) +
  scale_color_manual(breaks = c(0.3,0.5,0.7), values = c("#1f78b4","#b2df8a","#fb9a99","darkslategrey"), name=paste0("absolute correlation |", greeks("rho"), "|")) +
  scale_linetype_manual(breaks = c("-","+"), values=c("dotted","dashed","solid"), name="direction") +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") + 
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_acc_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Overall Accuracy plots for Setting 3 (\U03B2 = 50, p = 0.1)")

acc_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p/beta50_p0_1/acc.png"
combined_acc_plot
ggsave(filename = acc_plot_file, plot = combined_acc_plot)
```

```{r b_50_p_0_3}
conf_thresh <- as.factor(rep(c(0.4,0.5,0.6,0.7), 7))
prr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 7))
rr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 7))
ror_thresh <- as.factor(rep(c(1,1.2,1.5,2), 7))
corr <- as.factor(c(rep(0,4), rep(0.3,8), rep(0.5,8), rep(0.7,8)))
#corr <- as.factor(c(rep(0,4), rep(0.3,4), rep(-0.3,4), rep(0.5,4), rep(-0.5,4), rep(0.7,4), rep(-0.7,4)))
sgn <- as.factor(c(rep(0,4), rep("+",4), rep("-",4), rep("+",4), rep("-",4), rep("+",4), rep("-",4)))

#sensitivity plots
#confidence thresholds
mean_sens_conf <- as.numeric(c(conf_results_beta50_p_0_3[1,], conf_results_beta50_dep_0_3_p_0_3[1,], conf_results_beta50_dep_neg0_3_p_0_3[1,], conf_results_beta50_dep_0_5_p_0_3[1,], conf_results_beta50_dep_neg0_5_p_0_3[1,], conf_results_beta50_dep_0_7_p_0_3[1,], conf_results_beta50_dep_neg0_7_p_0_3[1,]))

#prr thresholds
mean_sens_prr <- as.numeric(c(prr_results_beta50_p_0_3[1,], prr_results_beta50_dep_0_3_p_0_3[1,], prr_results_beta50_dep_neg0_3_p_0_3[1,], prr_results_beta50_dep_0_5_p_0_3[1,], prr_results_beta50_dep_neg0_5_p_0_3[1,], prr_results_beta50_dep_0_7_p_0_3[1,], prr_results_beta50_dep_neg0_7_p_0_3[1,]))

#rr thresholds
mean_sens_rr <- as.numeric(c(rr_results_beta50_p_0_3[1,], rr_results_beta50_dep_0_3_p_0_3[1,], rr_results_beta50_dep_neg0_3_p_0_3[1,], rr_results_beta50_dep_0_5_p_0_3[1,], rr_results_beta50_dep_neg0_5_p_0_3[1,], rr_results_beta50_dep_0_7_p_0_3[1,], rr_results_beta50_dep_neg0_7_p_0_3[1,]))

#ror thresholds
mean_sens_ror <- as.numeric(c(ror_results_beta50_p_0_3[1,], ror_results_beta50_dep_0_3_p_0_3[1,], ror_results_beta50_dep_neg0_3_p_0_3[1,], ror_results_beta50_dep_0_5_p_0_3[1,], ror_results_beta50_dep_neg0_5_p_0_3[1,], ror_results_beta50_dep_0_7_p_0_3[1,], ror_results_beta50_dep_neg0_7_p_0_3[1,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=corr)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Sensitivity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_sens_prr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=prr_thresh, y=mean_sens_prr, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Sensitivity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_sens_rr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=rr_thresh, y=mean_sens_rr, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Sensitivity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_sens_ror, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=ror_thresh, y=mean_sens_ror, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Sensitivity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=corr)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  scale_color_manual(breaks = c(0.3,0.5,0.7), values = c("#1f78b4","#b2df8a","#fb9a99","darkslategrey"), name=paste0("absolute correlation |", greeks("rho"), "|")) +
  labs(y="Mean Sensitivity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  scale_linetype_manual(breaks = c("-","+"), values=c("dotted","dashed","solid"), name="direction") +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_sens_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Sensitivity plots for Setting 3 (\U03B2 = 50, p = 0.3)")

sens_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p/beta50_p0_3/sens.png"
combined_sens_plot
ggsave(filename = sens_plot_file, plot = combined_sens_plot)

## specificity plots
#confidence thresholds
mean_spec_conf <- as.numeric(c(conf_results_beta50_p_0_3[2,], conf_results_beta50_dep_0_3_p_0_3[2,], conf_results_beta50_dep_neg0_3_p_0_3[2,], conf_results_beta50_dep_0_5_p_0_3[2,], conf_results_beta50_dep_neg0_5_p_0_3[2,], conf_results_beta50_dep_0_7_p_0_3[2,], conf_results_beta50_dep_neg0_7_p_0_3[2,]))

#prr thresholds
mean_spec_prr <- as.numeric(c(prr_results_beta50_p_0_3[2,], prr_results_beta50_dep_0_3_p_0_3[2,], prr_results_beta50_dep_neg0_3_p_0_3[2,], prr_results_beta50_dep_0_5_p_0_3[2,], prr_results_beta50_dep_neg0_5_p_0_3[2,], prr_results_beta50_dep_0_7_p_0_3[2,], prr_results_beta50_dep_neg0_7_p_0_3[2,]))

#rr thresholds
mean_spec_rr <- as.numeric(c(rr_results_beta50_p_0_3[2,], rr_results_beta50_dep_0_3_p_0_3[2,], rr_results_beta50_dep_neg0_3_p_0_3[2,], rr_results_beta50_dep_0_5_p_0_3[2,], rr_results_beta50_dep_neg0_5_p_0_3[2,], rr_results_beta50_dep_0_7_p_0_3[2,], rr_results_beta50_dep_neg0_7_p_0_3[2,]))

#ror thresholds
mean_spec_ror <- as.numeric(c(ror_results_beta50_p_0_3[2,], ror_results_beta50_dep_0_3_p_0_3[2,], ror_results_beta50_dep_neg0_3_p_0_3[2,], ror_results_beta50_dep_0_5_p_0_3[2,], ror_results_beta50_dep_neg0_5_p_0_3[2,], ror_results_beta50_dep_0_7_p_0_3[2,], ror_results_beta50_dep_neg0_7_p_0_3[2,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=corr)) + 
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Specificity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_spec_prr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=prr_thresh, y=mean_spec_prr, color=corr)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Specificity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_spec_rr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=rr_thresh, y=mean_spec_rr, color=corr)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Specificity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_spec_ror, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=ror_thresh, y=mean_spec_ror, color=corr)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Specificity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=corr)) + 
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  scale_color_manual(breaks = c(0.3,0.5,0.7), values = c("#1f78b4","#b2df8a","#fb9a99","darkslategrey"), name=paste0("absolute correlation |", greeks("rho"), "|")) +
  scale_linetype_manual(breaks = c("-","+"), values=c("dotted","dashed","solid"), name="direction") +
  labs(y="Mean Specificity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

combined_spec_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Specificity plots for Setting 3 (\U03B2 = 50, p = 0.3)")
spec_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p/beta50_p0_3/spec.png"
combined_spec_plot
ggsave(filename = spec_plot_file, plot = combined_spec_plot)

## overall accuracy plots
#confidence thresholds
mean_acc_conf <- as.numeric(c(conf_results_beta50_p_0_3[5,], conf_results_beta50_dep_0_3_p_0_3[5,], conf_results_beta50_dep_neg0_3_p_0_3[5,], conf_results_beta50_dep_0_5_p_0_3[5,], conf_results_beta50_dep_neg0_5_p_0_3[5,], conf_results_beta50_dep_0_7_p_0_3[5,], conf_results_beta50_dep_neg0_7_p_0_3[5,]))

#prr thresholds
mean_acc_prr <- as.numeric(c(prr_results_beta50_p_0_3[5,], prr_results_beta50_dep_0_3_p_0_3[5,], prr_results_beta50_dep_neg0_3_p_0_3[5,], prr_results_beta50_dep_0_5_p_0_3[5,], prr_results_beta50_dep_neg0_5_p_0_3[5,], prr_results_beta50_dep_0_7_p_0_3[5,], prr_results_beta50_dep_neg0_7_p_0_3[5,]))

#rr thresholds
mean_acc_rr <- as.numeric(c(rr_results_beta50_p_0_3[5,], rr_results_beta50_dep_0_3_p_0_3[5,], rr_results_beta50_dep_neg0_3_p_0_3[5,], rr_results_beta50_dep_0_5_p_0_3[5,], rr_results_beta50_dep_neg0_5_p_0_3[5,], rr_results_beta50_dep_0_7_p_0_3[5,], rr_results_beta50_dep_neg0_7_p_0_3[5,]))

#ror thresholds
mean_acc_ror <- as.numeric(c(ror_results_beta50_p_0_3[5,], ror_results_beta50_dep_0_3_p_0_3[5,], ror_results_beta50_dep_neg0_3_p_0_3[5,], ror_results_beta50_dep_0_5_p_0_3[5,], ror_results_beta50_dep_neg0_5_p_0_3[5,], ror_results_beta50_dep_0_7_p_0_3[5,], ror_results_beta50_dep_neg0_7_p_0_3[5,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=corr)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_acc_prr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=prr_thresh, y=mean_acc_prr, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Overall Accuracy", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_acc_rr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=rr_thresh, y=mean_acc_rr, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Overall Accuracy", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_acc_ror, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=ror_thresh, y=mean_acc_ror, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Overall Accuracy", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=corr)) + 
  ylim(0,1) +
  scale_color_manual(breaks = c(0.3,0.5,0.7), values = c("#1f78b4","#b2df8a","#fb9a99","darkslategrey"), name=paste0("absolute correlation |", greeks("rho"), "|")) +
  scale_linetype_manual(breaks = c("-","+"), values=c("dotted","dashed","solid"), name="direction") +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") + 
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_acc_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Overall Accuracy plots for Setting 3 (\U03B2 = 50, p = 0.3)")

acc_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p/beta50_p0_3/acc.png"
combined_acc_plot
ggsave(filename = acc_plot_file, plot = combined_acc_plot)
```

```{r b_50_p_0_5}
conf_thresh <- as.factor(rep(c(0.4,0.5,0.6,0.7), 7))
prr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 7))
rr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 7))
ror_thresh <- as.factor(rep(c(1,1.2,1.5,2), 7))
corr <- as.factor(c(rep(0,4), rep(0.3,8), rep(0.5,8), rep(0.7,8)))
#corr <- as.factor(c(rep(0,4), rep(0.3,4), rep(-0.3,4), rep(0.5,4), rep(-0.5,4), rep(0.7,4), rep(-0.7,4)))
sgn <- as.factor(c(rep(0,4), rep("+",4), rep("-",4), rep("+",4), rep("-",4), rep("+",4), rep("-",4)))

#sensitivity plots
#confidence thresholds
mean_sens_conf <- as.numeric(c(conf_results_beta50_p_0_5[1,], conf_results_beta50_dep_0_3_p_0_5[1,], conf_results_beta50_dep_neg0_3_p_0_5[1,], conf_results_beta50_dep_0_5_p_0_5[1,], conf_results_beta50_dep_neg0_5_p_0_5[1,], conf_results_beta50_dep_0_7_p_0_5[1,], conf_results_beta50_dep_neg0_7_p_0_5[1,]))

#prr thresholds
mean_sens_prr <- as.numeric(c(prr_results_beta50_p_0_5[1,], prr_results_beta50_dep_0_3_p_0_5[1,], prr_results_beta50_dep_neg0_3_p_0_5[1,], prr_results_beta50_dep_0_5_p_0_5[1,], prr_results_beta50_dep_neg0_5_p_0_5[1,], prr_results_beta50_dep_0_7_p_0_5[1,], prr_results_beta50_dep_neg0_7_p_0_5[1,]))

#rr thresholds
mean_sens_rr <- as.numeric(c(rr_results_beta50_p_0_5[1,], rr_results_beta50_dep_0_3_p_0_5[1,], rr_results_beta50_dep_neg0_3_p_0_5[1,], rr_results_beta50_dep_0_5_p_0_5[1,], rr_results_beta50_dep_neg0_5_p_0_5[1,], rr_results_beta50_dep_0_7_p_0_5[1,], rr_results_beta50_dep_neg0_7_p_0_5[1,]))

#ror thresholds
mean_sens_ror <- as.numeric(c(ror_results_beta50_p_0_5[1,], ror_results_beta50_dep_0_3_p_0_5[1,], ror_results_beta50_dep_neg0_3_p_0_5[1,], ror_results_beta50_dep_0_5_p_0_5[1,], ror_results_beta50_dep_neg0_5_p_0_5[1,], ror_results_beta50_dep_0_7_p_0_5[1,], ror_results_beta50_dep_neg0_7_p_0_5[1,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=corr)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Sensitivity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_sens_prr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=prr_thresh, y=mean_sens_prr, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Sensitivity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_sens_rr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=rr_thresh, y=mean_sens_rr, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Sensitivity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_sens_ror, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=ror_thresh, y=mean_sens_ror, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Sensitivity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=corr)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  scale_color_manual(breaks = c(0.3,0.5,0.7), values = c("#1f78b4","#b2df8a","#fb9a99","darkslategrey"), name=paste0("absolute correlation |", greeks("rho"), "|")) +
  labs(y="Mean Sensitivity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  scale_linetype_manual(breaks = c("-","+"), values=c("dotted","dashed","solid"), name="direction") +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_sens_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Sensitivity plots for Setting 3 (\U03B2 = 50, p = 0.5)")

sens_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p/beta50_p0_5/sens.png"
combined_sens_plot
ggsave(filename = sens_plot_file, plot = combined_sens_plot)

## specificity plots
#confidence thresholds
mean_spec_conf <- as.numeric(c(conf_results_beta50_p_0_5[2,], conf_results_beta50_dep_0_3_p_0_5[2,], conf_results_beta50_dep_neg0_3_p_0_5[2,], conf_results_beta50_dep_0_5_p_0_5[2,], conf_results_beta50_dep_neg0_5_p_0_5[2,], conf_results_beta50_dep_0_7_p_0_5[2,], conf_results_beta50_dep_neg0_7_p_0_5[2,]))

#prr thresholds
mean_spec_prr <- as.numeric(c(prr_results_beta50_p_0_5[2,], prr_results_beta50_dep_0_3_p_0_5[2,], prr_results_beta50_dep_neg0_3_p_0_5[2,], prr_results_beta50_dep_0_5_p_0_5[2,], prr_results_beta50_dep_neg0_5_p_0_5[2,], prr_results_beta50_dep_0_7_p_0_5[2,], prr_results_beta50_dep_neg0_7_p_0_5[2,]))

#rr thresholds
mean_spec_rr <- as.numeric(c(rr_results_beta50_p_0_5[2,], rr_results_beta50_dep_0_3_p_0_5[2,], rr_results_beta50_dep_neg0_3_p_0_5[2,], rr_results_beta50_dep_0_5_p_0_5[2,], rr_results_beta50_dep_neg0_5_p_0_5[2,], rr_results_beta50_dep_0_7_p_0_5[2,], rr_results_beta50_dep_neg0_7_p_0_5[2,]))

#ror thresholds
mean_spec_ror <- as.numeric(c(ror_results_beta50_p_0_5[2,], ror_results_beta50_dep_0_3_p_0_5[2,], ror_results_beta50_dep_neg0_3_p_0_5[2,], ror_results_beta50_dep_0_5_p_0_5[2,], ror_results_beta50_dep_neg0_5_p_0_5[2,], ror_results_beta50_dep_0_7_p_0_5[2,], ror_results_beta50_dep_neg0_7_p_0_5[2,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=corr)) + 
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Specificity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_spec_prr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=prr_thresh, y=mean_spec_prr, color=corr)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Specificity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_spec_rr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=rr_thresh, y=mean_spec_rr, color=corr)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Specificity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_spec_ror, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=ror_thresh, y=mean_spec_ror, color=corr)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Specificity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=corr)) + 
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  scale_color_manual(breaks = c(0.3,0.5,0.7), values = c("#1f78b4","#b2df8a","#fb9a99","darkslategrey"), name=paste0("absolute correlation |", greeks("rho"), "|")) +
  scale_linetype_manual(breaks = c("-","+"), values=c("dotted","dashed","solid"), name="direction") +
  labs(y="Mean Specificity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

combined_spec_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Specificity plots for Setting 3 (\U03B2 = 50, p = 0.5)")
spec_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p/beta50_p0_5/spec.png"
combined_spec_plot
ggsave(filename = spec_plot_file, plot = combined_spec_plot)

## overall accuracy plots
#confidence thresholds
mean_acc_conf <- as.numeric(c(conf_results_beta50_p_0_5[5,], conf_results_beta50_dep_0_3_p_0_5[5,], conf_results_beta50_dep_neg0_3_p_0_5[5,], conf_results_beta50_dep_0_5_p_0_5[5,], conf_results_beta50_dep_neg0_5_p_0_5[5,], conf_results_beta50_dep_0_7_p_0_5[5,], conf_results_beta50_dep_neg0_7_p_0_5[5,]))

#prr thresholds
mean_acc_prr <- as.numeric(c(prr_results_beta50_p_0_5[5,], prr_results_beta50_dep_0_3_p_0_5[5,], prr_results_beta50_dep_neg0_3_p_0_5[5,], prr_results_beta50_dep_0_5_p_0_5[5,], prr_results_beta50_dep_neg0_5_p_0_5[5,], prr_results_beta50_dep_0_7_p_0_5[5,], prr_results_beta50_dep_neg0_7_p_0_5[5,]))

#rr thresholds
mean_acc_rr <- as.numeric(c(rr_results_beta50_p_0_5[5,], rr_results_beta50_dep_0_3_p_0_5[5,], rr_results_beta50_dep_neg0_3_p_0_5[5,], rr_results_beta50_dep_0_5_p_0_5[5,], rr_results_beta50_dep_neg0_5_p_0_5[5,], rr_results_beta50_dep_0_7_p_0_5[5,], rr_results_beta50_dep_neg0_7_p_0_5[5,]))

#ror thresholds
mean_acc_ror <- as.numeric(c(ror_results_beta50_p_0_5[5,], ror_results_beta50_dep_0_3_p_0_5[5,], ror_results_beta50_dep_neg0_3_p_0_5[5,], ror_results_beta50_dep_0_5_p_0_5[5,], ror_results_beta50_dep_neg0_5_p_0_5[5,], ror_results_beta50_dep_0_7_p_0_5[5,], ror_results_beta50_dep_neg0_7_p_0_5[5,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=corr)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_acc_prr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=prr_thresh, y=mean_acc_prr, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Overall Accuracy", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_acc_rr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=rr_thresh, y=mean_acc_rr, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Overall Accuracy", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_acc_ror, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=ror_thresh, y=mean_acc_ror, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Overall Accuracy", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=corr)) + 
  ylim(0,1) +
  scale_color_manual(breaks = c(0.3,0.5,0.7), values = c("#1f78b4","#b2df8a","#fb9a99","darkslategrey"), name=paste0("absolute correlation |", greeks("rho"), "|")) +
  scale_linetype_manual(breaks = c("-","+"), values=c("dotted","dashed","solid"), name="direction") +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") + 
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_acc_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Overall Accuracy plots for Setting 3 (\U03B2 = 50, p = 0.5)")

acc_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p/beta50_p0_5/acc.png"
combined_acc_plot
ggsave(filename = acc_plot_file, plot = combined_acc_plot)
```

```{r b_100_p_0_1}
conf_thresh <- as.factor(rep(c(0.4,0.5,0.6,0.7), 7))
prr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 7))
rr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 7))
ror_thresh <- as.factor(rep(c(1,1.2,1.5,2), 7))
corr <- as.factor(c(rep(0,4), rep(0.3,8), rep(0.5,8), rep(0.7,8)))
#corr <- as.factor(c(rep(0,4), rep(0.3,4), rep(-0.3,4), rep(0.5,4), rep(-0.5,4), rep(0.7,4), rep(-0.7,4)))
sgn <- as.factor(c(rep(0,4), rep("+",4), rep("-",4), rep("+",4), rep("-",4), rep("+",4), rep("-",4)))

#sensitivity plots
#confidence thresholds
mean_sens_conf <- as.numeric(c(conf_results_beta100_p_0_1[1,], conf_results_beta100_dep_0_3_p_0_1[1,], conf_results_beta100_dep_neg0_3_p_0_1[1,], conf_results_beta100_dep_0_5_p_0_1[1,], conf_results_beta100_dep_neg0_5_p_0_1[1,], conf_results_beta100_dep_0_7_p_0_1[1,], conf_results_beta100_dep_neg0_7_p_0_1[1,]))

#prr thresholds
mean_sens_prr <- as.numeric(c(prr_results_beta100_p_0_1[1,], prr_results_beta100_dep_0_3_p_0_1[1,], prr_results_beta100_dep_neg0_3_p_0_1[1,], prr_results_beta100_dep_0_5_p_0_1[1,], prr_results_beta100_dep_neg0_5_p_0_1[1,], prr_results_beta100_dep_0_7_p_0_1[1,], prr_results_beta100_dep_neg0_7_p_0_1[1,]))

#rr thresholds
mean_sens_rr <- as.numeric(c(rr_results_beta100_p_0_1[1,], rr_results_beta100_dep_0_3_p_0_1[1,], rr_results_beta100_dep_neg0_3_p_0_1[1,], rr_results_beta100_dep_0_5_p_0_1[1,], rr_results_beta100_dep_neg0_5_p_0_1[1,], rr_results_beta100_dep_0_7_p_0_1[1,], rr_results_beta100_dep_neg0_7_p_0_1[1,]))

#ror thresholds
mean_sens_ror <- as.numeric(c(ror_results_beta100_p_0_1[1,], ror_results_beta100_dep_0_3_p_0_1[1,], ror_results_beta100_dep_neg0_3_p_0_1[1,], ror_results_beta100_dep_0_5_p_0_1[1,], ror_results_beta100_dep_neg0_5_p_0_1[1,], ror_results_beta100_dep_0_7_p_0_1[1,], ror_results_beta100_dep_neg0_7_p_0_1[1,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=corr)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Sensitivity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_sens_prr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=prr_thresh, y=mean_sens_prr, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Sensitivity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_sens_rr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=rr_thresh, y=mean_sens_rr, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Sensitivity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_sens_ror, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=ror_thresh, y=mean_sens_ror, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Sensitivity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=corr)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  scale_color_manual(breaks = c(0.3,0.5,0.7), values = c("#1f78b4","#b2df8a","#fb9a99","darkslategrey"), name=paste0("absolute correlation |", greeks("rho"), "|")) +
  labs(y="Mean Sensitivity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  scale_linetype_manual(breaks = c("-","+"), values=c("dotted","dashed","solid"), name="direction") +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_sens_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Sensitivity plots for Setting 3 (\U03B2 = 100, p = 0.1)")

sens_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p/beta100_p0_1/sens.png"
combined_sens_plot
ggsave(filename = sens_plot_file, plot = combined_sens_plot)

## specificity plots
#confidence thresholds
mean_spec_conf <- as.numeric(c(conf_results_beta100_p_0_1[2,], conf_results_beta100_dep_0_3_p_0_1[2,], conf_results_beta100_dep_neg0_3_p_0_1[2,], conf_results_beta100_dep_0_5_p_0_1[2,], conf_results_beta100_dep_neg0_5_p_0_1[2,], conf_results_beta100_dep_0_7_p_0_1[2,], conf_results_beta100_dep_neg0_7_p_0_1[2,]))

#prr thresholds
mean_spec_prr <- as.numeric(c(prr_results_beta100_p_0_1[2,], prr_results_beta100_dep_0_3_p_0_1[2,], prr_results_beta100_dep_neg0_3_p_0_1[2,], prr_results_beta100_dep_0_5_p_0_1[2,], prr_results_beta100_dep_neg0_5_p_0_1[2,], prr_results_beta100_dep_0_7_p_0_1[2,], prr_results_beta100_dep_neg0_7_p_0_1[2,]))

#rr thresholds
mean_spec_rr <- as.numeric(c(rr_results_beta100_p_0_1[2,], rr_results_beta100_dep_0_3_p_0_1[2,], rr_results_beta100_dep_neg0_3_p_0_1[2,], rr_results_beta100_dep_0_5_p_0_1[2,], rr_results_beta100_dep_neg0_5_p_0_1[2,], rr_results_beta100_dep_0_7_p_0_1[2,], rr_results_beta100_dep_neg0_7_p_0_1[2,]))

#ror thresholds
mean_spec_ror <- as.numeric(c(ror_results_beta100_p_0_1[2,], ror_results_beta100_dep_0_3_p_0_1[2,], ror_results_beta100_dep_neg0_3_p_0_1[2,], ror_results_beta100_dep_0_5_p_0_1[2,], ror_results_beta100_dep_neg0_5_p_0_1[2,], ror_results_beta100_dep_0_7_p_0_1[2,], ror_results_beta100_dep_neg0_7_p_0_1[2,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=corr)) + 
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Specificity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_spec_prr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=prr_thresh, y=mean_spec_prr, color=corr)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Specificity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_spec_rr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=rr_thresh, y=mean_spec_rr, color=corr)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Specificity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_spec_ror, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=ror_thresh, y=mean_spec_ror, color=corr)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Specificity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=corr)) + 
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  scale_color_manual(breaks = c(0.3,0.5,0.7), values = c("#1f78b4","#b2df8a","#fb9a99","darkslategrey"), name=paste0("absolute correlation |", greeks("rho"), "|")) +
  scale_linetype_manual(breaks = c("-","+"), values=c("dotted","dashed","solid"), name="direction") +
  labs(y="Mean Specificity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

combined_spec_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Specificity plots for Setting 3 (\U03B2 = 100, p = 0.1)")
spec_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p/beta100_p0_1/spec.png"
combined_spec_plot
ggsave(filename = spec_plot_file, plot = combined_spec_plot)

## overall accuracy plots
#confidence thresholds
mean_acc_conf <- as.numeric(c(conf_results_beta100_p_0_1[5,], conf_results_beta100_dep_0_3_p_0_1[5,], conf_results_beta100_dep_neg0_3_p_0_1[5,], conf_results_beta100_dep_0_5_p_0_1[5,], conf_results_beta100_dep_neg0_5_p_0_1[5,], conf_results_beta100_dep_0_7_p_0_1[5,], conf_results_beta100_dep_neg0_7_p_0_1[5,]))

#prr thresholds
mean_acc_prr <- as.numeric(c(prr_results_beta100_p_0_1[5,], prr_results_beta100_dep_0_3_p_0_1[5,], prr_results_beta100_dep_neg0_3_p_0_1[5,], prr_results_beta100_dep_0_5_p_0_1[5,], prr_results_beta100_dep_neg0_5_p_0_1[5,], prr_results_beta100_dep_0_7_p_0_1[5,], prr_results_beta100_dep_neg0_7_p_0_1[5,]))

#rr thresholds
mean_acc_rr <- as.numeric(c(rr_results_beta100_p_0_1[5,], rr_results_beta100_dep_0_3_p_0_1[5,], rr_results_beta100_dep_neg0_3_p_0_1[5,], rr_results_beta100_dep_0_5_p_0_1[5,], rr_results_beta100_dep_neg0_5_p_0_1[5,], rr_results_beta100_dep_0_7_p_0_1[5,], rr_results_beta100_dep_neg0_7_p_0_1[5,]))

#ror thresholds
mean_acc_ror <- as.numeric(c(ror_results_beta100_p_0_1[5,], ror_results_beta100_dep_0_3_p_0_1[5,], ror_results_beta100_dep_neg0_3_p_0_1[5,], ror_results_beta100_dep_0_5_p_0_1[5,], ror_results_beta100_dep_neg0_5_p_0_1[5,], ror_results_beta100_dep_0_7_p_0_1[5,], ror_results_beta100_dep_neg0_7_p_0_1[5,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=corr)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_acc_prr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=prr_thresh, y=mean_acc_prr, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Overall Accuracy", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_acc_rr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=rr_thresh, y=mean_acc_rr, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Overall Accuracy", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_acc_ror, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=ror_thresh, y=mean_acc_ror, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Overall Accuracy", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=corr)) + 
  ylim(0,1) +
  scale_color_manual(breaks = c(0.3,0.5,0.7), values = c("#1f78b4","#b2df8a","#fb9a99","darkslategrey"), name=paste0("absolute correlation |", greeks("rho"), "|")) +
  scale_linetype_manual(breaks = c("-","+"), values=c("dotted","dashed","solid"), name="direction") +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") + 
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_acc_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Overall Accuracy plots for Setting 3 (\U03B2 = 100, p = 0.1)")

acc_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p/beta100_p0_1/acc.png"
combined_acc_plot
ggsave(filename = acc_plot_file, plot = combined_acc_plot)
```

```{r b_100_p_0_3}
conf_thresh <- as.factor(rep(c(0.4,0.5,0.6,0.7), 7))
prr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 7))
rr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 7))
ror_thresh <- as.factor(rep(c(1,1.2,1.5,2), 7))
corr <- as.factor(c(rep(0,4), rep(0.3,8), rep(0.5,8), rep(0.7,8)))
#corr <- as.factor(c(rep(0,4), rep(0.3,4), rep(-0.3,4), rep(0.5,4), rep(-0.5,4), rep(0.7,4), rep(-0.7,4)))
sgn <- as.factor(c(rep(0,4), rep("+",4), rep("-",4), rep("+",4), rep("-",4), rep("+",4), rep("-",4)))

#sensitivity plots
#confidence thresholds
mean_sens_conf <- as.numeric(c(conf_results_beta100_p_0_3[1,], conf_results_beta100_dep_0_3_p_0_3[1,], conf_results_beta100_dep_neg0_3_p_0_3[1,], conf_results_beta100_dep_0_5_p_0_3[1,], conf_results_beta100_dep_neg0_5_p_0_3[1,], conf_results_beta100_dep_0_7_p_0_3[1,], conf_results_beta100_dep_neg0_7_p_0_3[1,]))

#prr thresholds
mean_sens_prr <- as.numeric(c(prr_results_beta100_p_0_3[1,], prr_results_beta100_dep_0_3_p_0_3[1,], prr_results_beta100_dep_neg0_3_p_0_3[1,], prr_results_beta100_dep_0_5_p_0_3[1,], prr_results_beta100_dep_neg0_5_p_0_3[1,], prr_results_beta100_dep_0_7_p_0_3[1,], prr_results_beta100_dep_neg0_7_p_0_3[1,]))

#rr thresholds
mean_sens_rr <- as.numeric(c(rr_results_beta100_p_0_3[1,], rr_results_beta100_dep_0_3_p_0_3[1,], rr_results_beta100_dep_neg0_3_p_0_3[1,], rr_results_beta100_dep_0_5_p_0_3[1,], rr_results_beta100_dep_neg0_5_p_0_3[1,], rr_results_beta100_dep_0_7_p_0_3[1,], rr_results_beta100_dep_neg0_7_p_0_3[1,]))

#ror thresholds
mean_sens_ror <- as.numeric(c(ror_results_beta100_p_0_3[1,], ror_results_beta100_dep_0_3_p_0_3[1,], ror_results_beta100_dep_neg0_3_p_0_3[1,], ror_results_beta100_dep_0_5_p_0_3[1,], ror_results_beta100_dep_neg0_5_p_0_3[1,], ror_results_beta100_dep_0_7_p_0_3[1,], ror_results_beta100_dep_neg0_7_p_0_3[1,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=corr)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Sensitivity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_sens_prr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=prr_thresh, y=mean_sens_prr, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Sensitivity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_sens_rr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=rr_thresh, y=mean_sens_rr, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Sensitivity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_sens_ror, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=ror_thresh, y=mean_sens_ror, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Sensitivity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=corr)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  scale_color_manual(breaks = c(0.3,0.5,0.7), values = c("#1f78b4","#b2df8a","#fb9a99","darkslategrey"), name=paste0("absolute correlation |", greeks("rho"), "|")) +
  labs(y="Mean Sensitivity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  scale_linetype_manual(breaks = c("-","+"), values=c("dotted","dashed","solid"), name="direction") +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_sens_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Sensitivity plots for Setting 3 (\U03B2 = 100, p = 0.3)")

sens_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p/beta100_p0_3/sens.png"
combined_sens_plot
ggsave(filename = sens_plot_file, plot = combined_sens_plot)

## specificity plots
#confidence thresholds
mean_spec_conf <- as.numeric(c(conf_results_beta100_p_0_3[2,], conf_results_beta100_dep_0_3_p_0_3[2,], conf_results_beta100_dep_neg0_3_p_0_3[2,], conf_results_beta100_dep_0_5_p_0_3[2,], conf_results_beta100_dep_neg0_5_p_0_3[2,], conf_results_beta100_dep_0_7_p_0_3[2,], conf_results_beta100_dep_neg0_7_p_0_3[2,]))

#prr thresholds
mean_spec_prr <- as.numeric(c(prr_results_beta100_p_0_3[2,], prr_results_beta100_dep_0_3_p_0_3[2,], prr_results_beta100_dep_neg0_3_p_0_3[2,], prr_results_beta100_dep_0_5_p_0_3[2,], prr_results_beta100_dep_neg0_5_p_0_3[2,], prr_results_beta100_dep_0_7_p_0_3[2,], prr_results_beta100_dep_neg0_7_p_0_3[2,]))

#rr thresholds
mean_spec_rr <- as.numeric(c(rr_results_beta100_p_0_3[2,], rr_results_beta100_dep_0_3_p_0_3[2,], rr_results_beta100_dep_neg0_3_p_0_3[2,], rr_results_beta100_dep_0_5_p_0_3[2,], rr_results_beta100_dep_neg0_5_p_0_3[2,], rr_results_beta100_dep_0_7_p_0_3[2,], rr_results_beta100_dep_neg0_7_p_0_3[2,]))

#ror thresholds
mean_spec_ror <- as.numeric(c(ror_results_beta100_p_0_3[2,], ror_results_beta100_dep_0_3_p_0_3[2,], ror_results_beta100_dep_neg0_3_p_0_3[2,], ror_results_beta100_dep_0_5_p_0_3[2,], ror_results_beta100_dep_neg0_5_p_0_3[2,], ror_results_beta100_dep_0_7_p_0_3[2,], ror_results_beta100_dep_neg0_7_p_0_3[2,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=corr)) + 
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Specificity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_spec_prr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=prr_thresh, y=mean_spec_prr, color=corr)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Specificity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_spec_rr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=rr_thresh, y=mean_spec_rr, color=corr)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Specificity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_spec_ror, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=ror_thresh, y=mean_spec_ror, color=corr)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Specificity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=corr)) + 
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  scale_color_manual(breaks = c(0.3,0.5,0.7), values = c("#1f78b4","#b2df8a","#fb9a99","darkslategrey"), name=paste0("absolute correlation |", greeks("rho"), "|")) +
  scale_linetype_manual(breaks = c("-","+"), values=c("dotted","dashed","solid"), name="direction") +
  labs(y="Mean Specificity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

combined_spec_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Specificity plots for Setting 3 (\U03B2 = 100, p = 0.3)")
spec_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p/beta100_p0_3/spec.png"
combined_spec_plot
ggsave(filename = spec_plot_file, plot = combined_spec_plot)

## overall accuracy plots
#confidence thresholds
mean_acc_conf <- as.numeric(c(conf_results_beta100_p_0_3[5,], conf_results_beta100_dep_0_3_p_0_3[5,], conf_results_beta100_dep_neg0_3_p_0_3[5,], conf_results_beta100_dep_0_5_p_0_3[5,], conf_results_beta100_dep_neg0_5_p_0_3[5,], conf_results_beta100_dep_0_7_p_0_3[5,], conf_results_beta100_dep_neg0_7_p_0_3[5,]))

#prr thresholds
mean_acc_prr <- as.numeric(c(prr_results_beta100_p_0_3[5,], prr_results_beta100_dep_0_3_p_0_3[5,], prr_results_beta100_dep_neg0_3_p_0_3[5,], prr_results_beta100_dep_0_5_p_0_3[5,], prr_results_beta100_dep_neg0_5_p_0_3[5,], prr_results_beta100_dep_0_7_p_0_3[5,], prr_results_beta100_dep_neg0_7_p_0_3[5,]))

#rr thresholds
mean_acc_rr <- as.numeric(c(rr_results_beta100_p_0_3[5,], rr_results_beta100_dep_0_3_p_0_3[5,], rr_results_beta100_dep_neg0_3_p_0_3[5,], rr_results_beta100_dep_0_5_p_0_3[5,], rr_results_beta100_dep_neg0_5_p_0_3[5,], rr_results_beta100_dep_0_7_p_0_3[5,], rr_results_beta100_dep_neg0_7_p_0_3[5,]))

#ror thresholds
mean_acc_ror <- as.numeric(c(ror_results_beta100_p_0_3[5,], ror_results_beta100_dep_0_3_p_0_3[5,], ror_results_beta100_dep_neg0_3_p_0_3[5,], ror_results_beta100_dep_0_5_p_0_3[5,], ror_results_beta100_dep_neg0_5_p_0_3[5,], ror_results_beta100_dep_0_7_p_0_3[5,], ror_results_beta100_dep_neg0_7_p_0_3[5,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=corr)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_acc_prr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=prr_thresh, y=mean_acc_prr, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Overall Accuracy", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_acc_rr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=rr_thresh, y=mean_acc_rr, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Overall Accuracy", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_acc_ror, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=ror_thresh, y=mean_acc_ror, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Overall Accuracy", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=corr)) + 
  ylim(0,1) +
  scale_color_manual(breaks = c(0.3,0.5,0.7), values = c("#1f78b4","#b2df8a","#fb9a99","darkslategrey"), name=paste0("absolute correlation |", greeks("rho"), "|")) +
  scale_linetype_manual(breaks = c("-","+"), values=c("dotted","dashed","solid"), name="direction") +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") + 
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_acc_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Overall Accuracy plots for Setting 3 (\U03B2 = 100, p = 0.3)")

acc_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p/beta100_p0_3/acc.png"
combined_acc_plot
ggsave(filename = acc_plot_file, plot = combined_acc_plot)
```

```{r b_100_p_0_5}
conf_thresh <- as.factor(rep(c(0.4,0.5,0.6,0.7), 7))
prr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 7))
rr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 7))
ror_thresh <- as.factor(rep(c(1,1.2,1.5,2), 7))
corr <- as.factor(c(rep(0,4), rep(0.3,8), rep(0.5,8), rep(0.7,8)))
#corr <- as.factor(c(rep(0,4), rep(0.3,4), rep(-0.3,4), rep(0.5,4), rep(-0.5,4), rep(0.7,4), rep(-0.7,4)))
sgn <- as.factor(c(rep(0,4), rep("+",4), rep("-",4), rep("+",4), rep("-",4), rep("+",4), rep("-",4)))

#sensitivity plots
#confidence thresholds
mean_sens_conf <- as.numeric(c(conf_results_beta100_p_0_5[1,], conf_results_beta100_dep_0_3_p_0_5[1,], conf_results_beta100_dep_neg0_3_p_0_5[1,], conf_results_beta100_dep_0_5_p_0_5[1,], conf_results_beta100_dep_neg0_5_p_0_5[1,], conf_results_beta100_dep_0_7_p_0_5[1,], conf_results_beta100_dep_neg0_7_p_0_5[1,]))

#prr thresholds
mean_sens_prr <- as.numeric(c(prr_results_beta100_p_0_5[1,], prr_results_beta100_dep_0_3_p_0_5[1,], prr_results_beta100_dep_neg0_3_p_0_5[1,], prr_results_beta100_dep_0_5_p_0_5[1,], prr_results_beta100_dep_neg0_5_p_0_5[1,], prr_results_beta100_dep_0_7_p_0_5[1,], prr_results_beta100_dep_neg0_7_p_0_5[1,]))

#rr thresholds
mean_sens_rr <- as.numeric(c(rr_results_beta100_p_0_5[1,], rr_results_beta100_dep_0_3_p_0_5[1,], rr_results_beta100_dep_neg0_3_p_0_5[1,], rr_results_beta100_dep_0_5_p_0_5[1,], rr_results_beta100_dep_neg0_5_p_0_5[1,], rr_results_beta100_dep_0_7_p_0_5[1,], rr_results_beta100_dep_neg0_7_p_0_5[1,]))

#ror thresholds
mean_sens_ror <- as.numeric(c(ror_results_beta100_p_0_5[1,], ror_results_beta100_dep_0_3_p_0_5[1,], ror_results_beta100_dep_neg0_3_p_0_5[1,], ror_results_beta100_dep_0_5_p_0_5[1,], ror_results_beta100_dep_neg0_5_p_0_5[1,], ror_results_beta100_dep_0_7_p_0_5[1,], ror_results_beta100_dep_neg0_7_p_0_5[1,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=corr)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Sensitivity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_sens_prr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=prr_thresh, y=mean_sens_prr, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Sensitivity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_sens_rr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=rr_thresh, y=mean_sens_rr, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Sensitivity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_sens_ror, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=ror_thresh, y=mean_sens_ror, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Sensitivity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=corr)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  scale_color_manual(breaks = c(0.3,0.5,0.7), values = c("#1f78b4","#b2df8a","#fb9a99","darkslategrey"), name=paste0("absolute correlation |", greeks("rho"), "|")) +
  labs(y="Mean Sensitivity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  scale_linetype_manual(breaks = c("-","+"), values=c("dotted","dashed","solid"), name="direction") +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_sens_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Sensitivity plots for Setting 3 (\U03B2 = 100, p = 0.5)")

sens_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p/beta100_p0_5/sens.png"
combined_sens_plot
ggsave(filename = sens_plot_file, plot = combined_sens_plot)

## specificity plots
#confidence thresholds
mean_spec_conf <- as.numeric(c(conf_results_beta100_p_0_5[2,], conf_results_beta100_dep_0_3_p_0_5[2,], conf_results_beta100_dep_neg0_3_p_0_5[2,], conf_results_beta100_dep_0_5_p_0_5[2,], conf_results_beta100_dep_neg0_5_p_0_5[2,], conf_results_beta100_dep_0_7_p_0_5[2,], conf_results_beta100_dep_neg0_7_p_0_5[2,]))

#prr thresholds
mean_spec_prr <- as.numeric(c(prr_results_beta100_p_0_5[2,], prr_results_beta100_dep_0_3_p_0_5[2,], prr_results_beta100_dep_neg0_3_p_0_5[2,], prr_results_beta100_dep_0_5_p_0_5[2,], prr_results_beta100_dep_neg0_5_p_0_5[2,], prr_results_beta100_dep_0_7_p_0_5[2,], prr_results_beta100_dep_neg0_7_p_0_5[2,]))

#rr thresholds
mean_spec_rr <- as.numeric(c(rr_results_beta100_p_0_5[2,], rr_results_beta100_dep_0_3_p_0_5[2,], rr_results_beta100_dep_neg0_3_p_0_5[2,], rr_results_beta100_dep_0_5_p_0_5[2,], rr_results_beta100_dep_neg0_5_p_0_5[2,], rr_results_beta100_dep_0_7_p_0_5[2,], rr_results_beta100_dep_neg0_7_p_0_5[2,]))

#ror thresholds
mean_spec_ror <- as.numeric(c(ror_results_beta100_p_0_5[2,], ror_results_beta100_dep_0_3_p_0_5[2,], ror_results_beta100_dep_neg0_3_p_0_5[2,], ror_results_beta100_dep_0_5_p_0_5[2,], ror_results_beta100_dep_neg0_5_p_0_5[2,], ror_results_beta100_dep_0_7_p_0_5[2,], ror_results_beta100_dep_neg0_7_p_0_5[2,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=corr)) + 
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Specificity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_spec_prr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=prr_thresh, y=mean_spec_prr, color=corr)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Specificity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_spec_rr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=rr_thresh, y=mean_spec_rr, color=corr)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Specificity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_spec_ror, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=ror_thresh, y=mean_spec_ror, color=corr)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Specificity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=corr)) + 
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  scale_color_manual(breaks = c(0.3,0.5,0.7), values = c("#1f78b4","#b2df8a","#fb9a99","darkslategrey"), name=paste0("absolute correlation |", greeks("rho"), "|")) +
  scale_linetype_manual(breaks = c("-","+"), values=c("dotted","dashed","solid"), name="direction") +
  labs(y="Mean Specificity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

combined_spec_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Specificity plots for Setting 3 (\U03B2 = 100, p = 0.5)")
spec_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p/beta100_p0_5/spec.png"
combined_spec_plot
ggsave(filename = spec_plot_file, plot = combined_spec_plot)

## overall accuracy plots
#confidence thresholds
mean_acc_conf <- as.numeric(c(conf_results_beta100_p_0_5[5,], conf_results_beta100_dep_0_3_p_0_5[5,], conf_results_beta100_dep_neg0_3_p_0_5[5,], conf_results_beta100_dep_0_5_p_0_5[5,], conf_results_beta100_dep_neg0_5_p_0_5[5,], conf_results_beta100_dep_0_7_p_0_5[5,], conf_results_beta100_dep_neg0_7_p_0_5[5,]))

#prr thresholds
mean_acc_prr <- as.numeric(c(prr_results_beta100_p_0_5[5,], prr_results_beta100_dep_0_3_p_0_5[5,], prr_results_beta100_dep_neg0_3_p_0_5[5,], prr_results_beta100_dep_0_5_p_0_5[5,], prr_results_beta100_dep_neg0_5_p_0_5[5,], prr_results_beta100_dep_0_7_p_0_5[5,], prr_results_beta100_dep_neg0_7_p_0_5[5,]))

#rr thresholds
mean_acc_rr <- as.numeric(c(rr_results_beta100_p_0_5[5,], rr_results_beta100_dep_0_3_p_0_5[5,], rr_results_beta100_dep_neg0_3_p_0_5[5,], rr_results_beta100_dep_0_5_p_0_5[5,], rr_results_beta100_dep_neg0_5_p_0_5[5,], rr_results_beta100_dep_0_7_p_0_5[5,], rr_results_beta100_dep_neg0_7_p_0_5[5,]))

#ror thresholds
mean_acc_ror <- as.numeric(c(ror_results_beta100_p_0_5[5,], ror_results_beta100_dep_0_3_p_0_5[5,], ror_results_beta100_dep_neg0_3_p_0_5[5,], ror_results_beta100_dep_0_5_p_0_5[5,], ror_results_beta100_dep_neg0_5_p_0_5[5,], ror_results_beta100_dep_0_7_p_0_5[5,], ror_results_beta100_dep_neg0_7_p_0_5[5,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=corr)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_acc_prr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=prr_thresh, y=mean_acc_prr, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Overall Accuracy", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_acc_rr, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=rr_thresh, y=mean_acc_rr, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Overall Accuracy", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_acc_ror, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=ror_thresh, y=mean_acc_ror, color=corr)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("darkslategrey","#1f78b4","#b2df8a","#fb9a99")) +
  scale_linetype_manual(values=c("dotted","dashed","solid")) +
  labs(y="Mean Overall Accuracy", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=corr, linetype=sgn, group=interaction(corr,sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=corr)) + 
  ylim(0,1) +
  scale_color_manual(breaks = c(0.3,0.5,0.7), values = c("#1f78b4","#b2df8a","#fb9a99","darkslategrey"), name=paste0("absolute correlation |", greeks("rho"), "|")) +
  scale_linetype_manual(breaks = c("-","+"), values=c("dotted","dashed","solid"), name="direction") +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") + 
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_acc_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Overall Accuracy plots for Setting 3 (\U03B2 = 100, p = 0.5)")

acc_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p/beta100_p0_5/acc.png"
combined_acc_plot
ggsave(filename = acc_plot_file, plot = combined_acc_plot)
```

## fixed beta and fixed rho

```{r b_1_rho_0}
conf_thresh <- as.factor(rep(c(0.4,0.5,0.6,0.7), 3))
prr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
rr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
ror_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
p <- as.factor(c(rep(0.1,4), rep(0.3,4), rep(0.5,4)))
#corr <- as.factor(c(rep(0,4), rep(0.3,4), rep(-0.3,4), rep(0.5,4), rep(-0.5,4), rep(0.7,4), rep(-0.7,4)))

#sensitivity plots
#confidence thresholds
mean_sens_conf <- as.numeric(c(conf_results_p_0_1_beta1[1,], conf_results_p_0_3_beta1[1,], conf_results_p_0_5_beta1[1,]))

#prr thresholds
mean_sens_prr <- as.numeric(c(prr_results_p_0_1_beta1[1,], prr_results_p_0_3_beta1[1,], prr_results_p_0_5_beta1[1,]))

#rr thresholds
mean_sens_rr <- as.numeric(c(rr_results_p_0_1_beta1[1,], rr_results_p_0_3_beta1[1,], rr_results_p_0_5_beta1[1,]))

#ror thresholds
mean_sens_ror <- as.numeric(c(ror_results_p_0_1_beta1[1,], ror_results_p_0_3_beta1[1,], ror_results_p_0_5_beta1[1,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=p, group=p)) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=p)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Sensitivity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_sens_prr, color=p, group=p)) + 
  geom_point(aes(x=prr_thresh, y=mean_sens_prr, color=p)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Sensitivity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_sens_rr, color=p, group=p)) + 
  geom_point(aes(x=rr_thresh, y=mean_sens_rr, color=p)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Sensitivity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_sens_ror, color=p, group=p)) + 
  geom_point(aes(x=ror_thresh, y=mean_sens_ror, color=p)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Sensitivity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, group=p, color=p)) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=p)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99"), name="p") +
  labs(y="Mean Sensitivity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_sens_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Sensitivity plots for Setting 2 (\U03B2 = 1, \U03C1 = 0)")

sens_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_3d_5ae/fixed_beta_fixed_rho/beta1_rho_0/sens.png"
combined_sens_plot
ggsave(filename = sens_plot_file, plot = combined_sens_plot)

## specificity plots
#confidence thresholds
mean_spec_conf <- as.numeric(c(conf_results_p_0_1_beta1[2,], conf_results_p_0_3_beta1[2,], conf_results_p_0_5_beta1[2,]))

#prr thresholds
mean_spec_prr <- as.numeric(c(prr_results_p_0_1_beta1[2,], prr_results_p_0_3_beta1[2,], prr_results_p_0_5_beta1[2,]))

#rr thresholds
mean_spec_rr <- as.numeric(c(rr_results_p_0_1_beta1[2,], rr_results_p_0_3_beta1[2,], rr_results_p_0_5_beta1[2,]))

#ror thresholds
mean_spec_ror <- as.numeric(c(ror_results_p_0_1_beta1[2,], ror_results_p_0_3_beta1[2,], ror_results_p_0_5_beta1[2,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, group=p, color=p)) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=p)) + 
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Specificity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_spec_prr, group=p, color=p)) + 
  geom_point(aes(x=prr_thresh, y=mean_spec_prr, color=p)) +
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Specificity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_spec_rr, group=p, color=p)) + 
  geom_point(aes(x=rr_thresh, y=mean_spec_rr, color=p)) +
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Specificity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_spec_ror, group=p, color=p)) + 
  geom_point(aes(x=ror_thresh, y=mean_spec_ror, color=p)) +
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Specificity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, group=p, color=p)) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=p)) + 
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99"), name="p") +
  labs(y="Mean Specificity", x="Confidence thresholds") + 
  scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

combined_spec_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Specificity plots for Setting 2 (\U03B2 = 1, \U03C1 = 0)")
spec_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_3d_5ae/fixed_beta_fixed_rho/beta1_rho_0/spec.png"
combined_spec_plot
ggsave(filename = spec_plot_file, plot = combined_spec_plot)

## overall accuracy plots
#confidence thresholds
mean_acc_conf <- as.numeric(c(conf_results_p_0_1_beta1[5,], conf_results_p_0_3_beta1[5,], conf_results_p_0_5_beta1[5,]))

#prr thresholds
mean_acc_prr <- as.numeric(c(prr_results_p_0_1_beta1[5,], prr_results_p_0_3_beta1[5,], prr_results_p_0_5_beta1[5,]))

#rr thresholds
mean_acc_rr <- as.numeric(c(rr_results_p_0_1_beta1[5,], rr_results_p_0_3_beta1[5,], rr_results_p_0_5_beta1[5,]))

#ror thresholds
mean_acc_ror <- as.numeric(c(ror_results_p_0_1_beta1[5,], ror_results_p_0_3_beta1[5,], ror_results_p_0_5_beta1[5,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, group=p, color=p)) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=p)) + 
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_acc_prr, group=p, color=p)) + 
  geom_point(aes(x=prr_thresh, y=mean_acc_prr, color=p)) +
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Overall Accuracy", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_acc_rr, group=p, color=p)) + 
  geom_point(aes(x=rr_thresh, y=mean_acc_rr, color=p)) +
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Overall Accuracy", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_acc_ror, group=p, color=p)) + 
  geom_point(aes(x=ror_thresh, y=mean_acc_ror, color=p)) +
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Overall Accuracy", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, group=p, color=p)) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=p)) + 
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99"), name="p") +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") + 
  scale_color_discrete(name="p") +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_acc_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Overall Accuracy plots for Setting 2 (\U03B2 = 1, \U03C1 = 0)")

acc_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_3d_5ae/fixed_beta_fixed_rho/beta1_rho_0/acc.png"
combined_acc_plot
ggsave(filename = acc_plot_file, plot = combined_acc_plot)
```

```{r b_1_rho_0_3}
conf_thresh <- as.factor(rep(c(0.4,0.5,0.6,0.7), 9))
prr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 9))
rr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 9))
ror_thresh <- as.factor(rep(c(1,1.2,1.5,2), 9))
p <- as.factor(rep(c(rep(0.1,4), rep(0.3,4), rep(0.5,4)), 3))
sgn <- as.factor(c(rep(0,12), rep("+",12), rep("-",12)))
#corr <- as.factor(c(rep(0,4), rep(0.3,4), rep(-0.3,4), rep(0.5,4), rep(-0.5,4), rep(0.7,4), rep(-0.7,4)))

#sensitivity plots
#confidence thresholds
mean_sens_conf <- as.numeric(c(conf_results_beta1_p_0_1[1,], conf_results_beta1_p_0_3[1,], conf_results_beta1_p_0_5[1,], conf_results_beta1_dep_0_3_p_0_1[1,], conf_results_beta1_dep_0_3_p_0_3[1,], conf_results_beta1_dep_0_3_p_0_5[1,], conf_results_beta1_dep_neg0_3_p_0_1[1,], conf_results_beta1_dep_neg0_3_p_0_3[1,], conf_results_beta1_dep_neg0_3_p_0_5[1,]))

#prr thresholds
mean_sens_prr <- as.numeric(c(prr_results_beta1_p_0_1[1,], prr_results_beta1_p_0_3[1,], prr_results_beta1_p_0_5[1,], prr_results_beta1_dep_0_3_p_0_1[1,], prr_results_beta1_dep_0_3_p_0_3[1,], prr_results_beta1_dep_0_3_p_0_5[1,], prr_results_beta1_dep_neg0_3_p_0_1[1,], prr_results_beta1_dep_neg0_3_p_0_3[1,], prr_results_beta1_dep_neg0_3_p_0_5[1,]))

#rr thresholds
mean_sens_rr <- as.numeric(c(rr_results_beta1_p_0_1[1,], rr_results_beta1_p_0_3[1,], rr_results_beta1_p_0_5[1,], rr_results_beta1_dep_0_3_p_0_1[1,], rr_results_beta1_dep_0_3_p_0_3[1,], rr_results_beta1_dep_0_3_p_0_5[1,], rr_results_beta1_dep_neg0_3_p_0_1[1,], rr_results_beta1_dep_neg0_3_p_0_3[1,], rr_results_beta1_dep_neg0_3_p_0_5[1,]))

#ror thresholds
mean_sens_ror <- as.numeric(c(ror_results_beta1_p_0_1[1,], ror_results_beta1_p_0_3[1,], ror_results_beta1_p_0_5[1,], ror_results_beta1_dep_0_3_p_0_1[1,], ror_results_beta1_dep_0_3_p_0_3[1,], ror_results_beta1_dep_0_3_p_0_5[1,], ror_results_beta1_dep_neg0_3_p_0_1[1,], ror_results_beta1_dep_neg0_3_p_0_3[1,], ror_results_beta1_dep_neg0_3_p_0_5[1,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=p, linetype=sgn, group=interaction(p, sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=p)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Sensitivity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_sens_prr, color=p, linetype=sgn, group=interaction(p, sgn))) + 
  geom_point(aes(x=prr_thresh, y=mean_sens_prr, color=p)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Sensitivity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_sens_rr, color=p, linetype=sgn, group=interaction(p, sgn))) + 
  geom_point(aes(x=rr_thresh, y=mean_sens_rr, color=p)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Sensitivity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_sens_ror, color=p, linetype=sgn, group=interaction(p, sgn))) + 
  geom_point(aes(x=ror_thresh, y=mean_sens_ror, color=p)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Sensitivity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=p, linetype=sgn, group=interaction(p, sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=p)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  scale_linetype_manual(values = c("dotted", "dashed","solid"), name="direction") +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99"), name="p") +
  labs(y="Mean Sensitivity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_sens_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Sensitivity plots for Setting 3 (\U03B2 = 1, \U03C1 = 0.3)")

sens_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_rho/beta1_rho_0_3/sens.png"
combined_sens_plot
ggsave(filename = sens_plot_file, plot = combined_sens_plot)

## specificity plots
#confidence thresholds
mean_spec_conf <- as.numeric(c(conf_results_beta1_p_0_1[2,], conf_results_beta1_p_0_3[2,], conf_results_beta1_p_0_5[2,], conf_results_beta1_dep_0_3_p_0_1[2,], conf_results_beta1_dep_0_3_p_0_3[2,], conf_results_beta1_dep_0_3_p_0_5[2,], conf_results_beta1_dep_neg0_3_p_0_1[2,], conf_results_beta1_dep_neg0_3_p_0_3[2,], conf_results_beta1_dep_neg0_3_p_0_5[2,]))

#prr thresholds
mean_spec_prr <- as.numeric(c(prr_results_beta1_p_0_1[2,], prr_results_beta1_p_0_3[2,], prr_results_beta1_p_0_5[2,], prr_results_beta1_dep_0_3_p_0_1[2,], prr_results_beta1_dep_0_3_p_0_3[2,], prr_results_beta1_dep_0_3_p_0_5[2,], prr_results_beta1_dep_neg0_3_p_0_1[2,], prr_results_beta1_dep_neg0_3_p_0_3[2,], prr_results_beta1_dep_neg0_3_p_0_5[2,]))

#rr thresholds
mean_spec_rr <- as.numeric(c(rr_results_beta1_p_0_1[2,], rr_results_beta1_p_0_3[2,], rr_results_beta1_p_0_5[2,], rr_results_beta1_dep_0_3_p_0_1[2,], rr_results_beta1_dep_0_3_p_0_3[2,], rr_results_beta1_dep_0_3_p_0_5[2,], rr_results_beta1_dep_neg0_3_p_0_1[2,], rr_results_beta1_dep_neg0_3_p_0_3[2,], rr_results_beta1_dep_neg0_3_p_0_5[2,]))

#ror thresholds
mean_spec_ror <- as.numeric(c(ror_results_beta1_p_0_1[2,], ror_results_beta1_p_0_3[2,], ror_results_beta1_p_0_5[2,], ror_results_beta1_dep_0_3_p_0_1[2,], ror_results_beta1_dep_0_3_p_0_3[2,], ror_results_beta1_dep_0_3_p_0_5[2,], ror_results_beta1_dep_neg0_3_p_0_1[2,], ror_results_beta1_dep_neg0_3_p_0_3[2,], ror_results_beta1_dep_neg0_3_p_0_5[2,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=p, linetype=sgn, group=interaction(p, sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=p)) + 
  ylim(0.6,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Specificity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_spec_prr, color=p, linetype=sgn, group=interaction(p, sgn))) + 
  geom_point(aes(x=prr_thresh, y=mean_spec_prr, color=p)) +
  ylim(0.6,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Specificity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_spec_rr, color=p, linetype=sgn, group=interaction(p, sgn))) + 
  geom_point(aes(x=rr_thresh, y=mean_spec_rr, color=p)) +
  ylim(0.6,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Specificity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_spec_ror, color=p, linetype=sgn, group=interaction(p, sgn))) + 
  geom_point(aes(x=ror_thresh, y=mean_spec_ror, color=p)) +
  ylim(0.6,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Specificity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=p, linetype=sgn, group=interaction(p, sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=p)) + 
  ylim(0.6,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  scale_linetype_manual(values = c("dotted", "dashed","solid"), name="direction") +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99"), name="p") +
  labs(y="Mean Specificity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

combined_spec_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Specificity plots for Setting 3 (\U03B2 = 1, \U03C1 = 0.3)")
spec_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_rho/beta1_rho_0_3/spec.png"
combined_spec_plot
ggsave(filename = spec_plot_file, plot = combined_spec_plot)

## overall accuracy plots
#confidence thresholds
mean_acc_conf <- as.numeric(c(conf_results_beta1_p_0_1[5,], conf_results_beta1_p_0_3[5,], conf_results_beta1_p_0_5[5,], conf_results_beta1_dep_0_3_p_0_1[5,], conf_results_beta1_dep_0_3_p_0_3[5,], conf_results_beta1_dep_0_3_p_0_5[5,], conf_results_beta1_dep_neg0_3_p_0_1[5,], conf_results_beta1_dep_neg0_3_p_0_3[5,], conf_results_beta1_dep_neg0_3_p_0_5[5,]))

#prr thresholds
mean_acc_prr <- as.numeric(c(prr_results_beta1_p_0_1[5,], prr_results_beta1_p_0_3[5,], prr_results_beta1_p_0_5[5,], prr_results_beta1_dep_0_3_p_0_1[5,], prr_results_beta1_dep_0_3_p_0_3[5,], prr_results_beta1_dep_0_3_p_0_5[5,], prr_results_beta1_dep_neg0_3_p_0_1[5,], prr_results_beta1_dep_neg0_3_p_0_3[5,], prr_results_beta1_dep_neg0_3_p_0_5[5,]))

#rr thresholds
mean_acc_rr <- as.numeric(c(rr_results_beta1_p_0_1[5,], rr_results_beta1_p_0_3[5,], rr_results_beta1_p_0_5[5,], rr_results_beta1_dep_0_3_p_0_1[5,], rr_results_beta1_dep_0_3_p_0_3[5,], rr_results_beta1_dep_0_3_p_0_5[5,], rr_results_beta1_dep_neg0_3_p_0_1[5,], rr_results_beta1_dep_neg0_3_p_0_3[5,], rr_results_beta1_dep_neg0_3_p_0_5[5,]))

#ror thresholds
mean_acc_ror <- as.numeric(c(ror_results_beta1_p_0_1[5,], ror_results_beta1_p_0_3[5,], ror_results_beta1_p_0_5[5,], ror_results_beta1_dep_0_3_p_0_1[5,], ror_results_beta1_dep_0_3_p_0_3[5,], ror_results_beta1_dep_0_3_p_0_5[5,], ror_results_beta1_dep_neg0_3_p_0_1[5,], ror_results_beta1_dep_neg0_3_p_0_3[5,], ror_results_beta1_dep_neg0_3_p_0_5[5,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=p, linetype=sgn, group=interaction(p, sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=p)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_acc_prr, color=p, linetype=sgn, group=interaction(p, sgn))) + 
  geom_point(aes(x=prr_thresh, y=mean_acc_prr, color=p)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Overall Accuracy", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_acc_rr, color=p, linetype=sgn, group=interaction(p, sgn))) + 
  geom_point(aes(x=rr_thresh, y=mean_acc_rr, color=p)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Overall Accuracy", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_acc_ror, color=p, linetype=sgn, group=interaction(p, sgn))) + 
  geom_point(aes(x=ror_thresh, y=mean_acc_ror, color=p)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Overall Accuracy", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=p, linetype=sgn, group=interaction(p, sgn))) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=p)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  scale_linetype_manual(values = c("dotted", "dashed","solid"), name="direction") +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99"), name="p") +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_acc_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Overall Accuracy plots for Setting 3 (\U03B2 = 1, \U03C1 = 0.3)")

acc_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_rho/beta1_rho_0_3/acc.png"
combined_acc_plot
ggsave(filename = acc_plot_file, plot = combined_acc_plot)
```

```{r b_1_rho_0_5}
conf_thresh <- as.factor(rep(c(0.4,0.5,0.6,0.7), 3))
prr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
rr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
ror_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
p <- as.factor(c(rep(0.1,4), rep(0.3,4), rep(0.5,4)))
#corr <- as.factor(c(rep(0,4), rep(0.3,4), rep(-0.3,4), rep(0.5,4), rep(-0.5,4), rep(0.7,4), rep(-0.7,4)))

#sensitivity plots
#confidence thresholds
mean_sens_conf <- as.numeric(c(conf_results_beta1_dep_0_5_p_0_1[1,], conf_results_beta1_dep_0_5_p_0_3[1,], conf_results_beta1_dep_0_5_p_0_5[1,]))

#prr thresholds
mean_sens_prr <- as.numeric(c(prr_results_beta1_dep_0_5_p_0_1[1,], prr_results_beta1_dep_0_5_p_0_3[1,], prr_results_beta1_dep_0_5_p_0_5[1,]))

#rr thresholds
mean_sens_rr <- as.numeric(c(rr_results_beta1_dep_0_5_p_0_1[1,], rr_results_beta1_dep_0_5_p_0_3[1,], rr_results_beta1_dep_0_5_p_0_5[1,]))

#ror thresholds
mean_sens_ror <- as.numeric(c(ror_results_beta1_dep_0_5_p_0_1[1,], ror_results_beta1_dep_0_5_p_0_3[1,], ror_results_beta1_dep_0_5_p_0_5[1,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=p, group=p)) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=p)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Sensitivity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_sens_prr, color=p, group=p)) + 
  geom_point(aes(x=prr_thresh, y=mean_sens_prr, color=p)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Sensitivity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_sens_rr, color=p, group=p)) + 
  geom_point(aes(x=rr_thresh, y=mean_sens_rr, color=p)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Sensitivity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_sens_ror, color=p, group=p)) + 
  geom_point(aes(x=ror_thresh, y=mean_sens_ror, color=p)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Sensitivity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, group=p, color=p)) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=p)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99"), name="p") +
  labs(y="Mean Sensitivity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_sens_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Sensitivity plots for Setting 2 (\U03B2 = 1, \U03C1 = 0.5)")

sens_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_3d_5ae/fixed_beta_fixed_rho/beta1_rho_0_5/sens.png"
combined_sens_plot
ggsave(filename = sens_plot_file, plot = combined_sens_plot)

## specificity plots
#confidence thresholds
mean_spec_conf <- as.numeric(c(conf_results_beta1_dep_0_5_p_0_1[2,], conf_results_beta1_dep_0_5_p_0_3[2,], conf_results_beta1_dep_0_5_p_0_5[2,]))

#prr thresholds
mean_spec_prr <- as.numeric(c(prr_results_beta1_dep_0_5_p_0_1[2,], prr_results_beta1_dep_0_5_p_0_3[2,], prr_results_beta1_dep_0_5_p_0_5[2,]))

#rr thresholds
mean_spec_rr <- as.numeric(c(rr_results_beta1_dep_0_5_p_0_1[2,], rr_results_beta1_dep_0_5_p_0_3[2,], rr_results_beta1_dep_0_5_p_0_5[2,]))

#ror thresholds
mean_spec_ror <- as.numeric(c(ror_results_beta1_dep_0_5_p_0_1[2,], ror_results_beta1_dep_0_5_p_0_3[2,], ror_results_beta1_dep_0_5_p_0_5[2,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, group=p, color=p)) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=p)) + 
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Specificity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_spec_prr, group=p, color=p)) + 
  geom_point(aes(x=prr_thresh, y=mean_spec_prr, color=p)) +
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Specificity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_spec_rr, group=p, color=p)) + 
  geom_point(aes(x=rr_thresh, y=mean_spec_rr, color=p)) +
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Specificity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_spec_ror, group=p, color=p)) + 
  geom_point(aes(x=ror_thresh, y=mean_spec_ror, color=p)) +
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Specificity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, group=p, color=p)) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=p)) + 
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99"), name="p") +
  labs(y="Mean Specificity", x="Confidence thresholds") + 
  scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

combined_spec_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Specificity plots for Setting 2 (\U03B2 = 1, \U03C1 = 0.5)")
spec_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_3d_5ae/fixed_beta_fixed_rho/beta1_rho_0_5/spec.png"
combined_spec_plot
ggsave(filename = spec_plot_file, plot = combined_spec_plot)

## overall accuracy plots
#confidence thresholds
mean_acc_conf <- as.numeric(c(conf_results_beta1_dep_0_5_p_0_1[5,], conf_results_beta1_dep_0_5_p_0_3[5,], conf_results_beta1_dep_0_5_p_0_5[5,]))

#prr thresholds
mean_acc_prr <- as.numeric(c(prr_results_beta1_dep_0_5_p_0_1[5,], prr_results_beta1_dep_0_5_p_0_3[5,], prr_results_beta1_dep_0_5_p_0_5[5,]))

#rr thresholds
mean_acc_rr <- as.numeric(c(rr_results_beta1_dep_0_5_p_0_1[5,], rr_results_beta1_dep_0_5_p_0_3[5,], rr_results_beta1_dep_0_5_p_0_5[5,]))

#ror thresholds
mean_acc_ror <- as.numeric(c(ror_results_beta1_dep_0_5_p_0_1[5,], ror_results_beta1_dep_0_5_p_0_3[5,], ror_results_beta1_dep_0_5_p_0_5[5,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, group=p, color=p)) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=p)) + 
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_acc_prr, group=p, color=p)) + 
  geom_point(aes(x=prr_thresh, y=mean_acc_prr, color=p)) +
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Overall Accuracy", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_acc_rr, group=p, color=p)) + 
  geom_point(aes(x=rr_thresh, y=mean_acc_rr, color=p)) +
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Overall Accuracy", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_acc_ror, group=p, color=p)) + 
  geom_point(aes(x=ror_thresh, y=mean_acc_ror, color=p)) +
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Overall Accuracy", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, group=p, color=p)) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=p)) + 
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99"), name="p") +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") + 
  scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_acc_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Overall Accuracy plots for Setting 2 (\U03B2 = 1, \U03C1 = 0.5)")

acc_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_3d_5ae/fixed_beta_fixed_rho/beta1_rho_0_5/acc.png"
combined_acc_plot
ggsave(filename = acc_plot_file, plot = combined_acc_plot)
```

```{r b_1_rho_0_7}
conf_thresh <- as.factor(rep(c(0.4,0.5,0.6,0.7), 3))
prr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
rr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
ror_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
p <- as.factor(c(rep(0.1,4), rep(0.3,4), rep(0.5,4)))
#corr <- as.factor(c(rep(0,4), rep(0.3,4), rep(-0.3,4), rep(0.5,4), rep(-0.5,4), rep(0.7,4), rep(-0.7,4)))

#sensitivity plots
#confidence thresholds
mean_sens_conf <- as.numeric(c(conf_results_beta1_dep_0_7_p_0_1[1,], conf_results_beta1_dep_0_7_p_0_3[1,], conf_results_beta1_dep_0_7_p_0_5[1,]))

#prr thresholds
mean_sens_prr <- as.numeric(c(prr_results_beta1_dep_0_7_p_0_1[1,], prr_results_beta1_dep_0_7_p_0_3[1,], prr_results_beta1_dep_0_7_p_0_5[1,]))

#rr thresholds
mean_sens_rr <- as.numeric(c(rr_results_beta1_dep_0_7_p_0_1[1,], rr_results_beta1_dep_0_7_p_0_3[1,], rr_results_beta1_dep_0_7_p_0_5[1,]))

#ror thresholds
mean_sens_ror <- as.numeric(c(ror_results_beta1_dep_0_7_p_0_1[1,], ror_results_beta1_dep_0_7_p_0_3[1,], ror_results_beta1_dep_0_7_p_0_5[1,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=p, group=p)) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=p)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Sensitivity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_sens_prr, color=p, group=p)) + 
  geom_point(aes(x=prr_thresh, y=mean_sens_prr, color=p)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Sensitivity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_sens_rr, color=p, group=p)) + 
  geom_point(aes(x=rr_thresh, y=mean_sens_rr, color=p)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Sensitivity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_sens_ror, color=p, group=p)) + 
  geom_point(aes(x=ror_thresh, y=mean_sens_ror, color=p)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Sensitivity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, group=p, color=p)) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=p)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99"), name="p") +
  labs(y="Mean Sensitivity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_sens_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Sensitivity plots for Setting 2 (\U03B2 = 1, \U03C1 = 0.7)")

sens_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_3d_5ae/fixed_beta_fixed_rho/beta1_rho_0_7/sens.png"
combined_sens_plot
ggsave(filename = sens_plot_file, plot = combined_sens_plot)

## specificity plots
#confidence thresholds
mean_spec_conf <- as.numeric(c(conf_results_beta1_dep_0_7_p_0_1[2,], conf_results_beta1_dep_0_7_p_0_3[2,], conf_results_beta1_dep_0_7_p_0_5[2,]))

#prr thresholds
mean_spec_prr <- as.numeric(c(prr_results_beta1_dep_0_7_p_0_1[2,], prr_results_beta1_dep_0_7_p_0_3[2,], prr_results_beta1_dep_0_7_p_0_5[2,]))

#rr thresholds
mean_spec_rr <- as.numeric(c(rr_results_beta1_dep_0_7_p_0_1[2,], rr_results_beta1_dep_0_7_p_0_3[2,], rr_results_beta1_dep_0_7_p_0_5[2,]))

#ror thresholds
mean_spec_ror <- as.numeric(c(ror_results_beta1_dep_0_7_p_0_1[2,], ror_results_beta1_dep_0_7_p_0_3[2,], ror_results_beta1_dep_0_7_p_0_5[2,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, group=p, color=p)) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=p)) + 
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Specificity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_spec_prr, group=p, color=p)) + 
  geom_point(aes(x=prr_thresh, y=mean_spec_prr, color=p)) +
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Specificity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_spec_rr, group=p, color=p)) + 
  geom_point(aes(x=rr_thresh, y=mean_spec_rr, color=p)) +
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Specificity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_spec_ror, group=p, color=p)) + 
  geom_point(aes(x=ror_thresh, y=mean_spec_ror, color=p)) +
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Specificity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, group=p, color=p)) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=p)) + 
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99"), name="p") +
  labs(y="Mean Specificity", x="Confidence thresholds") + 
  scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

combined_spec_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Specificity plots for Setting 2 (\U03B2 = 1, \U03C1 = 0.7)")
spec_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_3d_5ae/fixed_beta_fixed_rho/beta1_rho_0_7/spec.png"
combined_spec_plot
ggsave(filename = spec_plot_file, plot = combined_spec_plot)

## overall accuracy plots
#confidence thresholds
mean_acc_conf <- as.numeric(c(conf_results_beta1_dep_0_7_p_0_1[5,], conf_results_beta1_dep_0_7_p_0_3[5,], conf_results_beta1_dep_0_7_p_0_5[5,]))

#prr thresholds
mean_acc_prr <- as.numeric(c(prr_results_beta1_dep_0_7_p_0_1[5,], prr_results_beta1_dep_0_7_p_0_3[5,], prr_results_beta1_dep_0_7_p_0_5[5,]))

#rr thresholds
mean_acc_rr <- as.numeric(c(rr_results_beta1_dep_0_7_p_0_1[5,], rr_results_beta1_dep_0_7_p_0_3[5,], rr_results_beta1_dep_0_7_p_0_5[5,]))

#ror thresholds
mean_acc_ror <- as.numeric(c(ror_results_beta1_dep_0_7_p_0_1[5,], ror_results_beta1_dep_0_7_p_0_3[5,], ror_results_beta1_dep_0_7_p_0_5[5,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, group=p, color=p)) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=p)) + 
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_acc_prr, group=p, color=p)) + 
  geom_point(aes(x=prr_thresh, y=mean_acc_prr, color=p)) +
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Overall Accuracy", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_acc_rr, group=p, color=p)) + 
  geom_point(aes(x=rr_thresh, y=mean_acc_rr, color=p)) +
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Overall Accuracy", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_acc_ror, group=p, color=p)) + 
  geom_point(aes(x=ror_thresh, y=mean_acc_ror, color=p)) +
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Overall Accuracy", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, group=p, color=p)) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=p)) + 
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99"), name="p") +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") + 
  scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_acc_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Overall Accuracy plots for Setting 2 (\U03B2 = 1, \U03C1 = 0.7)")

acc_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_3d_5ae/fixed_beta_fixed_rho/beta1_rho_0_7/acc.png"
combined_acc_plot
ggsave(filename = acc_plot_file, plot = combined_acc_plot)
```

```{r b_50_rho_0}
conf_thresh <- as.factor(rep(c(0.4,0.5,0.6,0.7), 3))
prr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
rr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
ror_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
p <- as.factor(c(rep(0.1,4), rep(0.3,4), rep(0.5,4)))
#corr <- as.factor(c(rep(0,4), rep(0.3,4), rep(-0.3,4), rep(0.5,4), rep(-0.5,4), rep(0.7,4), rep(-0.7,4)))

#sensitivity plots
#confidence thresholds
mean_sens_conf <- as.numeric(c(conf_results_p_0_1_beta50[1,], conf_results_p_0_3_beta50[1,], conf_results_p_0_5_beta50[1,]))

#prr thresholds
mean_sens_prr <- as.numeric(c(prr_results_p_0_1_beta50[1,], prr_results_p_0_3_beta50[1,], prr_results_p_0_5_beta50[1,]))

#rr thresholds
mean_sens_rr <- as.numeric(c(rr_results_p_0_1_beta50[1,], rr_results_p_0_3_beta50[1,], rr_results_p_0_5_beta50[1,]))

#ror thresholds
mean_sens_ror <- as.numeric(c(ror_results_p_0_1_beta50[1,], ror_results_p_0_3_beta50[1,], ror_results_p_0_5_beta50[1,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=p, group=p)) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=p)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Sensitivity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_sens_prr, color=p, group=p)) + 
  geom_point(aes(x=prr_thresh, y=mean_sens_prr, color=p)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Sensitivity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_sens_rr, color=p, group=p)) + 
  geom_point(aes(x=rr_thresh, y=mean_sens_rr, color=p)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Sensitivity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_sens_ror, color=p, group=p)) + 
  geom_point(aes(x=ror_thresh, y=mean_sens_ror, color=p)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Sensitivity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, group=p, color=p)) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=p)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99"), name="p") +
  labs(y="Mean Sensitivity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_sens_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Sensitivity plots for Setting 2 (\U03B2 = 50, \U03C1 = 0)")

sens_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_3d_5ae/fixed_beta_fixed_rho/beta50_rho_0/sens.png"
combined_sens_plot
ggsave(filename = sens_plot_file, plot = combined_sens_plot)

## specificity plots
#confidence thresholds
mean_spec_conf <- as.numeric(c(conf_results_p_0_1_beta50[2,], conf_results_p_0_3_beta50[2,], conf_results_p_0_5_beta50[2,]))

#prr thresholds
mean_spec_prr <- as.numeric(c(prr_results_p_0_1_beta50[2,], prr_results_p_0_3_beta50[2,], prr_results_p_0_5_beta50[2,]))

#rr thresholds
mean_spec_rr <- as.numeric(c(rr_results_p_0_1_beta50[2,], rr_results_p_0_3_beta50[2,], rr_results_p_0_5_beta50[2,]))

#ror thresholds
mean_spec_ror <- as.numeric(c(ror_results_p_0_1_beta50[2,], ror_results_p_0_3_beta50[2,], ror_results_p_0_5_beta50[2,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, group=p, color=p)) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=p)) + 
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Specificity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_spec_prr, group=p, color=p)) + 
  geom_point(aes(x=prr_thresh, y=mean_spec_prr, color=p)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Specificity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_spec_rr, group=p, color=p)) + 
  geom_point(aes(x=rr_thresh, y=mean_spec_rr, color=p)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Specificity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_spec_ror, group=p, color=p)) + 
  geom_point(aes(x=ror_thresh, y=mean_spec_ror, color=p)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Specificity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, group=p, color=p)) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=p)) + 
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99"), name="p") +
  labs(y="Mean Specificity", x="Confidence thresholds") + 
  scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

combined_spec_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Specificity plots for Setting 2 (\U03B2 = 50, \U03C1 = 0)")
spec_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_3d_5ae/fixed_beta_fixed_rho/beta50_rho_0/spec.png"
combined_spec_plot
ggsave(filename = spec_plot_file, plot = combined_spec_plot)

## overall accuracy plots
#confidence thresholds
mean_acc_conf <- as.numeric(c(conf_results_p_0_1_beta50[5,], conf_results_p_0_3_beta50[5,], conf_results_p_0_5_beta50[5,]))

#prr thresholds
mean_acc_prr <- as.numeric(c(prr_results_p_0_1_beta50[5,], prr_results_p_0_3_beta50[5,], prr_results_p_0_5_beta50[5,]))

#rr thresholds
mean_acc_rr <- as.numeric(c(rr_results_p_0_1_beta50[5,], rr_results_p_0_3_beta50[5,], rr_results_p_0_5_beta50[5,]))

#ror thresholds
mean_acc_ror <- as.numeric(c(ror_results_p_0_1_beta50[5,], ror_results_p_0_3_beta50[5,], ror_results_p_0_5_beta50[5,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, group=p, color=p)) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=p)) + 
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_acc_prr, group=p, color=p)) + 
  geom_point(aes(x=prr_thresh, y=mean_acc_prr, color=p)) +
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Overall Accuracy", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_acc_rr, group=p, color=p)) + 
  geom_point(aes(x=rr_thresh, y=mean_acc_rr, color=p)) +
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Overall Accuracy", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_acc_ror, group=p, color=p)) + 
  geom_point(aes(x=ror_thresh, y=mean_acc_ror, color=p)) +
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Overall Accuracy", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, group=p, color=p)) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=p)) + 
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99"), name="p") +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") + 
  scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_acc_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Overall Accuracy plots for Setting 2 (\U03B2 = 50, \U03C1 = 0)")

acc_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_3d_5ae/fixed_beta_fixed_rho/beta50_rho_0/acc.png"
combined_acc_plot
ggsave(filename = acc_plot_file, plot = combined_acc_plot)
```

```{r b_50_rho_0_3}
conf_thresh <- as.factor(rep(c(0.4,0.5,0.6,0.7), 3))
prr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
rr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
ror_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
p <- as.factor(c(rep(0.1,4), rep(0.3,4), rep(0.5,4)))
#corr <- as.factor(c(rep(0,4), rep(0.3,4), rep(-0.3,4), rep(0.5,4), rep(-0.5,4), rep(0.7,4), rep(-0.7,4)))

#sensitivity plots
#confidence thresholds
mean_sens_conf <- as.numeric(c(conf_results_beta50_dep_0_3_p_0_1[1,], conf_results_beta50_dep_0_3_p_0_3[1,], conf_results_beta50_dep_0_3_p_0_5[1,]))

#prr thresholds
mean_sens_prr <- as.numeric(c(prr_results_beta50_dep_0_3_p_0_1[1,], prr_results_beta50_dep_0_3_p_0_3[1,], prr_results_beta50_dep_0_3_p_0_5[1,]))

#rr thresholds
mean_sens_rr <- as.numeric(c(rr_results_beta50_dep_0_3_p_0_1[1,], rr_results_beta50_dep_0_3_p_0_3[1,], rr_results_beta50_dep_0_3_p_0_5[1,]))

#ror thresholds
mean_sens_ror <- as.numeric(c(ror_results_beta50_dep_0_3_p_0_1[1,], ror_results_beta50_dep_0_3_p_0_3[1,], ror_results_beta50_dep_0_3_p_0_5[1,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=p, group=p)) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=p)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Sensitivity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_sens_prr, color=p, group=p)) + 
  geom_point(aes(x=prr_thresh, y=mean_sens_prr, color=p)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Sensitivity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_sens_rr, color=p, group=p)) + 
  geom_point(aes(x=rr_thresh, y=mean_sens_rr, color=p)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Sensitivity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_sens_ror, color=p, group=p)) + 
  geom_point(aes(x=ror_thresh, y=mean_sens_ror, color=p)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Sensitivity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, group=p, color=p)) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=p)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99"), name="p") +
  labs(y="Mean Sensitivity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_sens_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Sensitivity plots for Setting 2 (\U03B2 = 50, \U03C1 = 0.3)")

sens_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_3d_5ae/fixed_beta_fixed_rho/beta50_rho_0_3/sens.png"
combined_sens_plot
ggsave(filename = sens_plot_file, plot = combined_sens_plot)

## specificity plots
#confidence thresholds
mean_spec_conf <- as.numeric(c(conf_results_beta50_dep_0_3_p_0_1[2,], conf_results_beta50_dep_0_3_p_0_3[2,], conf_results_beta50_dep_0_3_p_0_5[2,]))

#prr thresholds
mean_spec_prr <- as.numeric(c(prr_results_beta50_dep_0_3_p_0_1[2,], prr_results_beta50_dep_0_3_p_0_3[2,], prr_results_beta50_dep_0_3_p_0_5[2,]))

#rr thresholds
mean_spec_rr <- as.numeric(c(rr_results_beta50_dep_0_3_p_0_1[2,], rr_results_beta50_dep_0_3_p_0_3[2,], rr_results_beta50_dep_0_3_p_0_5[2,]))

#ror thresholds
mean_spec_ror <- as.numeric(c(ror_results_beta50_dep_0_3_p_0_1[2,], ror_results_beta50_dep_0_3_p_0_3[2,], ror_results_beta50_dep_0_3_p_0_5[2,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, group=p, color=p)) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=p)) + 
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Specificity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_spec_prr, group=p, color=p)) + 
  geom_point(aes(x=prr_thresh, y=mean_spec_prr, color=p)) +
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Specificity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_spec_rr, group=p, color=p)) + 
  geom_point(aes(x=rr_thresh, y=mean_spec_rr, color=p)) +
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Specificity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_spec_ror, group=p, color=p)) + 
  geom_point(aes(x=ror_thresh, y=mean_spec_ror, color=p)) +
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Specificity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, group=p, color=p)) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=p)) + 
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99"), name="p") +
  labs(y="Mean Specificity", x="Confidence thresholds") + 
  scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

combined_spec_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Specificity plots for Setting 2 (\U03B2 = 50, \U03C1 = 0.3)")
spec_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_3d_5ae/fixed_beta_fixed_rho/beta50_rho_0_3/spec.png"
combined_spec_plot
ggsave(filename = spec_plot_file, plot = combined_spec_plot)

## overall accuracy plots
#confidence thresholds
mean_acc_conf <- as.numeric(c(conf_results_beta50_dep_0_3_p_0_1[5,], conf_results_beta50_dep_0_3_p_0_3[5,], conf_results_beta50_dep_0_3_p_0_5[5,]))

#prr thresholds
mean_acc_prr <- as.numeric(c(prr_results_beta50_dep_0_3_p_0_1[5,], prr_results_beta50_dep_0_3_p_0_3[5,], prr_results_beta50_dep_0_3_p_0_5[5,]))

#rr thresholds
mean_acc_rr <- as.numeric(c(rr_results_beta50_dep_0_3_p_0_1[5,], rr_results_beta50_dep_0_3_p_0_3[5,], rr_results_beta50_dep_0_3_p_0_5[5,]))

#ror thresholds
mean_acc_ror <- as.numeric(c(ror_results_beta50_dep_0_3_p_0_1[5,], ror_results_beta50_dep_0_3_p_0_3[5,], ror_results_beta50_dep_0_3_p_0_5[5,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, group=p, color=p)) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=p)) + 
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_acc_prr, group=p, color=p)) + 
  geom_point(aes(x=prr_thresh, y=mean_acc_prr, color=p)) +
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Overall Accuracy", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_acc_rr, group=p, color=p)) + 
  geom_point(aes(x=rr_thresh, y=mean_acc_rr, color=p)) +
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Overall Accuracy", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_acc_ror, group=p, color=p)) + 
  geom_point(aes(x=ror_thresh, y=mean_acc_ror, color=p)) +
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Overall Accuracy", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, group=p, color=p)) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=p)) + 
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99"), name="p") +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") + 
  scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_acc_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Overall Accuracy plots for Setting 2 (\U03B2 = 50, \U03C1 = 0.3)")

acc_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_3d_5ae/fixed_beta_fixed_rho/beta50_rho_0_3/acc.png"
combined_acc_plot
ggsave(filename = acc_plot_file, plot = combined_acc_plot)
```

```{r b_50_rho_0_5}
conf_thresh <- as.factor(rep(c(0.4,0.5,0.6,0.7), 3))
prr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
rr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
ror_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
p <- as.factor(c(rep(0.1,4), rep(0.3,4), rep(0.5,4)))
#corr <- as.factor(c(rep(0,4), rep(0.3,4), rep(-0.3,4), rep(0.5,4), rep(-0.5,4), rep(0.7,4), rep(-0.7,4)))

#sensitivity plots
#confidence thresholds
mean_sens_conf <- as.numeric(c(conf_results_beta50_dep_0_5_p_0_1[1,], conf_results_beta50_dep_0_5_p_0_3[1,], conf_results_beta50_dep_0_5_p_0_5[1,]))

#prr thresholds
mean_sens_prr <- as.numeric(c(prr_results_beta50_dep_0_5_p_0_1[1,], prr_results_beta50_dep_0_5_p_0_3[1,], prr_results_beta50_dep_0_5_p_0_5[1,]))

#rr thresholds
mean_sens_rr <- as.numeric(c(rr_results_beta50_dep_0_5_p_0_1[1,], rr_results_beta50_dep_0_5_p_0_3[1,], rr_results_beta50_dep_0_5_p_0_5[1,]))

#ror thresholds
mean_sens_ror <- as.numeric(c(ror_results_beta50_dep_0_5_p_0_1[1,], ror_results_beta50_dep_0_5_p_0_3[1,], ror_results_beta50_dep_0_5_p_0_5[1,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=p, group=p)) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=p)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Sensitivity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_sens_prr, color=p, group=p)) + 
  geom_point(aes(x=prr_thresh, y=mean_sens_prr, color=p)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Sensitivity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_sens_rr, color=p, group=p)) + 
  geom_point(aes(x=rr_thresh, y=mean_sens_rr, color=p)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Sensitivity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_sens_ror, color=p, group=p)) + 
  geom_point(aes(x=ror_thresh, y=mean_sens_ror, color=p)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Sensitivity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, group=p, color=p)) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=p)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99"), name="p") +
  labs(y="Mean Sensitivity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_sens_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Sensitivity plots for Setting 2 (\U03B2 = 50, \U03C1 = 0.5)")

sens_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_3d_5ae/fixed_beta_fixed_rho/beta50_rho_0_5/sens.png"
combined_sens_plot
ggsave(filename = sens_plot_file, plot = combined_sens_plot)

## specificity plots
#confidence thresholds
mean_spec_conf <- as.numeric(c(conf_results_beta50_dep_0_5_p_0_1[2,], conf_results_beta50_dep_0_5_p_0_3[2,], conf_results_beta50_dep_0_5_p_0_5[2,]))

#prr thresholds
mean_spec_prr <- as.numeric(c(prr_results_beta50_dep_0_5_p_0_1[2,], prr_results_beta50_dep_0_5_p_0_3[2,], prr_results_beta50_dep_0_5_p_0_5[2,]))

#rr thresholds
mean_spec_rr <- as.numeric(c(rr_results_beta50_dep_0_5_p_0_1[2,], rr_results_beta50_dep_0_5_p_0_3[2,], rr_results_beta50_dep_0_5_p_0_5[2,]))

#ror thresholds
mean_spec_ror <- as.numeric(c(ror_results_beta50_dep_0_5_p_0_1[2,], ror_results_beta50_dep_0_5_p_0_3[2,], ror_results_beta50_dep_0_5_p_0_5[2,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, group=p, color=p)) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=p)) + 
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Specificity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_spec_prr, group=p, color=p)) + 
  geom_point(aes(x=prr_thresh, y=mean_spec_prr, color=p)) +
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Specificity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_spec_rr, group=p, color=p)) + 
  geom_point(aes(x=rr_thresh, y=mean_spec_rr, color=p)) +
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Specificity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_spec_ror, group=p, color=p)) + 
  geom_point(aes(x=ror_thresh, y=mean_spec_ror, color=p)) +
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Specificity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, group=p, color=p)) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=p)) + 
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99"), name="p") +
  labs(y="Mean Specificity", x="Confidence thresholds") + 
  scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

combined_spec_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Specificity plots for Setting 2 (\U03B2 = 50, \U03C1 = 0.5)")
spec_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_3d_5ae/fixed_beta_fixed_rho/beta50_rho_0_5/spec.png"
combined_spec_plot
ggsave(filename = spec_plot_file, plot = combined_spec_plot)

## overall accuracy plots
#confidence thresholds
mean_acc_conf <- as.numeric(c(conf_results_beta50_dep_0_5_p_0_1[5,], conf_results_beta50_dep_0_5_p_0_3[5,], conf_results_beta50_dep_0_5_p_0_5[5,]))

#prr thresholds
mean_acc_prr <- as.numeric(c(prr_results_beta50_dep_0_5_p_0_1[5,], prr_results_beta50_dep_0_5_p_0_3[5,], prr_results_beta50_dep_0_5_p_0_5[5,]))

#rr thresholds
mean_acc_rr <- as.numeric(c(rr_results_beta50_dep_0_5_p_0_1[5,], rr_results_beta50_dep_0_5_p_0_3[5,], rr_results_beta50_dep_0_5_p_0_5[5,]))

#ror thresholds
mean_acc_ror <- as.numeric(c(ror_results_beta50_dep_0_5_p_0_1[5,], ror_results_beta50_dep_0_5_p_0_3[5,], ror_results_beta50_dep_0_5_p_0_5[5,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, group=p, color=p)) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=p)) + 
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_acc_prr, group=p, color=p)) + 
  geom_point(aes(x=prr_thresh, y=mean_acc_prr, color=p)) +
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Overall Accuracy", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_acc_rr, group=p, color=p)) + 
  geom_point(aes(x=rr_thresh, y=mean_acc_rr, color=p)) +
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Overall Accuracy", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_acc_ror, group=p, color=p)) + 
  geom_point(aes(x=ror_thresh, y=mean_acc_ror, color=p)) +
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Overall Accuracy", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, group=p, color=p)) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=p)) + 
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99"), name="p") +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") + 
  scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_acc_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Overall Accuracy plots for Setting 2 (\U03B2 = 50, \U03C1 = 0.5)")

acc_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_3d_5ae/fixed_beta_fixed_rho/beta50_rho_0_5/acc.png"
combined_acc_plot
ggsave(filename = acc_plot_file, plot = combined_acc_plot)
```

```{r b_50_rho_0_7}
conf_thresh <- as.factor(rep(c(0.4,0.5,0.6,0.7), 3))
prr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
rr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
ror_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
p <- as.factor(c(rep(0.1,4), rep(0.3,4), rep(0.5,4)))
#corr <- as.factor(c(rep(0,4), rep(0.3,4), rep(-0.3,4), rep(0.5,4), rep(-0.5,4), rep(0.7,4), rep(-0.7,4)))

#sensitivity plots
#confidence thresholds
mean_sens_conf <- as.numeric(c(conf_results_beta50_dep_0_7_p_0_1[1,], conf_results_beta50_dep_0_7_p_0_3[1,], conf_results_beta50_dep_0_7_p_0_5[1,]))

#prr thresholds
mean_sens_prr <- as.numeric(c(prr_results_beta50_dep_0_7_p_0_1[1,], prr_results_beta50_dep_0_7_p_0_3[1,], prr_results_beta50_dep_0_7_p_0_5[1,]))

#rr thresholds
mean_sens_rr <- as.numeric(c(rr_results_beta50_dep_0_7_p_0_1[1,], rr_results_beta50_dep_0_7_p_0_3[1,], rr_results_beta50_dep_0_7_p_0_5[1,]))

#ror thresholds
mean_sens_ror <- as.numeric(c(ror_results_beta50_dep_0_7_p_0_1[1,], ror_results_beta50_dep_0_7_p_0_3[1,], ror_results_beta50_dep_0_7_p_0_5[1,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=p, group=p)) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=p)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Sensitivity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_sens_prr, color=p, group=p)) + 
  geom_point(aes(x=prr_thresh, y=mean_sens_prr, color=p)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Sensitivity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_sens_rr, color=p, group=p)) + 
  geom_point(aes(x=rr_thresh, y=mean_sens_rr, color=p)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Sensitivity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_sens_ror, color=p, group=p)) + 
  geom_point(aes(x=ror_thresh, y=mean_sens_ror, color=p)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Sensitivity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, group=p, color=p)) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=p)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99"), name="p") +
  labs(y="Mean Sensitivity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_sens_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Sensitivity plots for Setting 2 (\U03B2 = 50, \U03C1 = 0.7)")

sens_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_3d_5ae/fixed_beta_fixed_rho/beta50_rho_0_7/sens.png"
combined_sens_plot
ggsave(filename = sens_plot_file, plot = combined_sens_plot)

## specificity plots
#confidence thresholds
mean_spec_conf <- as.numeric(c(conf_results_beta50_dep_0_7_p_0_1[2,], conf_results_beta50_dep_0_7_p_0_3[2,], conf_results_beta50_dep_0_7_p_0_5[2,]))

#prr thresholds
mean_spec_prr <- as.numeric(c(prr_results_beta50_dep_0_7_p_0_1[2,], prr_results_beta50_dep_0_7_p_0_3[2,], prr_results_beta50_dep_0_7_p_0_5[2,]))

#rr thresholds
mean_spec_rr <- as.numeric(c(rr_results_beta50_dep_0_7_p_0_1[2,], rr_results_beta50_dep_0_7_p_0_3[2,], rr_results_beta50_dep_0_7_p_0_5[2,]))

#ror thresholds
mean_spec_ror <- as.numeric(c(ror_results_beta50_dep_0_7_p_0_1[2,], ror_results_beta50_dep_0_7_p_0_3[2,], ror_results_beta50_dep_0_7_p_0_5[2,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, group=p, color=p)) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=p)) + 
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Specificity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_spec_prr, group=p, color=p)) + 
  geom_point(aes(x=prr_thresh, y=mean_spec_prr, color=p)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Specificity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_spec_rr, group=p, color=p)) + 
  geom_point(aes(x=rr_thresh, y=mean_spec_rr, color=p)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Specificity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_spec_ror, group=p, color=p)) + 
  geom_point(aes(x=ror_thresh, y=mean_spec_ror, color=p)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Specificity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, group=p, color=p)) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=p)) + 
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99"), name="p") +
  labs(y="Mean Specificity", x="Confidence thresholds") + 
  scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

combined_spec_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Specificity plots for Setting 2 (\U03B2 = 50, \U03C1 = 0.7)")
spec_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_3d_5ae/fixed_beta_fixed_rho/beta50_rho_0_7/spec.png"
combined_spec_plot
ggsave(filename = spec_plot_file, plot = combined_spec_plot)

## overall accuracy plots
#confidence thresholds
mean_acc_conf <- as.numeric(c(conf_results_beta50_dep_0_7_p_0_1[5,], conf_results_beta50_dep_0_7_p_0_3[5,], conf_results_beta50_dep_0_7_p_0_5[5,]))

#prr thresholds
mean_acc_prr <- as.numeric(c(prr_results_beta50_dep_0_7_p_0_1[5,], prr_results_beta50_dep_0_7_p_0_3[5,], prr_results_beta50_dep_0_7_p_0_5[5,]))

#rr thresholds
mean_acc_rr <- as.numeric(c(rr_results_beta50_dep_0_7_p_0_1[5,], rr_results_beta50_dep_0_7_p_0_3[5,], rr_results_beta50_dep_0_7_p_0_5[5,]))

#ror thresholds
mean_acc_ror <- as.numeric(c(ror_results_beta50_dep_0_7_p_0_1[5,], ror_results_beta50_dep_0_7_p_0_3[5,], ror_results_beta50_dep_0_7_p_0_5[5,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, group=p, color=p)) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=p)) + 
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_acc_prr, group=p, color=p)) + 
  geom_point(aes(x=prr_thresh, y=mean_acc_prr, color=p)) +
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Overall Accuracy", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_acc_rr, group=p, color=p)) + 
  geom_point(aes(x=rr_thresh, y=mean_acc_rr, color=p)) +
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Overall Accuracy", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_acc_ror, group=p, color=p)) + 
  geom_point(aes(x=ror_thresh, y=mean_acc_ror, color=p)) +
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99")) +
  labs(y="Mean Overall Accuracy", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, group=p, color=p)) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=p)) + 
  ylim(0.7,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  scale_color_manual(values = c("#1f78b4","#b2df8a","#fb9a99"), name="p") +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") + 
  scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_acc_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Overall Accuracy plots for Setting 2 (\U03B2 = 50, \U03C1 = 0.7)")

acc_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_3d_5ae/fixed_beta_fixed_rho/beta50_rho_0_7/acc.png"
combined_acc_plot
ggsave(filename = acc_plot_file, plot = combined_acc_plot)
```

## fixed beta, fixed p, and fixed rho

```{r b_1_rho_0_3_p_0_1}
conf_thresh <- as.factor(rep(c(0.4,0.5,0.6,0.7), 3))
prr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
rr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
ror_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
#p <- as.factor(c(rep(0.1,4), rep(0.3,4), rep(0.5,4)))
sgn <- as.factor(c(rep(0,4), rep("+",4), rep("-",4)))
#corr <- as.factor(c(rep(0,4), rep(0.3,4), rep(-0.3,4), rep(0.5,4), rep(-0.5,4), rep(0.7,4), rep(-0.7,4)))

#sensitivity plots
#confidence thresholds
mean_sens_conf <- as.numeric(c(conf_results_beta1_p_0_1[1,], conf_results_beta1_dep_0_3_p_0_1[1,], conf_results_beta1_dep_neg0_3_p_0_1[1,]))

#prr thresholds
mean_sens_prr <- as.numeric(c(prr_results_beta1_p_0_1[1,], prr_results_beta1_dep_0_3_p_0_1[1,], prr_results_beta1_dep_neg0_3_p_0_1[1,]))

#rr thresholds
mean_sens_rr <- as.numeric(c(rr_results_beta1_p_0_1[1,], rr_results_beta1_dep_0_3_p_0_1[1,], rr_results_beta1_dep_neg0_3_p_0_1[1,]))

#ror thresholds
mean_sens_ror <- as.numeric(c(ror_results_beta1_p_0_1[1,], ror_results_beta1_dep_0_3_p_0_1[1,], ror_results_beta1_dep_neg0_3_p_0_1[1,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_sens_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=prr_thresh, y=mean_sens_prr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_sens_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=rr_thresh, y=mean_sens_rr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_sens_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=ror_thresh, y=mean_sens_ror, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid"), name="direction") +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Mean Sensitivity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_sens_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Sensitivity plots for Setting 3 (\U03B2 = 1, p = 0.1, |\U03C1| = 0.3)")

sens_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta1_p_0_1_rho_0_3/sens.png"
combined_sens_plot
ggsave(filename = sens_plot_file, plot = combined_sens_plot)

## specificity plots
#confidence thresholds
mean_spec_conf <- as.numeric(c(conf_results_beta1_p_0_1[2,], conf_results_beta1_dep_0_3_p_0_1[2,], conf_results_beta1_dep_neg0_3_p_0_1[2,]))

#prr thresholds
mean_spec_prr <- as.numeric(c(prr_results_beta1_p_0_1[2,], prr_results_beta1_dep_0_3_p_0_1[2,], prr_results_beta1_dep_neg0_3_p_0_1[2,]))

#rr thresholds
mean_spec_rr <- as.numeric(c(rr_results_beta1_p_0_1[2,], rr_results_beta1_dep_0_3_p_0_1[2,], rr_results_beta1_dep_neg0_3_p_0_1[2,]))

#ror thresholds
mean_spec_ror <- as.numeric(c(ror_results_beta1_p_0_1[2,], ror_results_beta1_dep_0_3_p_0_1[2,], ror_results_beta1_dep_neg0_3_p_0_1[2,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=sgn)) + 
  ylim(0.6,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_spec_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=prr_thresh, y=mean_spec_prr, color=sgn)) +
  ylim(0.6,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_spec_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=rr_thresh, y=mean_spec_rr, color=sgn)) +
  ylim(0.6,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_spec_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=ror_thresh, y=mean_spec_ror, color=sgn)) +
  ylim(0.6,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=sgn)) + 
  ylim(0.6,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid"), name="direction") +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Mean Specificity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

combined_spec_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Specificity plots for Setting 3 (\U03B2 = 1, p = 0.1, |\U03C1| = 0.3)")
spec_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta1_p_0_1_rho_0_3/spec.png"
combined_spec_plot
ggsave(filename = spec_plot_file, plot = combined_spec_plot)

## overall accuracy plots
#confidence thresholds
mean_acc_conf <- as.numeric(c(conf_results_beta1_p_0_1[5,], conf_results_beta1_dep_0_3_p_0_1[5,],  conf_results_beta1_dep_neg0_3_p_0_1[5,]))

#prr thresholds
mean_acc_prr <- as.numeric(c(prr_results_beta1_p_0_1[5,], prr_results_beta1_dep_0_3_p_0_1[5,], prr_results_beta1_dep_neg0_3_p_0_1[5,]))

#rr thresholds
mean_acc_rr <- as.numeric(c(rr_results_beta1_p_0_1[5,], rr_results_beta1_dep_0_3_p_0_1[5,], rr_results_beta1_dep_neg0_3_p_0_1[5,]))

#ror thresholds
mean_acc_ror <- as.numeric(c(ror_results_beta1_p_0_1[5,], ror_results_beta1_dep_0_3_p_0_1[5,], ror_results_beta1_dep_neg0_3_p_0_1[5,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_acc_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=prr_thresh, y=mean_acc_prr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_acc_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=rr_thresh, y=mean_acc_rr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_acc_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=ror_thresh, y=mean_acc_ror, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid"), name="direction") +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_acc_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Overall Accuracy plots for Setting 3 (\U03B2 = 1, p = 0.1, |\U03C1| = 0.3)")

acc_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta1_p_0_1_rho_0_3/acc.png"
combined_acc_plot
ggsave(filename = acc_plot_file, plot = combined_acc_plot)

# roc plots
g1 <- ggplot() + 
  geom_line(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn)) + 
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("Confidence") +
  ylim(0,1) +
  xlim(0,0.25) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=(1-mean_spec_prr), y=mean_sens_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=(1-mean_spec_prr), y=mean_sens_prr, color=sgn)) +
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("PRR") +
  ylim(0,1) +
  xlim(0,0.25) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=(1-mean_spec_rr), y=mean_sens_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=(1-mean_spec_rr), y=mean_sens_rr, color=sgn)) +
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("RR") +
  ylim(0,1) +
  xlim(0,0.25) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=(1-mean_spec_ror), y=mean_sens_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=(1-mean_spec_ror), y=mean_sens_ror, color=sgn)) +
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("ROR") +
  ylim(0,1) +
  xlim(0,0.25) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn)) + 
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("Confidence") +
  ylim(0,1) +
  xlim(0,0.25) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "bottom", title=element_text(size=8), axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_roc_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Sensitivity versus Specificity trade-off plots for Setting 3 (\U03B2 = 1, p = 0.1, |\U03C1| = 0.3)")

roc_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta1_p_0_1_rho_0_3/roc.png"
combined_roc_plot
ggsave(filename = roc_plot_file, plot = combined_roc_plot)
```

```{r b_1_rho_0_3_p_0_3}
conf_thresh <- as.factor(rep(c(0.4,0.5,0.6,0.7), 3))
prr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
rr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
ror_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
#p <- as.factor(c(rep(0.1,4), rep(0.3,4), rep(0.5,4)))
sgn <- as.factor(c(rep(0,4), rep("+",4), rep("-",4)))
#corr <- as.factor(c(rep(0,4), rep(0.3,4), rep(-0.3,4), rep(0.5,4), rep(-0.5,4), rep(0.7,4), rep(-0.7,4)))

#sensitivity plots
#confidence thresholds
mean_sens_conf <- as.numeric(c(conf_results_beta1_p_0_3[1,], conf_results_beta1_dep_0_3_p_0_3[1,], conf_results_beta1_dep_neg0_3_p_0_3[1,]))

#prr thresholds
mean_sens_prr <- as.numeric(c(prr_results_beta1_p_0_3[1,], prr_results_beta1_dep_0_3_p_0_3[1,], prr_results_beta1_dep_neg0_3_p_0_3[1,]))

#rr thresholds
mean_sens_rr <- as.numeric(c(rr_results_beta1_p_0_3[1,], rr_results_beta1_dep_0_3_p_0_3[1,], rr_results_beta1_dep_neg0_3_p_0_3[1,]))

#ror thresholds
mean_sens_ror <- as.numeric(c(ror_results_beta1_p_0_3[1,], ror_results_beta1_dep_0_3_p_0_3[1,], ror_results_beta1_dep_neg0_3_p_0_3[1,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_sens_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=prr_thresh, y=mean_sens_prr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_sens_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=rr_thresh, y=mean_sens_rr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_sens_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=ror_thresh, y=mean_sens_ror, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid"), name="direction") +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Mean Sensitivity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_sens_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Sensitivity plots for Setting 3 (\U03B2 = 1, p = 0.3, |\U03C1| = 0.3)")

sens_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta1_p_0_3_rho_0_3/sens.png"
combined_sens_plot
ggsave(filename = sens_plot_file, plot = combined_sens_plot)

## specificity plots
#confidence thresholds
mean_spec_conf <- as.numeric(c(conf_results_beta1_p_0_3[2,], conf_results_beta1_dep_0_3_p_0_3[2,], conf_results_beta1_dep_neg0_3_p_0_3[2,]))

#prr thresholds
mean_spec_prr <- as.numeric(c(prr_results_beta1_p_0_3[2,], prr_results_beta1_dep_0_3_p_0_3[2,], prr_results_beta1_dep_neg0_3_p_0_3[2,]))

#rr thresholds
mean_spec_rr <- as.numeric(c(rr_results_beta1_p_0_3[2,], rr_results_beta1_dep_0_3_p_0_3[2,], rr_results_beta1_dep_neg0_3_p_0_3[2,]))

#ror thresholds
mean_spec_ror <- as.numeric(c(ror_results_beta1_p_0_3[2,], ror_results_beta1_dep_0_3_p_0_3[2,], ror_results_beta1_dep_neg0_3_p_0_3[2,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=sgn)) + 
  ylim(0.4,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_spec_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=prr_thresh, y=mean_spec_prr, color=sgn)) +
  ylim(0.4,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_spec_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=rr_thresh, y=mean_spec_rr, color=sgn)) +
  ylim(0.4,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_spec_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=ror_thresh, y=mean_spec_ror, color=sgn)) +
  ylim(0.4,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=sgn)) + 
  ylim(0.4,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid"), name="direction") +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Mean Specificity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

combined_spec_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Specificity plots for Setting 3 (\U03B2 = 1, p = 0.3, |\U03C1| = 0.3)")
spec_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta1_p_0_3_rho_0_3/spec.png"
combined_spec_plot
ggsave(filename = spec_plot_file, plot = combined_spec_plot)

## overall accuracy plots
#confidence thresholds
mean_acc_conf <- as.numeric(c(conf_results_beta1_p_0_3[5,], conf_results_beta1_dep_0_3_p_0_3[5,],  conf_results_beta1_dep_neg0_3_p_0_3[5,]))

#prr thresholds
mean_acc_prr <- as.numeric(c(prr_results_beta1_p_0_3[5,], prr_results_beta1_dep_0_3_p_0_3[5,], prr_results_beta1_dep_neg0_3_p_0_3[5,]))

#rr thresholds
mean_acc_rr <- as.numeric(c(rr_results_beta1_p_0_3[5,], rr_results_beta1_dep_0_3_p_0_3[5,], rr_results_beta1_dep_neg0_3_p_0_3[5,]))

#ror thresholds
mean_acc_ror <- as.numeric(c(ror_results_beta1_p_0_3[5,], ror_results_beta1_dep_0_3_p_0_3[5,], ror_results_beta1_dep_neg0_3_p_0_3[5,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_acc_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=prr_thresh, y=mean_acc_prr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_acc_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=rr_thresh, y=mean_acc_rr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_acc_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=ror_thresh, y=mean_acc_ror, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid"), name="direction") +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_acc_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Overall Accuracy plots for Setting 3 (\U03B2 = 1, p = 0.3, |\U03C1| = 0.3)")

acc_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta1_p_0_3_rho_0_3/acc.png"
combined_acc_plot
ggsave(filename = acc_plot_file, plot = combined_acc_plot)

# roc plots
g1 <- ggplot() + 
  geom_line(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn)) + 
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("Confidence") +
  ylim(0,1) +
  xlim(0,0.3) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=(1-mean_spec_prr), y=mean_sens_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=(1-mean_spec_prr), y=mean_sens_prr, color=sgn)) +
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("PRR") +
  ylim(0,1) +
  xlim(0,0.3) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=(1-mean_spec_rr), y=mean_sens_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=(1-mean_spec_rr), y=mean_sens_rr, color=sgn)) +
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("RR") +
  ylim(0,1) +
  xlim(0,0.3) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=(1-mean_spec_ror), y=mean_sens_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=(1-mean_spec_ror), y=mean_sens_ror, color=sgn)) +
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("ROR") +
  ylim(0,1) +
  xlim(0,0.3) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn)) + 
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("Confidence") +
  ylim(0,1) +
  xlim(0,0.3) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "bottom", title=element_text(size=10, face='bold'), axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_roc_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Sensitivity versus Specificity trade-off plots for Setting 3 (\U03B2 = 1, p = 0.3, |\U03C1| = 0.3)")

roc_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta1_p_0_3_rho_0_3/roc.png"
combined_roc_plot
ggsave(filename = roc_plot_file, plot = combined_roc_plot)
```

```{r b_1_rho_0_3_p_0_5}
conf_thresh <- as.factor(rep(c(0.4,0.5,0.6,0.7), 3))
prr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
rr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
ror_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
#p <- as.factor(c(rep(0.1,4), rep(0.3,4), rep(0.5,4)))
sgn <- as.factor(c(rep(0,4), rep("+",4), rep("-",4)))
#corr <- as.factor(c(rep(0,4), rep(0.3,4), rep(-0.3,4), rep(0.5,4), rep(-0.5,4), rep(0.7,4), rep(-0.7,4)))

#sensitivity plots
#confidence thresholds
mean_sens_conf <- as.numeric(c(conf_results_beta1_p_0_5[1,], conf_results_beta1_dep_0_3_p_0_5[1,], conf_results_beta1_dep_neg0_3_p_0_5[1,]))

#prr thresholds
mean_sens_prr <- as.numeric(c(prr_results_beta1_p_0_5[1,], prr_results_beta1_dep_0_3_p_0_5[1,], prr_results_beta1_dep_neg0_3_p_0_5[1,]))

#rr thresholds
mean_sens_rr <- as.numeric(c(rr_results_beta1_p_0_5[1,], rr_results_beta1_dep_0_3_p_0_5[1,], rr_results_beta1_dep_neg0_3_p_0_5[1,]))

#ror thresholds
mean_sens_ror <- as.numeric(c(ror_results_beta1_p_0_5[1,], ror_results_beta1_dep_0_3_p_0_5[1,], ror_results_beta1_dep_neg0_3_p_0_5[1,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_sens_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=prr_thresh, y=mean_sens_prr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_sens_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=rr_thresh, y=mean_sens_rr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_sens_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=ror_thresh, y=mean_sens_ror, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid"), name="direction") +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Mean Sensitivity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_sens_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Sensitivity plots for Setting 3 (\U03B2 = 1, p = 0.5, |\U03C1| = 0.3)")

sens_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta1_p_0_5_rho_0_3/sens.png"
combined_sens_plot
ggsave(filename = sens_plot_file, plot = combined_sens_plot)

## specificity plots
#confidence thresholds
mean_spec_conf <- as.numeric(c(conf_results_beta1_p_0_5[2,], conf_results_beta1_dep_0_3_p_0_5[2,], conf_results_beta1_dep_neg0_3_p_0_5[2,]))

#prr thresholds
mean_spec_prr <- as.numeric(c(prr_results_beta1_p_0_5[2,], prr_results_beta1_dep_0_3_p_0_5[2,], prr_results_beta1_dep_neg0_3_p_0_5[2,]))

#rr thresholds
mean_spec_rr <- as.numeric(c(rr_results_beta1_p_0_5[2,], rr_results_beta1_dep_0_3_p_0_5[2,], rr_results_beta1_dep_neg0_3_p_0_5[2,]))

#ror thresholds
mean_spec_ror <- as.numeric(c(ror_results_beta1_p_0_5[2,], ror_results_beta1_dep_0_3_p_0_5[2,], ror_results_beta1_dep_neg0_3_p_0_5[2,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=sgn)) + 
  ylim(0.6,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_spec_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=prr_thresh, y=mean_spec_prr, color=sgn)) +
  ylim(0.6,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_spec_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=rr_thresh, y=mean_spec_rr, color=sgn)) +
  ylim(0.6,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_spec_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=ror_thresh, y=mean_spec_ror, color=sgn)) +
  ylim(0.6,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=sgn)) + 
  ylim(0.6,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid"), name="direction") +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Mean Specificity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

combined_spec_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Specificity plots for Setting 3 (\U03B2 = 1, p = 0.5, |\U03C1| = 0.3)")
spec_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta1_p_0_5_rho_0_3/spec.png"
combined_spec_plot
ggsave(filename = spec_plot_file, plot = combined_spec_plot)

## overall accuracy plots
#confidence thresholds
mean_acc_conf <- as.numeric(c(conf_results_beta1_p_0_5[5,], conf_results_beta1_dep_0_3_p_0_5[5,],  conf_results_beta1_dep_neg0_3_p_0_5[5,]))

#prr thresholds
mean_acc_prr <- as.numeric(c(prr_results_beta1_p_0_5[5,], prr_results_beta1_dep_0_3_p_0_5[5,], prr_results_beta1_dep_neg0_3_p_0_5[5,]))

#rr thresholds
mean_acc_rr <- as.numeric(c(rr_results_beta1_p_0_5[5,], rr_results_beta1_dep_0_3_p_0_5[5,], rr_results_beta1_dep_neg0_3_p_0_5[5,]))

#ror thresholds
mean_acc_ror <- as.numeric(c(ror_results_beta1_p_0_5[5,], ror_results_beta1_dep_0_3_p_0_5[5,], ror_results_beta1_dep_neg0_3_p_0_5[5,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_acc_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=prr_thresh, y=mean_acc_prr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_acc_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=rr_thresh, y=mean_acc_rr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_acc_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=ror_thresh, y=mean_acc_ror, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid"), name="direction") +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_acc_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Overall Accuracy plots for Setting 3 (\U03B2 = 1, p = 0.5, |\U03C1| = 0.3)")

acc_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta1_p_0_5_rho_0_3/acc.png"
combined_acc_plot
ggsave(filename = acc_plot_file, plot = combined_acc_plot)

# roc plots
g1 <- ggplot() + 
  geom_line(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn)) + 
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("Confidence") +
  ylim(0,1) +
  xlim(0,0.4) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=(1-mean_spec_prr), y=mean_sens_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=(1-mean_spec_prr), y=mean_sens_prr, color=sgn)) +
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("PRR") +
  ylim(0,1) +
  xlim(0,0.4) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=(1-mean_spec_rr), y=mean_sens_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=(1-mean_spec_rr), y=mean_sens_rr, color=sgn)) +
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("RR") +
  ylim(0,1) +
  xlim(0,0.4) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=(1-mean_spec_ror), y=mean_sens_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=(1-mean_spec_ror), y=mean_sens_ror, color=sgn)) +
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("ROR") +
  ylim(0,1) +
  xlim(0,0.4) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn)) + 
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("Confidence") +
  ylim(0,1) +
  xlim(0,0.4) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "bottom", title=element_text(size=8), axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_roc_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Sensitivity versus Specificity trade-off plots for Setting 3 (\U03B2 = 1, p = 0.5, |\U03C1| = 0.3)")

roc_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta1_p_0_5_rho_0_3/roc.png"
combined_roc_plot
ggsave(filename = roc_plot_file, plot = combined_roc_plot)
```

```{r b_1_rho_0_5_p_0_1}
conf_thresh <- as.factor(rep(c(0.4,0.5,0.6,0.7), 3))
prr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
rr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
ror_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
#p <- as.factor(c(rep(0.1,4), rep(0.3,4), rep(0.5,4)))
sgn <- as.factor(c(rep(0,4), rep("+",4), rep("-",4)))
#corr <- as.factor(c(rep(0,4), rep(0.3,4), rep(-0.3,4), rep(0.5,4), rep(-0.5,4), rep(0.7,4), rep(-0.7,4)))

#sensitivity plots
#confidence thresholds
mean_sens_conf <- as.numeric(c(conf_results_beta1_p_0_1[1,], conf_results_beta1_dep_0_5_p_0_1[1,], conf_results_beta1_dep_neg0_5_p_0_1[1,]))

#prr thresholds
mean_sens_prr <- as.numeric(c(prr_results_beta1_p_0_1[1,], prr_results_beta1_dep_0_5_p_0_1[1,], prr_results_beta1_dep_neg0_5_p_0_1[1,]))

#rr thresholds
mean_sens_rr <- as.numeric(c(rr_results_beta1_p_0_1[1,], rr_results_beta1_dep_0_5_p_0_1[1,], rr_results_beta1_dep_neg0_5_p_0_1[1,]))

#ror thresholds
mean_sens_ror <- as.numeric(c(ror_results_beta1_p_0_1[1,], ror_results_beta1_dep_0_5_p_0_1[1,], ror_results_beta1_dep_neg0_5_p_0_1[1,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_sens_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=prr_thresh, y=mean_sens_prr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_sens_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=rr_thresh, y=mean_sens_rr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_sens_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=ror_thresh, y=mean_sens_ror, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid"), name="direction") +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Mean Sensitivity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_sens_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Sensitivity plots for Setting 3 (\U03B2 = 1, p = 0.1, |\U03C1| = 0.5)")

sens_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta1_p_0_1_rho_0_5/sens.png"
combined_sens_plot
ggsave(filename = sens_plot_file, plot = combined_sens_plot)

## specificity plots
#confidence thresholds
mean_spec_conf <- as.numeric(c(conf_results_beta1_p_0_1[2,], conf_results_beta1_dep_0_5_p_0_1[2,], conf_results_beta1_dep_neg0_5_p_0_1[2,]))

#prr thresholds
mean_spec_prr <- as.numeric(c(prr_results_beta1_p_0_1[2,], prr_results_beta1_dep_0_5_p_0_1[2,], prr_results_beta1_dep_neg0_5_p_0_1[2,]))

#rr thresholds
mean_spec_rr <- as.numeric(c(rr_results_beta1_p_0_1[2,], rr_results_beta1_dep_0_5_p_0_1[2,], rr_results_beta1_dep_neg0_5_p_0_1[2,]))

#ror thresholds
mean_spec_ror <- as.numeric(c(ror_results_beta1_p_0_1[2,], ror_results_beta1_dep_0_5_p_0_1[2,], ror_results_beta1_dep_neg0_5_p_0_1[2,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=sgn)) + 
  ylim(0.6,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_spec_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=prr_thresh, y=mean_spec_prr, color=sgn)) +
  ylim(0.6,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_spec_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=rr_thresh, y=mean_spec_rr, color=sgn)) +
  ylim(0.6,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_spec_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=ror_thresh, y=mean_spec_ror, color=sgn)) +
  ylim(0.6,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=sgn)) + 
  ylim(0.6,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid"), name="direction") +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Mean Specificity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

combined_spec_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Specificity plots for Setting 3 (\U03B2 = 1, p = 0.1, |\U03C1| = 0.5)")
spec_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta1_p_0_1_rho_0_5/spec.png"
combined_spec_plot
ggsave(filename = spec_plot_file, plot = combined_spec_plot)

## overall accuracy plots
#confidence thresholds
mean_acc_conf <- as.numeric(c(conf_results_beta1_p_0_1[5,], conf_results_beta1_dep_0_5_p_0_1[5,],  conf_results_beta1_dep_neg0_5_p_0_1[5,]))

#prr thresholds
mean_acc_prr <- as.numeric(c(prr_results_beta1_p_0_1[5,], prr_results_beta1_dep_0_5_p_0_1[5,], prr_results_beta1_dep_neg0_5_p_0_1[5,]))

#rr thresholds
mean_acc_rr <- as.numeric(c(rr_results_beta1_p_0_1[5,], rr_results_beta1_dep_0_5_p_0_1[5,], rr_results_beta1_dep_neg0_5_p_0_1[5,]))

#ror thresholds
mean_acc_ror <- as.numeric(c(ror_results_beta1_p_0_1[5,], ror_results_beta1_dep_0_5_p_0_1[5,], ror_results_beta1_dep_neg0_5_p_0_1[5,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_acc_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=prr_thresh, y=mean_acc_prr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_acc_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=rr_thresh, y=mean_acc_rr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_acc_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=ror_thresh, y=mean_acc_ror, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid"), name="direction") +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_acc_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Overall Accuracy plots for Setting 3 (\U03B2 = 1, p = 0.1, |\U03C1| = 0.5)")

acc_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta1_p_0_1_rho_0_5/acc.png"
combined_acc_plot
ggsave(filename = acc_plot_file, plot = combined_acc_plot)

# roc plots
g1 <- ggplot() + 
  geom_line(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn)) + 
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("Confidence") +
  ylim(0,1) +
  xlim(0,0.3) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=(1-mean_spec_prr), y=mean_sens_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=(1-mean_spec_prr), y=mean_sens_prr, color=sgn)) +
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("PRR") +
  ylim(0,1) +
  xlim(0,0.3) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=(1-mean_spec_rr), y=mean_sens_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=(1-mean_spec_rr), y=mean_sens_rr, color=sgn)) +
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("RR") +
  ylim(0,1) +
  xlim(0,0.3) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=(1-mean_spec_ror), y=mean_sens_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=(1-mean_spec_ror), y=mean_sens_ror, color=sgn)) +
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("ROR") +
  ylim(0,1) +
  xlim(0,0.3) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn)) + 
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("Confidence") +
  ylim(0,1) +
  xlim(0,0.3) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "bottom", title=element_text(size=8), axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_roc_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Sensitivity versus Specificity trade-off plots for Setting 3 (\U03B2 = 1, p = 0.1, |\U03C1| = 0.5)")

roc_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta1_p_0_1_rho_0_5/roc.png"
combined_roc_plot
ggsave(filename = roc_plot_file, plot = combined_roc_plot)
```

```{r b_1_rho_0_5_p_0_3}
conf_thresh <- as.factor(rep(c(0.4,0.5,0.6,0.7), 3))
prr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
rr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
ror_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
#p <- as.factor(c(rep(0.1,4), rep(0.3,4), rep(0.5,4)))
sgn <- as.factor(c(rep(0,4), rep("+",4), rep("-",4)))
#corr <- as.factor(c(rep(0,4), rep(0.3,4), rep(-0.3,4), rep(0.5,4), rep(-0.5,4), rep(0.7,4), rep(-0.7,4)))

#sensitivity plots
#confidence thresholds
mean_sens_conf <- as.numeric(c(conf_results_beta1_p_0_3[1,], conf_results_beta1_dep_0_5_p_0_3[1,], conf_results_beta1_dep_neg0_5_p_0_3[1,]))

#prr thresholds
mean_sens_prr <- as.numeric(c(prr_results_beta1_p_0_3[1,], prr_results_beta1_dep_0_5_p_0_3[1,], prr_results_beta1_dep_neg0_5_p_0_3[1,]))

#rr thresholds
mean_sens_rr <- as.numeric(c(rr_results_beta1_p_0_3[1,], rr_results_beta1_dep_0_5_p_0_3[1,], rr_results_beta1_dep_neg0_5_p_0_3[1,]))

#ror thresholds
mean_sens_ror <- as.numeric(c(ror_results_beta1_p_0_3[1,], ror_results_beta1_dep_0_5_p_0_3[1,], ror_results_beta1_dep_neg0_5_p_0_3[1,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_sens_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=prr_thresh, y=mean_sens_prr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_sens_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=rr_thresh, y=mean_sens_rr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_sens_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=ror_thresh, y=mean_sens_ror, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid"), name="direction") +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Mean Sensitivity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_sens_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Sensitivity plots for Setting 3 (\U03B2 = 1, p = 0.3, |\U03C1| = 0.5)")

sens_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta1_p_0_3_rho_0_5/sens.png"
combined_sens_plot
ggsave(filename = sens_plot_file, plot = combined_sens_plot)

## specificity plots
#confidence thresholds
mean_spec_conf <- as.numeric(c(conf_results_beta1_p_0_3[2,], conf_results_beta1_dep_0_5_p_0_3[2,], conf_results_beta1_dep_neg0_5_p_0_3[2,]))

#prr thresholds
mean_spec_prr <- as.numeric(c(prr_results_beta1_p_0_3[2,], prr_results_beta1_dep_0_5_p_0_3[2,], prr_results_beta1_dep_neg0_5_p_0_3[2,]))

#rr thresholds
mean_spec_rr <- as.numeric(c(rr_results_beta1_p_0_3[2,], rr_results_beta1_dep_0_5_p_0_3[2,], rr_results_beta1_dep_neg0_5_p_0_3[2,]))

#ror thresholds
mean_spec_ror <- as.numeric(c(ror_results_beta1_p_0_3[2,], ror_results_beta1_dep_0_5_p_0_3[2,], ror_results_beta1_dep_neg0_5_p_0_3[2,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=sgn)) + 
  ylim(0.4,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_spec_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=prr_thresh, y=mean_spec_prr, color=sgn)) +
  ylim(0.4,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_spec_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=rr_thresh, y=mean_spec_rr, color=sgn)) +
  ylim(0.4,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_spec_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=ror_thresh, y=mean_spec_ror, color=sgn)) +
  ylim(0.4,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=sgn)) + 
  ylim(0.4,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid"), name="direction") +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Mean Specificity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

combined_spec_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Specificity plots for Setting 3 (\U03B2 = 1, p = 0.3, |\U03C1| = 0.5)")
spec_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta1_p_0_3_rho_0_5/spec.png"
combined_spec_plot
ggsave(filename = spec_plot_file, plot = combined_spec_plot)

## overall accuracy plots
#confidence thresholds
mean_acc_conf <- as.numeric(c(conf_results_beta1_p_0_3[5,], conf_results_beta1_dep_0_5_p_0_3[5,],  conf_results_beta1_dep_neg0_5_p_0_3[5,]))

#prr thresholds
mean_acc_prr <- as.numeric(c(prr_results_beta1_p_0_3[5,], prr_results_beta1_dep_0_5_p_0_3[5,], prr_results_beta1_dep_neg0_5_p_0_3[5,]))

#rr thresholds
mean_acc_rr <- as.numeric(c(rr_results_beta1_p_0_3[5,], rr_results_beta1_dep_0_5_p_0_3[5,], rr_results_beta1_dep_neg0_5_p_0_3[5,]))

#ror thresholds
mean_acc_ror <- as.numeric(c(ror_results_beta1_p_0_3[5,], ror_results_beta1_dep_0_5_p_0_3[5,], ror_results_beta1_dep_neg0_5_p_0_3[5,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_acc_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=prr_thresh, y=mean_acc_prr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_acc_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=rr_thresh, y=mean_acc_rr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_acc_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=ror_thresh, y=mean_acc_ror, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid"), name="direction") +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_acc_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Overall Accuracy plots for Setting 3 (\U03B2 = 1, p = 0.3, |\U03C1| = 0.5)")

acc_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta1_p_0_3_rho_0_5/acc.png"
combined_acc_plot
ggsave(filename = acc_plot_file, plot = combined_acc_plot)

# roc plots
g1 <- ggplot() + 
  geom_line(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn)) + 
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("Confidence") +
  ylim(0,1) +
  xlim(0,0.35) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=(1-mean_spec_prr), y=mean_sens_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=(1-mean_spec_prr), y=mean_sens_prr, color=sgn)) +
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("PRR") +
  ylim(0,1) +
  xlim(0,0.35) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=(1-mean_spec_rr), y=mean_sens_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=(1-mean_spec_rr), y=mean_sens_rr, color=sgn)) +
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("RR") +
  ylim(0,1) +
  xlim(0,0.35) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=(1-mean_spec_ror), y=mean_sens_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=(1-mean_spec_ror), y=mean_sens_ror, color=sgn)) +
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("ROR") +
  ylim(0,1) +
  xlim(0,0.35) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn)) + 
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("Confidence") +
  ylim(0,1) +
  xlim(0,0.35) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "bottom", title=element_text(size=8), axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_roc_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Sensitivity versus Specificity trade-off plots for Setting 3 (\U03B2 = 1, p = 0.3, |\U03C1| = 0.5)")

roc_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta1_p_0_3_rho_0_5/roc.png"
combined_roc_plot
ggsave(filename = roc_plot_file, plot = combined_roc_plot)
```

```{r b_1_rho_0_5_p_0_5}
conf_thresh <- as.factor(rep(c(0.4,0.5,0.6,0.7), 3))
prr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
rr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
ror_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
#p <- as.factor(c(rep(0.1,4), rep(0.3,4), rep(0.5,4)))
sgn <- as.factor(c(rep(0,4), rep("+",4), rep("-",4)))
#corr <- as.factor(c(rep(0,4), rep(0.3,4), rep(-0.3,4), rep(0.5,4), rep(-0.5,4), rep(0.7,4), rep(-0.7,4)))

#sensitivity plots
#confidence thresholds
mean_sens_conf <- as.numeric(c(conf_results_beta1_p_0_5[1,], conf_results_beta1_dep_0_5_p_0_5[1,], conf_results_beta1_dep_neg0_5_p_0_5[1,]))

#prr thresholds
mean_sens_prr <- as.numeric(c(prr_results_beta1_p_0_5[1,], prr_results_beta1_dep_0_5_p_0_5[1,], prr_results_beta1_dep_neg0_5_p_0_5[1,]))

#rr thresholds
mean_sens_rr <- as.numeric(c(rr_results_beta1_p_0_5[1,], rr_results_beta1_dep_0_5_p_0_5[1,], rr_results_beta1_dep_neg0_5_p_0_5[1,]))

#ror thresholds
mean_sens_ror <- as.numeric(c(ror_results_beta1_p_0_5[1,], ror_results_beta1_dep_0_5_p_0_5[1,], ror_results_beta1_dep_neg0_5_p_0_5[1,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_sens_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=prr_thresh, y=mean_sens_prr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_sens_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=rr_thresh, y=mean_sens_rr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_sens_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=ror_thresh, y=mean_sens_ror, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid"), name="direction") +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Mean Sensitivity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_sens_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Sensitivity plots for Setting 3 (\U03B2 = 1, p = 0.5, |\U03C1| = 0.5)")

sens_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta1_p_0_5_rho_0_5/sens.png"
combined_sens_plot
ggsave(filename = sens_plot_file, plot = combined_sens_plot)

## specificity plots
#confidence thresholds
mean_spec_conf <- as.numeric(c(conf_results_beta1_p_0_5[2,], conf_results_beta1_dep_0_5_p_0_5[2,], conf_results_beta1_dep_neg0_5_p_0_5[2,]))

#prr thresholds
mean_spec_prr <- as.numeric(c(prr_results_beta1_p_0_5[2,], prr_results_beta1_dep_0_5_p_0_5[2,], prr_results_beta1_dep_neg0_5_p_0_5[2,]))

#rr thresholds
mean_spec_rr <- as.numeric(c(rr_results_beta1_p_0_5[2,], rr_results_beta1_dep_0_5_p_0_5[2,], rr_results_beta1_dep_neg0_5_p_0_5[2,]))

#ror thresholds
mean_spec_ror <- as.numeric(c(ror_results_beta1_p_0_5[2,], ror_results_beta1_dep_0_5_p_0_5[2,], ror_results_beta1_dep_neg0_5_p_0_5[2,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=sgn)) + 
  ylim(0.6,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_spec_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=prr_thresh, y=mean_spec_prr, color=sgn)) +
  ylim(0.6,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_spec_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=rr_thresh, y=mean_spec_rr, color=sgn)) +
  ylim(0.6,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_spec_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=ror_thresh, y=mean_spec_ror, color=sgn)) +
  ylim(0.6,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=sgn)) + 
  ylim(0.6,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid"), name="direction") +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Mean Specificity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

combined_spec_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Specificity plots for Setting 3 (\U03B2 = 1, p = 0.5, |\U03C1| = 0.5)")
spec_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta1_p_0_5_rho_0_5/spec.png"
combined_spec_plot
ggsave(filename = spec_plot_file, plot = combined_spec_plot)

## overall accuracy plots
#confidence thresholds
mean_acc_conf <- as.numeric(c(conf_results_beta1_p_0_5[5,], conf_results_beta1_dep_0_5_p_0_5[5,],  conf_results_beta1_dep_neg0_5_p_0_5[5,]))

#prr thresholds
mean_acc_prr <- as.numeric(c(prr_results_beta1_p_0_5[5,], prr_results_beta1_dep_0_5_p_0_5[5,], prr_results_beta1_dep_neg0_5_p_0_5[5,]))

#rr thresholds
mean_acc_rr <- as.numeric(c(rr_results_beta1_p_0_5[5,], rr_results_beta1_dep_0_5_p_0_5[5,], rr_results_beta1_dep_neg0_5_p_0_5[5,]))

#ror thresholds
mean_acc_ror <- as.numeric(c(ror_results_beta1_p_0_5[5,], ror_results_beta1_dep_0_5_p_0_5[5,], ror_results_beta1_dep_neg0_5_p_0_5[5,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_acc_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=prr_thresh, y=mean_acc_prr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_acc_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=rr_thresh, y=mean_acc_rr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_acc_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=ror_thresh, y=mean_acc_ror, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid"), name="direction") +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_acc_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Overall Accuracy plots for Setting 3 (\U03B2 = 1, p = 0.5, |\U03C1| = 0.5)")

acc_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta1_p_0_5_rho_0_5/acc.png"
combined_acc_plot
ggsave(filename = acc_plot_file, plot = combined_acc_plot)

# roc plots
g1 <- ggplot() + 
  geom_line(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn)) + 
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("Confidence") +
  ylim(0,1) +
  xlim(0,0.4) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=(1-mean_spec_prr), y=mean_sens_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=(1-mean_spec_prr), y=mean_sens_prr, color=sgn)) +
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("PRR") +
  ylim(0,1) +
  xlim(0,0.4) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=(1-mean_spec_rr), y=mean_sens_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=(1-mean_spec_rr), y=mean_sens_rr, color=sgn)) +
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("RR") +
  ylim(0,1) +
  xlim(0,0.4) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=(1-mean_spec_ror), y=mean_sens_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=(1-mean_spec_ror), y=mean_sens_ror, color=sgn)) +
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("ROR") +
  ylim(0,1) +
  xlim(0,0.4) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn)) + 
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("Confidence") +
  ylim(0,1) +
  xlim(0,0.4) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "bottom", title=element_text(size=8), axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_roc_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Sensitivity versus Specificity trade-off plots for Setting 3 (\U03B2 = 1, p = 0.5, \U03C1 = 0.5)")

roc_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta1_p_0_5_rho_0_5/roc.png"
combined_roc_plot
ggsave(filename = roc_plot_file, plot = combined_roc_plot)
```

```{r b_1_rho_0_7_p_0_1}
conf_thresh <- as.factor(rep(c(0.4,0.5,0.6,0.7), 3))
prr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
rr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
ror_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
#p <- as.factor(c(rep(0.1,4), rep(0.3,4), rep(0.5,4)))
sgn <- as.factor(c(rep(0,4), rep("+",4), rep("-",4)))
#corr <- as.factor(c(rep(0,4), rep(0.3,4), rep(-0.3,4), rep(0.5,4), rep(-0.5,4), rep(0.7,4), rep(-0.7,4)))

#sensitivity plots
#confidence thresholds
mean_sens_conf <- as.numeric(c(conf_results_beta1_p_0_1[1,], conf_results_beta1_dep_0_7_p_0_1[1,], conf_results_beta1_dep_neg0_7_p_0_1[1,]))

#prr thresholds
mean_sens_prr <- as.numeric(c(prr_results_beta1_p_0_1[1,], prr_results_beta1_dep_0_7_p_0_1[1,], prr_results_beta1_dep_neg0_7_p_0_1[1,]))

#rr thresholds
mean_sens_rr <- as.numeric(c(rr_results_beta1_p_0_1[1,], rr_results_beta1_dep_0_7_p_0_1[1,], rr_results_beta1_dep_neg0_7_p_0_1[1,]))

#ror thresholds
mean_sens_ror <- as.numeric(c(ror_results_beta1_p_0_1[1,], ror_results_beta1_dep_0_7_p_0_1[1,], ror_results_beta1_dep_neg0_7_p_0_1[1,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_sens_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=prr_thresh, y=mean_sens_prr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_sens_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=rr_thresh, y=mean_sens_rr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_sens_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=ror_thresh, y=mean_sens_ror, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid"), name="direction") +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Mean Sensitivity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_sens_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Sensitivity plots for Setting 3 (\U03B2 = 1, p = 0.1, |\U03C1| = 0.7)")

sens_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta1_p_0_1_rho_0_7/sens.png"
combined_sens_plot
ggsave(filename = sens_plot_file, plot = combined_sens_plot)

## specificity plots
#confidence thresholds
mean_spec_conf <- as.numeric(c(conf_results_beta1_p_0_1[2,], conf_results_beta1_dep_0_7_p_0_1[2,], conf_results_beta1_dep_neg0_7_p_0_1[2,]))

#prr thresholds
mean_spec_prr <- as.numeric(c(prr_results_beta1_p_0_1[2,], prr_results_beta1_dep_0_7_p_0_1[2,], prr_results_beta1_dep_neg0_7_p_0_1[2,]))

#rr thresholds
mean_spec_rr <- as.numeric(c(rr_results_beta1_p_0_1[2,], rr_results_beta1_dep_0_7_p_0_1[2,], rr_results_beta1_dep_neg0_7_p_0_1[2,]))

#ror thresholds
mean_spec_ror <- as.numeric(c(ror_results_beta1_p_0_1[2,], ror_results_beta1_dep_0_7_p_0_1[2,], ror_results_beta1_dep_neg0_7_p_0_1[2,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=sgn)) + 
  ylim(0.6,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_spec_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=prr_thresh, y=mean_spec_prr, color=sgn)) +
  ylim(0.6,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_spec_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=rr_thresh, y=mean_spec_rr, color=sgn)) +
  ylim(0.6,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_spec_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=ror_thresh, y=mean_spec_ror, color=sgn)) +
  ylim(0.6,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=sgn)) + 
  ylim(0.6,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid"), name="direction") +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Mean Specificity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

combined_spec_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Specificity plots for Setting 3 (\U03B2 = 1, p = 0.1, |\U03C1| = 0.7)")
spec_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta1_p_0_1_rho_0_7/spec.png"
combined_spec_plot
ggsave(filename = spec_plot_file, plot = combined_spec_plot)

## overall accuracy plots
#confidence thresholds
mean_acc_conf <- as.numeric(c(conf_results_beta1_p_0_1[5,], conf_results_beta1_dep_0_7_p_0_1[5,],  conf_results_beta1_dep_neg0_7_p_0_1[5,]))

#prr thresholds
mean_acc_prr <- as.numeric(c(prr_results_beta1_p_0_1[5,], prr_results_beta1_dep_0_7_p_0_1[5,], prr_results_beta1_dep_neg0_7_p_0_1[5,]))

#rr thresholds
mean_acc_rr <- as.numeric(c(rr_results_beta1_p_0_1[5,], rr_results_beta1_dep_0_7_p_0_1[5,], rr_results_beta1_dep_neg0_7_p_0_1[5,]))

#ror thresholds
mean_acc_ror <- as.numeric(c(ror_results_beta1_p_0_1[5,], ror_results_beta1_dep_0_7_p_0_1[5,], ror_results_beta1_dep_neg0_7_p_0_1[5,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_acc_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=prr_thresh, y=mean_acc_prr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_acc_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=rr_thresh, y=mean_acc_rr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_acc_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=ror_thresh, y=mean_acc_ror, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid"), name="direction") +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_acc_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Overall Accuracy plots for Setting 3 (\U03B2 = 1, p = 0.1, |\U03C1| = 0.7)")

acc_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta1_p_0_1_rho_0_7/acc.png"
combined_acc_plot
ggsave(filename = acc_plot_file, plot = combined_acc_plot)

# roc plots
g1 <- ggplot() + 
  geom_line(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn)) + 
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("Confidence") +
  ylim(0,1) +
  xlim(0,0.3) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=(1-mean_spec_prr), y=mean_sens_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=(1-mean_spec_prr), y=mean_sens_prr, color=sgn)) +
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("PRR") +
  ylim(0,1) +
  xlim(0,0.3) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=(1-mean_spec_rr), y=mean_sens_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=(1-mean_spec_rr), y=mean_sens_rr, color=sgn)) +
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("RR") +
  ylim(0,1) +
  xlim(0,0.3) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=(1-mean_spec_ror), y=mean_sens_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=(1-mean_spec_ror), y=mean_sens_ror, color=sgn)) +
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("ROR") +
  ylim(0,1) +
  xlim(0,0.3) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn)) + 
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("Confidence") +
  ylim(0,1) +
  xlim(0,0.3) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "bottom", title=element_text(size=8), axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_roc_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Sensitivity versus Specificity trade-off plots for Setting 3 (\U03B2 = 1, p = 0.1, |\U03C1| = 0.7)")

roc_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta1_p_0_1_rho_0_7/roc.png"
combined_roc_plot
ggsave(filename = roc_plot_file, plot = combined_roc_plot)
```

```{r b_1_rho_0_7_p_0_3}
conf_thresh <- as.factor(rep(c(0.4,0.5,0.6,0.7), 3))
prr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
rr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
ror_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
#p <- as.factor(c(rep(0.1,4), rep(0.3,4), rep(0.5,4)))
sgn <- as.factor(c(rep(0,4), rep("+",4), rep("-",4)))
#corr <- as.factor(c(rep(0,4), rep(0.3,4), rep(-0.3,4), rep(0.5,4), rep(-0.5,4), rep(0.7,4), rep(-0.7,4)))

#sensitivity plots
#confidence thresholds
mean_sens_conf <- as.numeric(c(conf_results_beta1_p_0_3[1,], conf_results_beta1_dep_0_7_p_0_3[1,], conf_results_beta1_dep_neg0_7_p_0_3[1,]))

#prr thresholds
mean_sens_prr <- as.numeric(c(prr_results_beta1_p_0_3[1,], prr_results_beta1_dep_0_7_p_0_3[1,], prr_results_beta1_dep_neg0_7_p_0_3[1,]))

#rr thresholds
mean_sens_rr <- as.numeric(c(rr_results_beta1_p_0_3[1,], rr_results_beta1_dep_0_7_p_0_3[1,], rr_results_beta1_dep_neg0_7_p_0_3[1,]))

#ror thresholds
mean_sens_ror <- as.numeric(c(ror_results_beta1_p_0_3[1,], ror_results_beta1_dep_0_7_p_0_3[1,], ror_results_beta1_dep_neg0_7_p_0_3[1,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_sens_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=prr_thresh, y=mean_sens_prr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_sens_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=rr_thresh, y=mean_sens_rr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_sens_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=ror_thresh, y=mean_sens_ror, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid"), name="direction") +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Mean Sensitivity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_sens_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Sensitivity plots for Setting 3 (\U03B2 = 1, p = 0.3, |\U03C1| = 0.7)")

sens_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta1_p_0_3_rho_0_7/sens.png"
combined_sens_plot
ggsave(filename = sens_plot_file, plot = combined_sens_plot)

## specificity plots
#confidence thresholds
mean_spec_conf <- as.numeric(c(conf_results_beta1_p_0_3[2,], conf_results_beta1_dep_0_7_p_0_3[2,], conf_results_beta1_dep_neg0_7_p_0_3[2,]))

#prr thresholds
mean_spec_prr <- as.numeric(c(prr_results_beta1_p_0_3[2,], prr_results_beta1_dep_0_7_p_0_3[2,], prr_results_beta1_dep_neg0_7_p_0_3[2,]))

#rr thresholds
mean_spec_rr <- as.numeric(c(rr_results_beta1_p_0_3[2,], rr_results_beta1_dep_0_7_p_0_3[2,], rr_results_beta1_dep_neg0_7_p_0_3[2,]))

#ror thresholds
mean_spec_ror <- as.numeric(c(ror_results_beta1_p_0_3[2,], ror_results_beta1_dep_0_7_p_0_3[2,], ror_results_beta1_dep_neg0_7_p_0_3[2,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=sgn)) + 
  ylim(0.4,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_spec_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=prr_thresh, y=mean_spec_prr, color=sgn)) +
  ylim(0.4,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_spec_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=rr_thresh, y=mean_spec_rr, color=sgn)) +
  ylim(0.4,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_spec_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=ror_thresh, y=mean_spec_ror, color=sgn)) +
  ylim(0.4,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=sgn)) + 
  ylim(0.4,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid"), name="direction") +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Mean Specificity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

combined_spec_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Specificity plots for Setting 3 (\U03B2 = 1, p = 0.3, |\U03C1| = 0.7)")
spec_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta1_p_0_3_rho_0_7/spec.png"
combined_spec_plot
ggsave(filename = spec_plot_file, plot = combined_spec_plot)

## overall accuracy plots
#confidence thresholds
mean_acc_conf <- as.numeric(c(conf_results_beta1_p_0_3[5,], conf_results_beta1_dep_0_7_p_0_3[5,],  conf_results_beta1_dep_neg0_7_p_0_3[5,]))

#prr thresholds
mean_acc_prr <- as.numeric(c(prr_results_beta1_p_0_3[5,], prr_results_beta1_dep_0_7_p_0_3[5,], prr_results_beta1_dep_neg0_7_p_0_3[5,]))

#rr thresholds
mean_acc_rr <- as.numeric(c(rr_results_beta1_p_0_3[5,], rr_results_beta1_dep_0_7_p_0_3[5,], rr_results_beta1_dep_neg0_7_p_0_3[5,]))

#ror thresholds
mean_acc_ror <- as.numeric(c(ror_results_beta1_p_0_3[5,], ror_results_beta1_dep_0_7_p_0_3[5,], ror_results_beta1_dep_neg0_7_p_0_3[5,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_acc_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=prr_thresh, y=mean_acc_prr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_acc_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=rr_thresh, y=mean_acc_rr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_acc_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=ror_thresh, y=mean_acc_ror, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid"), name="direction") +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_acc_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Overall Accuracy plots for Setting 3 (\U03B2 = 1, p = 0.3, |\U03C1| = 0.7)")

acc_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta1_p_0_3_rho_0_7/acc.png"
combined_acc_plot
ggsave(filename = acc_plot_file, plot = combined_acc_plot)

# roc plots
g1 <- ggplot() + 
  geom_line(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn)) + 
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("Confidence") +
  ylim(0,1) +
  xlim(0,0.35) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=(1-mean_spec_prr), y=mean_sens_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=(1-mean_spec_prr), y=mean_sens_prr, color=sgn)) +
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("PRR") +
  ylim(0,1) +
  xlim(0,0.35) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=(1-mean_spec_rr), y=mean_sens_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=(1-mean_spec_rr), y=mean_sens_rr, color=sgn)) +
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("RR") +
  ylim(0,1) +
  xlim(0,0.35) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=(1-mean_spec_ror), y=mean_sens_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=(1-mean_spec_ror), y=mean_sens_ror, color=sgn)) +
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("ROR") +
  ylim(0,1) +
  xlim(0,0.35) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn)) + 
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("Confidence") +
  ylim(0,1) +
  xlim(0,0.35) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "bottom", title=element_text(size=8), axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_roc_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Sensitivity versus Specificity trade-off plots for Setting 3 (\U03B2 = 1, p = 0.3, |\U03C1| = 0.7)")

roc_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta1_p_0_3_rho_0_7/roc.png"
combined_roc_plot
ggsave(filename = roc_plot_file, plot = combined_roc_plot)
```

```{r b_1_rho_0_7_p_0_5}
conf_thresh <- as.factor(rep(c(0.4,0.5,0.6,0.7), 3))
prr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
rr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
ror_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
#p <- as.factor(c(rep(0.1,4), rep(0.3,4), rep(0.5,4)))
sgn <- as.factor(c(rep(0,4), rep("+",4), rep("-",4)))
#corr <- as.factor(c(rep(0,4), rep(0.3,4), rep(-0.3,4), rep(0.5,4), rep(-0.5,4), rep(0.7,4), rep(-0.7,4)))

#sensitivity plots
#confidence thresholds
mean_sens_conf <- as.numeric(c(conf_results_beta1_p_0_5[1,], conf_results_beta1_dep_0_7_p_0_5[1,], conf_results_beta1_dep_neg0_7_p_0_5[1,]))

#prr thresholds
mean_sens_prr <- as.numeric(c(prr_results_beta1_p_0_5[1,], prr_results_beta1_dep_0_7_p_0_5[1,], prr_results_beta1_dep_neg0_7_p_0_5[1,]))

#rr thresholds
mean_sens_rr <- as.numeric(c(rr_results_beta1_p_0_5[1,], rr_results_beta1_dep_0_7_p_0_5[1,], rr_results_beta1_dep_neg0_7_p_0_5[1,]))

#ror thresholds
mean_sens_ror <- as.numeric(c(ror_results_beta1_p_0_5[1,], ror_results_beta1_dep_0_7_p_0_5[1,], ror_results_beta1_dep_neg0_7_p_0_5[1,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_sens_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=prr_thresh, y=mean_sens_prr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_sens_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=rr_thresh, y=mean_sens_rr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_sens_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=ror_thresh, y=mean_sens_ror, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid"), name="direction") +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Mean Sensitivity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_sens_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Sensitivity plots for Setting 3 (\U03B2 = 1, p = 0.5, |\U03C1| = 0.7)")

sens_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta1_p_0_5_rho_0_5/sens.png"
combined_sens_plot
ggsave(filename = sens_plot_file, plot = combined_sens_plot)

## specificity plots
#confidence thresholds
mean_spec_conf <- as.numeric(c(conf_results_beta1_p_0_5[2,], conf_results_beta1_dep_0_7_p_0_5[2,], conf_results_beta1_dep_neg0_7_p_0_5[2,]))

#prr thresholds
mean_spec_prr <- as.numeric(c(prr_results_beta1_p_0_5[2,], prr_results_beta1_dep_0_7_p_0_5[2,], prr_results_beta1_dep_neg0_7_p_0_5[2,]))

#rr thresholds
mean_spec_rr <- as.numeric(c(rr_results_beta1_p_0_5[2,], rr_results_beta1_dep_0_7_p_0_5[2,], rr_results_beta1_dep_neg0_7_p_0_5[2,]))

#ror thresholds
mean_spec_ror <- as.numeric(c(ror_results_beta1_p_0_5[2,], ror_results_beta1_dep_0_7_p_0_5[2,], ror_results_beta1_dep_neg0_7_p_0_5[2,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=sgn)) + 
  ylim(0.6,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_spec_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=prr_thresh, y=mean_spec_prr, color=sgn)) +
  ylim(0.6,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_spec_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=rr_thresh, y=mean_spec_rr, color=sgn)) +
  ylim(0.6,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_spec_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=ror_thresh, y=mean_spec_ror, color=sgn)) +
  ylim(0.6,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=sgn)) + 
  ylim(0.6,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid"), name="direction") +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Mean Specificity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

combined_spec_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Specificity plots for Setting 3 (\U03B2 = 1, p = 0.5, |\U03C1| = 0.7)")
spec_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta1_p_0_5_rho_0_7/spec.png"
combined_spec_plot
ggsave(filename = spec_plot_file, plot = combined_spec_plot)

## overall accuracy plots
#confidence thresholds
mean_acc_conf <- as.numeric(c(conf_results_beta1_p_0_5[5,], conf_results_beta1_dep_0_7_p_0_5[5,],  conf_results_beta1_dep_neg0_7_p_0_5[5,]))

#prr thresholds
mean_acc_prr <- as.numeric(c(prr_results_beta1_p_0_5[5,], prr_results_beta1_dep_0_7_p_0_5[5,], prr_results_beta1_dep_neg0_7_p_0_5[5,]))

#rr thresholds
mean_acc_rr <- as.numeric(c(rr_results_beta1_p_0_5[5,], rr_results_beta1_dep_0_7_p_0_5[5,], rr_results_beta1_dep_neg0_7_p_0_5[5,]))

#ror thresholds
mean_acc_ror <- as.numeric(c(ror_results_beta1_p_0_5[5,], ror_results_beta1_dep_0_7_p_0_5[5,], ror_results_beta1_dep_neg0_7_p_0_5[5,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_acc_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=prr_thresh, y=mean_acc_prr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_acc_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=rr_thresh, y=mean_acc_rr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_acc_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=ror_thresh, y=mean_acc_ror, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid"), name="direction") +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_acc_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Overall Accuracy plots for Setting 3 (\U03B2 = 1, p = 0.5, |\U03C1| = 0.7)")

acc_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta1_p_0_5_rho_0_7/acc.png"
combined_acc_plot
ggsave(filename = acc_plot_file, plot = combined_acc_plot)

# roc plots
g1 <- ggplot() + 
  geom_line(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn)) + 
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("Confidence") +
  ylim(0,1) +
  xlim(0,0.4) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=(1-mean_spec_prr), y=mean_sens_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=(1-mean_spec_prr), y=mean_sens_prr, color=sgn)) +
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("PRR") +
  ylim(0,1) +
  xlim(0,0.4) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=(1-mean_spec_rr), y=mean_sens_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=(1-mean_spec_rr), y=mean_sens_rr, color=sgn)) +
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("RR") +
  ylim(0,1) +
  xlim(0,0.4) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=(1-mean_spec_ror), y=mean_sens_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=(1-mean_spec_ror), y=mean_sens_ror, color=sgn)) +
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("ROR") +
  ylim(0,1) +
  xlim(0,0.4) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn)) + 
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("Confidence") +
  ylim(0,1) +
  xlim(0,0.4) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "bottom", title=element_text(size=8), axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_roc_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Sensitivity versus Specificity trade-off plots for Setting 3 (\U03B2 = 1, p = 0.5, |\U03C1| = 0.7)")

roc_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta1_p_0_5_rho_0_7/roc.png"
combined_roc_plot
ggsave(filename = roc_plot_file, plot = combined_roc_plot)
```

```{r b_50_rho_0_3_p_0_1}
conf_thresh <- as.factor(rep(c(0.4,0.5,0.6,0.7), 3))
prr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
rr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
ror_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
#p <- as.factor(c(rep(0.1,4), rep(0.3,4), rep(0.5,4)))
sgn <- as.factor(c(rep(0,4), rep("+",4), rep("-",4)))
#corr <- as.factor(c(rep(0,4), rep(0.3,4), rep(-0.3,4), rep(0.5,4), rep(-0.5,4), rep(0.7,4), rep(-0.7,4)))

#sensitivity plots
#confidence thresholds
mean_sens_conf <- as.numeric(c(conf_results_beta50_p_0_1[1,], conf_results_beta50_dep_0_3_p_0_1[1,], conf_results_beta50_dep_neg0_3_p_0_1[1,]))

#prr thresholds
mean_sens_prr <- as.numeric(c(prr_results_beta50_p_0_1[1,], prr_results_beta50_dep_0_3_p_0_1[1,], prr_results_beta50_dep_neg0_3_p_0_1[1,]))

#rr thresholds
mean_sens_rr <- as.numeric(c(rr_results_beta50_p_0_1[1,], rr_results_beta50_dep_0_3_p_0_1[1,], rr_results_beta50_dep_neg0_3_p_0_1[1,]))

#ror thresholds
mean_sens_ror <- as.numeric(c(ror_results_beta50_p_0_1[1,], ror_results_beta50_dep_0_3_p_0_1[1,], ror_results_beta50_dep_neg0_3_p_0_1[1,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_sens_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=prr_thresh, y=mean_sens_prr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_sens_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=rr_thresh, y=mean_sens_rr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_sens_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=ror_thresh, y=mean_sens_ror, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid"), name="direction") +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Mean Sensitivity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_sens_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Sensitivity plots for Setting 3 (\U03B2 = 50, p = 0.1, |\U03C1| = 0.3)")

sens_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta50_p_0_1_rho_0_3/sens.png"
combined_sens_plot
ggsave(filename = sens_plot_file, plot = combined_sens_plot)

## specificity plots
#confidence thresholds
mean_spec_conf <- as.numeric(c(conf_results_beta50_p_0_1[2,], conf_results_beta50_dep_0_3_p_0_1[2,], conf_results_beta50_dep_neg0_3_p_0_1[2,]))

#prr thresholds
mean_spec_prr <- as.numeric(c(prr_results_beta50_p_0_1[2,], prr_results_beta50_dep_0_3_p_0_1[2,], prr_results_beta50_dep_neg0_3_p_0_1[2,]))

#rr thresholds
mean_spec_rr <- as.numeric(c(rr_results_beta50_p_0_1[2,], rr_results_beta50_dep_0_3_p_0_1[2,], rr_results_beta50_dep_neg0_3_p_0_1[2,]))

#ror thresholds
mean_spec_ror <- as.numeric(c(ror_results_beta50_p_0_1[2,], ror_results_beta50_dep_0_3_p_0_1[2,], ror_results_beta50_dep_neg0_3_p_0_1[2,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=sgn)) + 
  ylim(0.6,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_spec_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=prr_thresh, y=mean_spec_prr, color=sgn)) +
  ylim(0.6,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_spec_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=rr_thresh, y=mean_spec_rr, color=sgn)) +
  ylim(0.6,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_spec_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=ror_thresh, y=mean_spec_ror, color=sgn)) +
  ylim(0.6,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=sgn)) + 
  ylim(0.6,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid"), name="direction") +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Mean Specificity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

combined_spec_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Specificity plots for Setting 3 (\U03B2 = 50, p = 0.1, |\U03C1| = 0.3)")
spec_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta50_p_0_1_rho_0_3/spec.png"
combined_spec_plot
ggsave(filename = spec_plot_file, plot = combined_spec_plot)

## overall accuracy plots
#confidence thresholds
mean_acc_conf <- as.numeric(c(conf_results_beta50_p_0_1[5,], conf_results_beta50_dep_0_3_p_0_1[5,],  conf_results_beta50_dep_neg0_3_p_0_1[5,]))

#prr thresholds
mean_acc_prr <- as.numeric(c(prr_results_beta50_p_0_1[5,], prr_results_beta50_dep_0_3_p_0_1[5,], prr_results_beta50_dep_neg0_3_p_0_1[5,]))

#rr thresholds
mean_acc_rr <- as.numeric(c(rr_results_beta50_p_0_1[5,], rr_results_beta50_dep_0_3_p_0_1[5,], rr_results_beta50_dep_neg0_3_p_0_1[5,]))

#ror thresholds
mean_acc_ror <- as.numeric(c(ror_results_beta50_p_0_1[5,], ror_results_beta50_dep_0_3_p_0_1[5,], ror_results_beta50_dep_neg0_3_p_0_1[5,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_acc_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=prr_thresh, y=mean_acc_prr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_acc_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=rr_thresh, y=mean_acc_rr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_acc_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=ror_thresh, y=mean_acc_ror, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid"), name="direction") +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") + 
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_acc_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Overall Accuracy plots for Setting 3 (\U03B2 = 50, p = 0.1, |\U03C1| = 0.3)")

acc_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta50_p_0_1_rho_0_3/acc.png"
combined_acc_plot
ggsave(filename = acc_plot_file, plot = combined_acc_plot)

# roc plots
g1 <- ggplot() + 
  geom_line(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn)) + 
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("Confidence") +
  ylim(0,1) +
  xlim(0,0.4) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=(1-mean_spec_prr), y=mean_sens_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=(1-mean_spec_prr), y=mean_sens_prr, color=sgn)) +
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("PRR") +
  ylim(0,1) +
  xlim(0,0.4) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=(1-mean_spec_rr), y=mean_sens_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=(1-mean_spec_rr), y=mean_sens_rr, color=sgn)) +
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("RR") +
  ylim(0,1) +
  xlim(0,0.4) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=(1-mean_spec_ror), y=mean_sens_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=(1-mean_spec_ror), y=mean_sens_ror, color=sgn)) +
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("ROR") +
  ylim(0,1) +
  xlim(0,0.4) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn)) + 
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("Confidence") +
  ylim(0,1) +
  xlim(0,0.4) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "bottom", title=element_text(size=8), axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_roc_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Sensitivity versus Specificity trade-off plots for Setting 3 (\U03B2 = 50, p = 0.1, |\U03C1| = 0.3)")

roc_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta50_p_0_1_rho_0_3/roc.png"
combined_roc_plot
ggsave(filename = roc_plot_file, plot = combined_roc_plot)
```

```{r b_50_rho_0_5_p_0_1}
conf_thresh <- as.factor(rep(c(0.4,0.5,0.6,0.7), 3))
prr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
rr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
ror_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
#p <- as.factor(c(rep(0.1,4), rep(0.3,4), rep(0.5,4)))
sgn <- as.factor(c(rep(0,4), rep("+",4), rep("-",4)))
#corr <- as.factor(c(rep(0,4), rep(0.3,4), rep(-0.3,4), rep(0.5,4), rep(-0.5,4), rep(0.7,4), rep(-0.7,4)))

#sensitivity plots
#confidence thresholds
mean_sens_conf <- as.numeric(c(conf_results_beta50_p_0_1[1,], conf_results_beta50_dep_0_5_p_0_1[1,], conf_results_beta50_dep_neg0_5_p_0_1[1,]))

#prr thresholds
mean_sens_prr <- as.numeric(c(prr_results_beta50_p_0_1[1,], prr_results_beta50_dep_0_5_p_0_1[1,], prr_results_beta50_dep_neg0_5_p_0_1[1,]))

#rr thresholds
mean_sens_rr <- as.numeric(c(rr_results_beta50_p_0_1[1,], rr_results_beta50_dep_0_5_p_0_1[1,], rr_results_beta50_dep_neg0_5_p_0_1[1,]))

#ror thresholds
mean_sens_ror <- as.numeric(c(ror_results_beta50_p_0_1[1,], ror_results_beta50_dep_0_5_p_0_1[1,], ror_results_beta50_dep_neg0_5_p_0_1[1,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_sens_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=prr_thresh, y=mean_sens_prr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_sens_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=rr_thresh, y=mean_sens_rr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_sens_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=ror_thresh, y=mean_sens_ror, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid"), name="direction") +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Mean Sensitivity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_sens_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Sensitivity plots for Setting 3 (\U03B2 = 50, p = 0.1, |\U03C1| = 0.5)")

sens_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta50_p_0_1_rho_0_5/sens.png"
combined_sens_plot
ggsave(filename = sens_plot_file, plot = combined_sens_plot)

## specificity plots
#confidence thresholds
mean_spec_conf <- as.numeric(c(conf_results_beta50_p_0_1[2,], conf_results_beta50_dep_0_5_p_0_1[2,], conf_results_beta50_dep_neg0_5_p_0_1[2,]))

#prr thresholds
mean_spec_prr <- as.numeric(c(prr_results_beta50_p_0_1[2,], prr_results_beta50_dep_0_5_p_0_1[2,], prr_results_beta50_dep_neg0_5_p_0_1[2,]))

#rr thresholds
mean_spec_rr <- as.numeric(c(rr_results_beta50_p_0_1[2,], rr_results_beta50_dep_0_5_p_0_1[2,], rr_results_beta50_dep_neg0_5_p_0_1[2,]))

#ror thresholds
mean_spec_ror <- as.numeric(c(ror_results_beta50_p_0_1[2,], ror_results_beta50_dep_0_5_p_0_1[2,], ror_results_beta50_dep_neg0_5_p_0_1[2,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=sgn)) + 
  ylim(0.6,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_spec_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=prr_thresh, y=mean_spec_prr, color=sgn)) +
  ylim(0.6,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_spec_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=rr_thresh, y=mean_spec_rr, color=sgn)) +
  ylim(0.6,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_spec_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=ror_thresh, y=mean_spec_ror, color=sgn)) +
  ylim(0.6,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=sgn)) + 
  ylim(0.6,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid"), name="direction") +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Mean Specificity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

combined_spec_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Specificity plots for Setting 3 (\U03B2 = 50, p = 0.1, |\U03C1| = 0.5)")
spec_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta50_p_0_1_rho_0_5/spec.png"
combined_spec_plot
ggsave(filename = spec_plot_file, plot = combined_spec_plot)

## overall accuracy plots
#confidence thresholds
mean_acc_conf <- as.numeric(c(conf_results_beta50_p_0_1[5,], conf_results_beta50_dep_0_5_p_0_1[5,],  conf_results_beta50_dep_neg0_5_p_0_1[5,]))

#prr thresholds
mean_acc_prr <- as.numeric(c(prr_results_beta50_p_0_1[5,], prr_results_beta50_dep_0_5_p_0_1[5,], prr_results_beta50_dep_neg0_5_p_0_1[5,]))

#rr thresholds
mean_acc_rr <- as.numeric(c(rr_results_beta50_p_0_1[5,], rr_results_beta50_dep_0_5_p_0_1[5,], rr_results_beta50_dep_neg0_5_p_0_1[5,]))

#ror thresholds
mean_acc_ror <- as.numeric(c(ror_results_beta50_p_0_1[5,], ror_results_beta50_dep_0_5_p_0_1[5,], ror_results_beta50_dep_neg0_5_p_0_1[5,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_acc_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=prr_thresh, y=mean_acc_prr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_acc_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=rr_thresh, y=mean_acc_rr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_acc_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=ror_thresh, y=mean_acc_ror, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid"), name="direction") +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_acc_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Overall Accuracy plots for Setting 3 (\U03B2 = 50, p = 0.1, |\U03C1| = 0.5)")

acc_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta50_p_0_1_rho_0_5/acc.png"
combined_acc_plot
ggsave(filename = acc_plot_file, plot = combined_acc_plot)

# roc plots
g1 <- ggplot() + 
  geom_line(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn)) + 
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("Confidence") +
  ylim(0,1) +
  xlim(0,0.4) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=(1-mean_spec_prr), y=mean_sens_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=(1-mean_spec_prr), y=mean_sens_prr, color=sgn)) +
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("PRR") +
  ylim(0,1) +
  xlim(0,0.4) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=(1-mean_spec_rr), y=mean_sens_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=(1-mean_spec_rr), y=mean_sens_rr, color=sgn)) +
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("RR") +
  ylim(0,1) +
  xlim(0,0.4) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=(1-mean_spec_ror), y=mean_sens_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=(1-mean_spec_ror), y=mean_sens_ror, color=sgn)) +
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("ROR") +
  ylim(0,1) +
  xlim(0,0.4) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn)) + 
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("Confidence") +
  ylim(0,1) +
  xlim(0,0.4) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "bottom", title=element_text(size=8), axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_roc_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Sensitivity versus Specificity trade-off plots for Setting 3 (\U03B2 = 50, p = 0.1, |\U03C1| = 0.5)")

roc_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta50_p_0_1_rho_0_5/roc.png"
combined_roc_plot
ggsave(filename = roc_plot_file, plot = combined_roc_plot)
```

```{r b_50_rho_0_7_p_0_1}
conf_thresh <- as.factor(rep(c(0.4,0.5,0.6,0.7), 3))
prr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
rr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
ror_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
#p <- as.factor(c(rep(0.1,4), rep(0.3,4), rep(0.5,4)))
sgn <- as.factor(c(rep(0,4), rep("+",4), rep("-",4)))
#corr <- as.factor(c(rep(0,4), rep(0.3,4), rep(-0.3,4), rep(0.5,4), rep(-0.5,4), rep(0.7,4), rep(-0.7,4)))

#sensitivity plots
#confidence thresholds
mean_sens_conf <- as.numeric(c(conf_results_beta50_p_0_1[1,], conf_results_beta50_dep_0_7_p_0_1[1,], conf_results_beta50_dep_neg0_7_p_0_1[1,]))

#prr thresholds
mean_sens_prr <- as.numeric(c(prr_results_beta50_p_0_1[1,], prr_results_beta50_dep_0_7_p_0_1[1,], prr_results_beta50_dep_neg0_7_p_0_1[1,]))

#rr thresholds
mean_sens_rr <- as.numeric(c(rr_results_beta50_p_0_1[1,], rr_results_beta50_dep_0_7_p_0_1[1,], rr_results_beta50_dep_neg0_7_p_0_1[1,]))

#ror thresholds
mean_sens_ror <- as.numeric(c(ror_results_beta50_p_0_1[1,], ror_results_beta50_dep_0_7_p_0_1[1,], ror_results_beta50_dep_neg0_7_p_0_1[1,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_sens_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=prr_thresh, y=mean_sens_prr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_sens_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=rr_thresh, y=mean_sens_rr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_sens_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=ror_thresh, y=mean_sens_ror, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid"), name="direction") +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Mean Sensitivity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_sens_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Sensitivity plots for Setting 3 (\U03B2 = 50, p = 0.1, |\U03C1| = 0.7)")

sens_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta50_p_0_1_rho_0_7/sens.png"
combined_sens_plot
ggsave(filename = sens_plot_file, plot = combined_sens_plot)

## specificity plots
#confidence thresholds
mean_spec_conf <- as.numeric(c(conf_results_beta50_p_0_1[2,], conf_results_beta50_dep_0_7_p_0_1[2,], conf_results_beta50_dep_neg0_7_p_0_1[2,]))

#prr thresholds
mean_spec_prr <- as.numeric(c(prr_results_beta50_p_0_1[2,], prr_results_beta50_dep_0_7_p_0_1[2,], prr_results_beta50_dep_neg0_7_p_0_1[2,]))

#rr thresholds
mean_spec_rr <- as.numeric(c(rr_results_beta50_p_0_1[2,], rr_results_beta50_dep_0_7_p_0_1[2,], rr_results_beta50_dep_neg0_7_p_0_1[2,]))

#ror thresholds
mean_spec_ror <- as.numeric(c(ror_results_beta50_p_0_1[2,], ror_results_beta50_dep_0_7_p_0_1[2,], ror_results_beta50_dep_neg0_7_p_0_1[2,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=sgn)) + 
  ylim(0.6,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_spec_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=prr_thresh, y=mean_spec_prr, color=sgn)) +
  ylim(0.6,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_spec_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=rr_thresh, y=mean_spec_rr, color=sgn)) +
  ylim(0.6,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_spec_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=ror_thresh, y=mean_spec_ror, color=sgn)) +
  ylim(0.6,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=sgn)) + 
  ylim(0.6,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid"), name="direction") +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Mean Specificity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

combined_spec_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Specificity plots for Setting 3 (\U03B2 = 50, p = 0.1, |\U03C1| = 0.7)")
spec_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta50_p_0_1_rho_0_7/spec.png"
combined_spec_plot
ggsave(filename = spec_plot_file, plot = combined_spec_plot)

## overall accuracy plots
#confidence thresholds
mean_acc_conf <- as.numeric(c(conf_results_beta50_p_0_1[5,], conf_results_beta50_dep_0_7_p_0_1[5,],  conf_results_beta50_dep_neg0_7_p_0_1[5,]))

#prr thresholds
mean_acc_prr <- as.numeric(c(prr_results_beta50_p_0_1[5,], prr_results_beta50_dep_0_7_p_0_1[5,], prr_results_beta50_dep_neg0_7_p_0_1[5,]))

#rr thresholds
mean_acc_rr <- as.numeric(c(rr_results_beta50_p_0_1[5,], rr_results_beta50_dep_0_7_p_0_1[5,], rr_results_beta50_dep_neg0_7_p_0_1[5,]))

#ror thresholds
mean_acc_ror <- as.numeric(c(ror_results_beta50_p_0_1[5,], ror_results_beta50_dep_0_7_p_0_1[5,], ror_results_beta50_dep_neg0_7_p_0_1[5,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_acc_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=prr_thresh, y=mean_acc_prr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_acc_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=rr_thresh, y=mean_acc_rr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_acc_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=ror_thresh, y=mean_acc_ror, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid"), name="direction") +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_acc_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Overall Accuracy plots for Setting 3 (\U03B2 = 50, p = 0.1, |\U03C1| = 0.7)")

acc_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta50_p_0_1_rho_0_7/acc.png"
combined_acc_plot
ggsave(filename = acc_plot_file, plot = combined_acc_plot)

# roc plots
g1 <- ggplot() + 
  geom_line(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn)) + 
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("Confidence") +
  ylim(0,1) +
  xlim(0,0.4) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=(1-mean_spec_prr), y=mean_sens_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=(1-mean_spec_prr), y=mean_sens_prr, color=sgn)) +
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("PRR") +
  ylim(0,1) +
  xlim(0,0.4) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=(1-mean_spec_rr), y=mean_sens_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=(1-mean_spec_rr), y=mean_sens_rr, color=sgn)) +
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("RR") +
  ylim(0,1) +
  xlim(0,0.4) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=(1-mean_spec_ror), y=mean_sens_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=(1-mean_spec_ror), y=mean_sens_ror, color=sgn)) +
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("ROR") +
  ylim(0,1) +
  xlim(0,0.4) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn)) + 
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("Confidence") +
  ylim(0,1) +
  xlim(0,0.4) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "bottom", title=element_text(size=8), axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_roc_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Sensitivity versus Specificity trade-off plots for Setting 3 (\U03B2 = 50, p = 0.1, |\U03C1| = 0.7)")

roc_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta50_p_0_1_rho_0_7/roc.png"
combined_roc_plot
ggsave(filename = roc_plot_file, plot = combined_roc_plot)
```

```{r b_50_rho_0_5_p_0_3}
conf_thresh <- as.factor(rep(c(0.4,0.5,0.6,0.7), 3))
prr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
rr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
ror_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
#p <- as.factor(c(rep(0.1,4), rep(0.3,4), rep(0.5,4)))
sgn <- as.factor(c(rep(0,4), rep("+",4), rep("-",4)))
#corr <- as.factor(c(rep(0,4), rep(0.3,4), rep(-0.3,4), rep(0.5,4), rep(-0.5,4), rep(0.7,4), rep(-0.7,4)))

#sensitivity plots
#confidence thresholds
mean_sens_conf <- as.numeric(c(conf_results_beta50_p_0_3[1,], conf_results_beta50_dep_0_5_p_0_3[1,], conf_results_beta50_dep_neg0_5_p_0_3[1,]))

#prr thresholds
mean_sens_prr <- as.numeric(c(prr_results_beta50_p_0_3[1,], prr_results_beta50_dep_0_5_p_0_3[1,], prr_results_beta50_dep_neg0_5_p_0_3[1,]))

#rr thresholds
mean_sens_rr <- as.numeric(c(rr_results_beta50_p_0_3[1,], rr_results_beta50_dep_0_5_p_0_3[1,], rr_results_beta50_dep_neg0_5_p_0_3[1,]))

#ror thresholds
mean_sens_ror <- as.numeric(c(ror_results_beta50_p_0_3[1,], ror_results_beta50_dep_0_5_p_0_3[1,], ror_results_beta50_dep_neg0_5_p_0_3[1,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_sens_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=prr_thresh, y=mean_sens_prr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_sens_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=rr_thresh, y=mean_sens_rr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_sens_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=ror_thresh, y=mean_sens_ror, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid"), name="direction") +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Mean Sensitivity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_sens_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Sensitivity plots for Setting 3 (\U03B2 = 50, p = 0.3, |\U03C1| = 0.5)")

sens_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta50_p_0_3_rho_0_5/sens.png"
combined_sens_plot
ggsave(filename = sens_plot_file, plot = combined_sens_plot)

## specificity plots
#confidence thresholds
mean_spec_conf <- as.numeric(c(conf_results_beta50_p_0_3[2,], conf_results_beta50_dep_0_5_p_0_3[2,], conf_results_beta50_dep_neg0_5_p_0_3[2,]))

#prr thresholds
mean_spec_prr <- as.numeric(c(prr_results_beta50_p_0_3[2,], prr_results_beta50_dep_0_5_p_0_3[2,], prr_results_beta50_dep_neg0_5_p_0_3[2,]))

#rr thresholds
mean_spec_rr <- as.numeric(c(rr_results_beta50_p_0_3[2,], rr_results_beta50_dep_0_5_p_0_3[2,], rr_results_beta50_dep_neg0_5_p_0_3[2,]))

#ror thresholds
mean_spec_ror <- as.numeric(c(ror_results_beta50_p_0_3[2,], ror_results_beta50_dep_0_5_p_0_3[2,], ror_results_beta50_dep_neg0_5_p_0_3[2,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=sgn)) + 
  ylim(0.4,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_spec_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=prr_thresh, y=mean_spec_prr, color=sgn)) +
  ylim(0.4,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_spec_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=rr_thresh, y=mean_spec_rr, color=sgn)) +
  ylim(0.4,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_spec_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=ror_thresh, y=mean_spec_ror, color=sgn)) +
  ylim(0.4,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=sgn)) + 
  ylim(0.4,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid"), name="direction") +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Mean Specificity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

combined_spec_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Specificity plots for Setting 3 (\U03B2 = 50, p = 0.3, |\U03C1| = 0.5)")
spec_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta50_p_0_3_rho_0_5/spec.png"
combined_spec_plot
ggsave(filename = spec_plot_file, plot = combined_spec_plot)

## overall accuracy plots
#confidence thresholds
mean_acc_conf <- as.numeric(c(conf_results_beta50_p_0_3[5,], conf_results_beta50_dep_0_5_p_0_3[5,],  conf_results_beta50_dep_neg0_5_p_0_3[5,]))

#prr thresholds
mean_acc_prr <- as.numeric(c(prr_results_beta50_p_0_3[5,], prr_results_beta50_dep_0_5_p_0_3[5,], prr_results_beta50_dep_neg0_5_p_0_3[5,]))

#rr thresholds
mean_acc_rr <- as.numeric(c(rr_results_beta50_p_0_3[5,], rr_results_beta50_dep_0_5_p_0_3[5,], rr_results_beta50_dep_neg0_5_p_0_3[5,]))

#ror thresholds
mean_acc_ror <- as.numeric(c(ror_results_beta50_p_0_3[5,], ror_results_beta50_dep_0_5_p_0_3[5,], ror_results_beta50_dep_neg0_5_p_0_3[5,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_acc_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=prr_thresh, y=mean_acc_prr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_acc_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=rr_thresh, y=mean_acc_rr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_acc_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=ror_thresh, y=mean_acc_ror, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid"), name="direction") +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_acc_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Overall Accuracy plots for Setting 3 (\U03B2 = 50, p = 0.3, |\U03C1| = 0.5)")

acc_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta50_p_0_3_rho_0_5/acc.png"
combined_acc_plot
ggsave(filename = acc_plot_file, plot = combined_acc_plot)

# roc plots
g1 <- ggplot() + 
  geom_line(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn)) + 
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("Confidence") +
  ylim(0,1) +
  xlim(0,0.4) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=(1-mean_spec_prr), y=mean_sens_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=(1-mean_spec_prr), y=mean_sens_prr, color=sgn)) +
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("PRR") +
  ylim(0,1) +
  xlim(0,0.4) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=(1-mean_spec_rr), y=mean_sens_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=(1-mean_spec_rr), y=mean_sens_rr, color=sgn)) +
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("RR") +
  ylim(0,1) +
  xlim(0,0.4) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=(1-mean_spec_ror), y=mean_sens_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=(1-mean_spec_ror), y=mean_sens_ror, color=sgn)) +
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("ROR") +
  ylim(0,1) +
  xlim(0,0.4) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn)) + 
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("Confidence") +
  ylim(0,1) +
  xlim(0,0.4) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "bottom", title=element_text(size=8), axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_roc_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Sensitivity versus Specificity trade-off plots for Setting 3 (\U03B2 = 50, p = 0.3, |\U03C1| = 0.5)")

roc_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta50_p_0_3_rho_0_5/roc.png"
combined_roc_plot
ggsave(filename = roc_plot_file, plot = combined_roc_plot)
```

```{r b_50_rho_0_5_p_0_5}
conf_thresh <- as.factor(rep(c(0.4,0.5,0.6,0.7), 3))
prr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
rr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
ror_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
#p <- as.factor(c(rep(0.1,4), rep(0.3,4), rep(0.5,4)))
sgn <- as.factor(c(rep(0,4), rep("+",4), rep("-",4)))
#corr <- as.factor(c(rep(0,4), rep(0.3,4), rep(-0.3,4), rep(0.5,4), rep(-0.5,4), rep(0.7,4), rep(-0.7,4)))

#sensitivity plots
#confidence thresholds
mean_sens_conf <- as.numeric(c(conf_results_beta50_p_0_5[1,], conf_results_beta50_dep_0_5_p_0_5[1,], conf_results_beta50_dep_neg0_5_p_0_5[1,]))

#prr thresholds
mean_sens_prr <- as.numeric(c(prr_results_beta50_p_0_5[1,], prr_results_beta50_dep_0_5_p_0_5[1,], prr_results_beta50_dep_neg0_5_p_0_5[1,]))

#rr thresholds
mean_sens_rr <- as.numeric(c(rr_results_beta50_p_0_5[1,], rr_results_beta50_dep_0_5_p_0_5[1,], rr_results_beta50_dep_neg0_5_p_0_5[1,]))

#ror thresholds
mean_sens_ror <- as.numeric(c(ror_results_beta50_p_0_5[1,], ror_results_beta50_dep_0_5_p_0_5[1,], ror_results_beta50_dep_neg0_5_p_0_5[1,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_sens_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=prr_thresh, y=mean_sens_prr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_sens_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=rr_thresh, y=mean_sens_rr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_sens_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=ror_thresh, y=mean_sens_ror, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid"), name="direction") +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Mean Sensitivity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_sens_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Sensitivity plots for Setting 3 (\U03B2 = 50, p = 0.5, |\U03C1| = 0.5)")

sens_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta50_p_0_5_rho_0_5/sens.png"
combined_sens_plot
ggsave(filename = sens_plot_file, plot = combined_sens_plot)

## specificity plots
#confidence thresholds
mean_spec_conf <- as.numeric(c(conf_results_beta50_p_0_5[2,], conf_results_beta50_dep_0_5_p_0_5[2,], conf_results_beta50_dep_neg0_5_p_0_5[2,]))

#prr thresholds
mean_spec_prr <- as.numeric(c(prr_results_beta50_p_0_5[2,], prr_results_beta50_dep_0_5_p_0_5[2,], prr_results_beta50_dep_neg0_5_p_0_5[2,]))

#rr thresholds
mean_spec_rr <- as.numeric(c(rr_results_beta50_p_0_5[2,], rr_results_beta50_dep_0_5_p_0_5[2,], rr_results_beta50_dep_neg0_5_p_0_5[2,]))

#ror thresholds
mean_spec_ror <- as.numeric(c(ror_results_beta50_p_0_5[2,], ror_results_beta50_dep_0_5_p_0_5[2,], ror_results_beta50_dep_neg0_5_p_0_5[2,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=sgn)) + 
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_spec_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=prr_thresh, y=mean_spec_prr, color=sgn)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_spec_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=rr_thresh, y=mean_spec_rr, color=sgn)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_spec_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=ror_thresh, y=mean_spec_ror, color=sgn)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=sgn)) + 
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid"), name="direction") +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Mean Specificity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

combined_spec_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Specificity plots for Setting 3 (\U03B2 = 50, p = 0.5, |\U03C1| = 0.5)")
spec_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta50_p_0_5_rho_0_5/spec.png"
combined_spec_plot
ggsave(filename = spec_plot_file, plot = combined_spec_plot)

## overall accuracy plots
#confidence thresholds
mean_acc_conf <- as.numeric(c(conf_results_beta50_p_0_5[5,], conf_results_beta50_dep_0_5_p_0_5[5,],  conf_results_beta50_dep_neg0_5_p_0_5[5,]))

#prr thresholds
mean_acc_prr <- as.numeric(c(prr_results_beta50_p_0_5[5,], prr_results_beta50_dep_0_5_p_0_5[5,], prr_results_beta50_dep_neg0_5_p_0_5[5,]))

#rr thresholds
mean_acc_rr <- as.numeric(c(rr_results_beta50_p_0_5[5,], rr_results_beta50_dep_0_5_p_0_5[5,], rr_results_beta50_dep_neg0_5_p_0_5[5,]))

#ror thresholds
mean_acc_ror <- as.numeric(c(ror_results_beta50_p_0_5[5,], ror_results_beta50_dep_0_5_p_0_5[5,], ror_results_beta50_dep_neg0_5_p_0_5[5,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_acc_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=prr_thresh, y=mean_acc_prr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_acc_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=rr_thresh, y=mean_acc_rr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_acc_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=ror_thresh, y=mean_acc_ror, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid"), name="direction") +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_acc_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Overall Accuracy plots for Setting 3 (\U03B2 = 50, p = 0.5, |\U03C1| = 0.5)")

acc_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta50_p_0_5_rho_0_5/acc.png"
combined_acc_plot
ggsave(filename = acc_plot_file, plot = combined_acc_plot)

# roc plots
g1 <- ggplot() + 
  geom_line(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn)) + 
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("Confidence") +
  ylim(0,1) +
  xlim(0,0.5) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=(1-mean_spec_prr), y=mean_sens_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=(1-mean_spec_prr), y=mean_sens_prr, color=sgn)) +
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("PRR") +
  ylim(0,1) +
  xlim(0,0.5) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=(1-mean_spec_rr), y=mean_sens_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=(1-mean_spec_rr), y=mean_sens_rr, color=sgn)) +
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("RR") +
  ylim(0,1) +
  xlim(0,0.5) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=(1-mean_spec_ror), y=mean_sens_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=(1-mean_spec_ror), y=mean_sens_ror, color=sgn)) +
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("ROR") +
  ylim(0,1) +
  xlim(0,0.5) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn)) + 
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("Confidence") +
  ylim(0,1) +
  xlim(0,0.5) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "bottom", title=element_text(size=8), axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_roc_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Sensitivity versus Specificity trade-off plots for Setting 3 (\U03B2 = 50, p = 0.5, |\U03C1| = 0.5)")

roc_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta50_p_0_5_rho_0_5/roc.png"
combined_roc_plot
ggsave(filename = roc_plot_file, plot = combined_roc_plot)
```

```{r b_100_rho_0_5_p_0_3}
conf_thresh <- as.factor(rep(c(0.4,0.5,0.6,0.7), 3))
prr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
rr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
ror_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
#p <- as.factor(c(rep(0.1,4), rep(0.3,4), rep(0.5,4)))
sgn <- as.factor(c(rep(0,4), rep("+",4), rep("-",4)))
#corr <- as.factor(c(rep(0,4), rep(0.3,4), rep(-0.3,4), rep(0.5,4), rep(-0.5,4), rep(0.7,4), rep(-0.7,4)))

#sensitivity plots
#confidence thresholds
mean_sens_conf <- as.numeric(c(conf_results_beta100_p_0_3[1,], conf_results_beta100_dep_0_5_p_0_3[1,], conf_results_beta100_dep_neg0_5_p_0_3[1,]))

#prr thresholds
mean_sens_prr <- as.numeric(c(prr_results_beta100_p_0_3[1,], prr_results_beta100_dep_0_5_p_0_3[1,], prr_results_beta100_dep_neg0_5_p_0_3[1,]))

#rr thresholds
mean_sens_rr <- as.numeric(c(rr_results_beta100_p_0_3[1,], rr_results_beta100_dep_0_5_p_0_3[1,], rr_results_beta100_dep_neg0_5_p_0_3[1,]))

#ror thresholds
mean_sens_ror <- as.numeric(c(ror_results_beta100_p_0_3[1,], ror_results_beta100_dep_0_5_p_0_3[1,], ror_results_beta100_dep_neg0_5_p_0_3[1,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_sens_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=prr_thresh, y=mean_sens_prr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_sens_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=rr_thresh, y=mean_sens_rr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_sens_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=ror_thresh, y=mean_sens_ror, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid"), name="direction") +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Mean Sensitivity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_sens_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Sensitivity plots for Setting 3 (\U03B2 = 100, p = 0.3, |\U03C1| = 0.5)")

sens_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta100_p_0_3_rho_0_5/sens.png"
combined_sens_plot
ggsave(filename = sens_plot_file, plot = combined_sens_plot)

## specificity plots
#confidence thresholds
mean_spec_conf <- as.numeric(c(conf_results_beta100_p_0_3[2,], conf_results_beta100_dep_0_5_p_0_3[2,], conf_results_beta100_dep_neg0_5_p_0_3[2,]))

#prr thresholds
mean_spec_prr <- as.numeric(c(prr_results_beta100_p_0_3[2,], prr_results_beta100_dep_0_5_p_0_3[2,], prr_results_beta100_dep_neg0_5_p_0_3[2,]))

#rr thresholds
mean_spec_rr <- as.numeric(c(rr_results_beta100_p_0_3[2,], rr_results_beta100_dep_0_5_p_0_3[2,], rr_results_beta100_dep_neg0_5_p_0_3[2,]))

#ror thresholds
mean_spec_ror <- as.numeric(c(ror_results_beta100_p_0_3[2,], ror_results_beta100_dep_0_5_p_0_3[2,], ror_results_beta100_dep_neg0_5_p_0_3[2,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=sgn)) + 
  ylim(0.4,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_spec_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=prr_thresh, y=mean_spec_prr, color=sgn)) +
  ylim(0.4,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_spec_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=rr_thresh, y=mean_spec_rr, color=sgn)) +
  ylim(0.4,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_spec_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=ror_thresh, y=mean_spec_ror, color=sgn)) +
  ylim(0.4,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=sgn)) + 
  ylim(0.4,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid"), name="direction") +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Mean Specificity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

combined_spec_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Specificity plots for Setting 3 (\U03B2 = 100, p = 0.3, |\U03C1| = 0.5)")
spec_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta100_p_0_3_rho_0_5/spec.png"
combined_spec_plot
ggsave(filename = spec_plot_file, plot = combined_spec_plot)

## overall accuracy plots
#confidence thresholds
mean_acc_conf <- as.numeric(c(conf_results_beta100_p_0_3[5,], conf_results_beta100_dep_0_5_p_0_3[5,],  conf_results_beta100_dep_neg0_5_p_0_3[5,]))

#prr thresholds
mean_acc_prr <- as.numeric(c(prr_results_beta100_p_0_3[5,], prr_results_beta100_dep_0_5_p_0_3[5,], prr_results_beta100_dep_neg0_5_p_0_3[5,]))

#rr thresholds
mean_acc_rr <- as.numeric(c(rr_results_beta100_p_0_3[5,], rr_results_beta100_dep_0_5_p_0_3[5,], rr_results_beta100_dep_neg0_5_p_0_3[5,]))

#ror thresholds
mean_acc_ror <- as.numeric(c(ror_results_beta100_p_0_3[5,], ror_results_beta100_dep_0_5_p_0_3[5,], ror_results_beta100_dep_neg0_5_p_0_3[5,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_acc_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=prr_thresh, y=mean_acc_prr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_acc_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=rr_thresh, y=mean_acc_rr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_acc_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=ror_thresh, y=mean_acc_ror, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid"), name="direction") +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_acc_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Overall Accuracy plots for Setting 3 (\U03B2 = 100, p = 0.3, |\U03C1| = 0.5)")

acc_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta100_p_0_3_rho_0_5/acc.png"
combined_acc_plot
ggsave(filename = acc_plot_file, plot = combined_acc_plot)

# roc plots
g1 <- ggplot() + 
  geom_line(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn)) + 
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("Confidence") +
  ylim(0,1) +
  xlim(0,0.4) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=(1-mean_spec_prr), y=mean_sens_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=(1-mean_spec_prr), y=mean_sens_prr, color=sgn)) +
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("PRR") +
  ylim(0,1) +
  xlim(0,0.4) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=(1-mean_spec_rr), y=mean_sens_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=(1-mean_spec_rr), y=mean_sens_rr, color=sgn)) +
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("RR") +
  ylim(0,1) +
  xlim(0,0.4) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=(1-mean_spec_ror), y=mean_sens_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=(1-mean_spec_ror), y=mean_sens_ror, color=sgn)) +
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("ROR") +
  ylim(0,1) +
  xlim(0,0.4) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn)) + 
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("Confidence") +
  ylim(0,1) +
  xlim(0,0.4) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "bottom", title=element_text(size=8), axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_roc_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Sensitivity versus Specificity trade-off plots for Setting 3 (\U03B2 = 100, p = 0.3, |\U03C1| = 0.5)")

roc_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta100_p_0_3_rho_0_5/roc.png"
combined_roc_plot
ggsave(filename = roc_plot_file, plot = combined_roc_plot)
```

```{r b_100_rho_0_5_p_0_5}
conf_thresh <- as.factor(rep(c(0.4,0.5,0.6,0.7), 3))
prr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
rr_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
ror_thresh <- as.factor(rep(c(1,1.2,1.5,2), 3))
#p <- as.factor(c(rep(0.1,4), rep(0.3,4), rep(0.5,4)))
sgn <- as.factor(c(rep(0,4), rep("+",4), rep("-",4)))
#corr <- as.factor(c(rep(0,4), rep(0.3,4), rep(-0.3,4), rep(0.5,4), rep(-0.5,4), rep(0.7,4), rep(-0.7,4)))

#sensitivity plots
#confidence thresholds
mean_sens_conf <- as.numeric(c(conf_results_beta100_p_0_5[1,], conf_results_beta100_dep_0_5_p_0_5[1,], conf_results_beta100_dep_neg0_5_p_0_5[1,]))

#prr thresholds
mean_sens_prr <- as.numeric(c(prr_results_beta100_p_0_5[1,], prr_results_beta100_dep_0_5_p_0_5[1,], prr_results_beta100_dep_neg0_5_p_0_5[1,]))

#rr thresholds
mean_sens_rr <- as.numeric(c(rr_results_beta100_p_0_5[1,], rr_results_beta100_dep_0_5_p_0_5[1,], rr_results_beta100_dep_neg0_5_p_0_5[1,]))

#ror thresholds
mean_sens_ror <- as.numeric(c(ror_results_beta100_p_0_5[1,], ror_results_beta100_dep_0_5_p_0_5[1,], ror_results_beta100_dep_neg0_5_p_0_5[1,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_sens_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=prr_thresh, y=mean_sens_prr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_sens_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=rr_thresh, y=mean_sens_rr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_sens_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=ror_thresh, y=mean_sens_ror, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Sensitivity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_sens_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid"), name="direction") +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Mean Sensitivity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_sens_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Sensitivity plots for Setting 3 (\U03B2 = 100, p = 0.5, |\U03C1| = 0.5)")

sens_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta100_p_0_5_rho_0_5/sens.png"
combined_sens_plot
ggsave(filename = sens_plot_file, plot = combined_sens_plot)

## specificity plots
#confidence thresholds
mean_spec_conf <- as.numeric(c(conf_results_beta100_p_0_5[2,], conf_results_beta100_dep_0_5_p_0_5[2,], conf_results_beta100_dep_neg0_5_p_0_5[2,]))

#prr thresholds
mean_spec_prr <- as.numeric(c(prr_results_beta100_p_0_5[2,], prr_results_beta100_dep_0_5_p_0_5[2,], prr_results_beta100_dep_neg0_5_p_0_5[2,]))

#rr thresholds
mean_spec_rr <- as.numeric(c(rr_results_beta100_p_0_5[2,], rr_results_beta100_dep_0_5_p_0_5[2,], rr_results_beta100_dep_neg0_5_p_0_5[2,]))

#ror thresholds
mean_spec_ror <- as.numeric(c(ror_results_beta100_p_0_5[2,], ror_results_beta100_dep_0_5_p_0_5[2,], ror_results_beta100_dep_neg0_5_p_0_5[2,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=sgn)) + 
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_spec_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=prr_thresh, y=mean_spec_prr, color=sgn)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_spec_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=rr_thresh, y=mean_spec_rr, color=sgn)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_spec_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=ror_thresh, y=mean_spec_ror, color=sgn)) +
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Specificity", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_spec_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_spec_conf, color=sgn)) + 
  ylim(0.5,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid"), name="direction") +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Mean Specificity", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

combined_spec_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Specificity plots for Setting 3 (\U03B2 = 100, p = 0.5, |\U03C1| = 0.5)")
spec_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta100_p_0_5_rho_0_5/spec.png"
combined_spec_plot
ggsave(filename = spec_plot_file, plot = combined_spec_plot)

## overall accuracy plots
#confidence thresholds
mean_acc_conf <- as.numeric(c(conf_results_beta100_p_0_5[5,], conf_results_beta100_dep_0_5_p_0_5[5,],  conf_results_beta100_dep_neg0_5_p_0_5[5,]))

#prr thresholds
mean_acc_prr <- as.numeric(c(prr_results_beta100_p_0_5[5,], prr_results_beta100_dep_0_5_p_0_5[5,], prr_results_beta100_dep_neg0_5_p_0_5[5,]))

#rr thresholds
mean_acc_rr <- as.numeric(c(rr_results_beta100_p_0_5[5,], rr_results_beta100_dep_0_5_p_0_5[5,], rr_results_beta100_dep_neg0_5_p_0_5[5,]))

#ror thresholds
mean_acc_ror <- as.numeric(c(ror_results_beta100_p_0_5[5,], ror_results_beta100_dep_0_5_p_0_5[5,], ror_results_beta100_dep_neg0_5_p_0_5[5,]))

g1 <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=prr_thresh, y=mean_acc_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=prr_thresh, y=mean_acc_prr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="PRR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=rr_thresh, y=mean_acc_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=rr_thresh, y=mean_acc_rr, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="RR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=ror_thresh, y=mean_acc_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=ror_thresh, y=mean_acc_ror, color=sgn)) +
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Mean Overall Accuracy", x="ROR thresholds") +
  theme(legend.position = "none", axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x=conf_thresh, y=mean_acc_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x=conf_thresh, y=mean_acc_conf, color=sgn)) + 
  ylim(0,1) +
  #scale_shape_manual(values = c(15,16,17,18), name=greeks("beta")) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid"), name="direction") +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Mean Overall Accuracy", x="Confidence thresholds") + 
  #scale_color_discrete(name=greeks("rho")) +
  #scale_shape_discrete(name=greeks("beta")) +
  #scale_linetype_discrete(name=greeks("beta")) +
  theme(legend.position = "bottom", axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_acc_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Overall Accuracy plots for Setting 3 (\U03B2 = 100, p = 0.5, |\U03C1| = 0.5)")

acc_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta100_p_0_5_rho_0_5/acc.png"
combined_acc_plot
ggsave(filename = acc_plot_file, plot = combined_acc_plot)

# roc plots
g1 <- ggplot() + 
  geom_line(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn)) + 
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("Confidence") +
  ylim(0,1) +
  xlim(0,0.5) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g2 <- ggplot() + 
  geom_line(aes(x=(1-mean_spec_prr), y=mean_sens_prr, color=sgn, group=sgn)) + 
  geom_point(aes(x=(1-mean_spec_prr), y=mean_sens_prr, color=sgn)) +
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("PRR") +
  ylim(0,1) +
  xlim(0,0.5) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g3 <- ggplot() + 
  geom_line(aes(x=(1-mean_spec_rr), y=mean_sens_rr, color=sgn, group=sgn)) + 
  geom_point(aes(x=(1-mean_spec_rr), y=mean_sens_rr, color=sgn)) +
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("RR") +
  ylim(0,1) +
  xlim(0,0.5) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

g4 <- ggplot() + 
  geom_line(aes(x=(1-mean_spec_ror), y=mean_sens_ror, color=sgn, group=sgn)) + 
  geom_point(aes(x=(1-mean_spec_ror), y=mean_sens_ror, color=sgn)) +
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("ROR") +
  ylim(0,1) +
  xlim(0,0.5) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4")) +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "none", title=element_text(size=8), axis.text=element_text(size=8),
        axis.title=element_text(size=8))

combined_plot <- grid.arrange(g1, g2, g3, g4, nrow=2, ncol=2)

g1_legend <- ggplot() + 
  geom_line(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn, group=sgn)) + 
  geom_point(aes(x = (1-mean_spec_conf), y = mean_sens_conf, color=sgn)) + 
  geom_abline(slope = 1, intercept = 0) +
  ggtitle("Confidence") +
  ylim(0,1) +
  xlim(0,0.5) +
  #scale_shape_manual(values = c(15,16,17,18)) +
  #scale_linetype_manual(values = c("dotted", "dashed","solid")) +
  scale_color_manual(values = c("#b2df8a","#fb9a99","#1f78b4"), name="direction") +
  labs(y="Sensitivity", x="1 - Specificity") +
  theme(legend.position = "bottom", title=element_text(size=8), axis.text=element_text(size=10),
        axis.title=element_text(size=8), legend.title = element_text(size=10, face="bold"), 
        legend.text = element_text(size=8))

#function to extract legend from plot
get_only_legend <- function(plot) {
  plot_table <- ggplot_gtable(ggplot_build(plot))
  legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
  legend <- plot_table$grobs[[legend_plot]]
  return(legend)
}

#extract legend from g1 using above function
legend <- get_only_legend(g1_legend)

#final combined Sensitivity plot with common legend
combined_roc_plot <- grid.arrange(combined_plot, legend, nrow=2, heights=c(8.5,2), top = "Sensitivity versus Specificity trade-off plots for Setting 3 (\U03B2 = 100, p = 0.5, |\U03C1| = 0.5)")

roc_plot_file <- "/Users/reetikasarkar/Documents/dissertation_research/apriori_project/codes/plots/setting_5d_10ae/fixed_beta_fixed_p_fixed_rho/beta100_p_0_5_rho_0_5/roc.png"
combined_roc_plot
ggsave(filename = roc_plot_file, plot = combined_roc_plot)
```